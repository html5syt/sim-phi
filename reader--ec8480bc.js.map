{"version":3,"file":"reader--ec8480bc.js","sources":["../src/extends/pec/easing.js","../src/extends/pec/BpmList.ts","../src/extends/pec/LinePec.ts","../src/extends/pec/cubicBezier.js","../src/extends/pec/rpe2json.ts","../src/extends/pec/index.ts","../src/extends/pec/pec2json.ts","../src/utils/reader-.ts"],"sourcesContent":["/* eslint-disable no-param-reassign */\nconst tl = [\n  null, // 0\n  null, // 1\n  t => Math.sin(t * Math.PI / 2), // 2\n  t => 1 - Math.cos(t * Math.PI / 2), // 3\n  t => 1 - (t - 1) ** 2, // 4\n  t => t ** 2, // 5\n  t => (1 - Math.cos(t * Math.PI)) / 2, // 6\n  t => ((t *= 2) < 1 ? t ** 2 : -((t - 2) ** 2 - 2)) / 2, // 7\n  t => 1 + (t - 1) ** 3, // 8\n  t => t ** 3, // 9\n  t => 1 - (t - 1) ** 4, // 10\n  t => t ** 4, // 11\n  t => ((t *= 2) < 1 ? t ** 3 : (t - 2) ** 3 + 2) / 2, // 12\n  t => ((t *= 2) < 1 ? t ** 4 : -((t - 2) ** 4 - 2)) / 2, // 13\n  t => 1 + (t - 1) ** 5, // 14\n  t => t ** 5, // 15\n  t => 1 - 2 ** (-10 * t), // 16\n  t => 2 ** (10 * (t - 1)), // 17\n  t => Math.sqrt(1 - (t - 1) ** 2), // 18\n  t => 1 - Math.sqrt(1 - t ** 2), // 19\n  t => (2.70158 * t - 1) * (t - 1) ** 2 + 1, // 20\n  t => (2.70158 * t - 1.70158) * t ** 2, // 21\n  t => ((t *= 2) < 1 ? 1 - Math.sqrt(1 - t ** 2) : Math.sqrt(1 - (t - 2) ** 2) + 1) / 2, // 22\n  t => t < 0.5 ? (14.379638 * t - 5.189819) * t ** 2 : (14.379638 * t - 9.189819) * (t - 1) ** 2 + 1, // 23\n  t => 1 - 2 ** (-10 * t) * Math.cos(t * Math.PI / 0.15), // 24\n  t => 2 ** (10 * (t - 1)) * Math.cos((t - 1) * Math.PI / 0.15), // 25\n  t => ((t *= 11) < 4 ? t ** 2 : t < 8 ? (t - 6) ** 2 + 12 : t < 10 ? (t - 9) ** 2 + 15 : (t - 10.5) ** 2 + 15.75) / 16, // 26\n  t => 1 - tl[26](1 - t), // 27\n  t => (t *= 2) < 1 ? tl[26](t) / 2 : tl[27](t - 1) / 2 + 0.5, // 28\n  t => t < 0.5 ? 2 ** (20 * t - 11) * Math.sin((160 * t + 1) * Math.PI / 18) : 1 - 2 ** (9 - 20 * t) * Math.sin((160 * t + 1) * Math.PI / 18) // 29\n];\nfunction isLinear(index) {\n  index = Math.trunc(index);\n  return index < 2 || index > 29;\n}\n/**\n * @param {number} index\n * @returns {(t: number) => number}\n */\nfunction easing(index) {\n  index = Math.trunc(index);\n  return tl[index];\n}\nexport { isLinear, easing };\n","interface BpmEventPec {\n  start: number;\n  end: number;\n  bpm: number;\n  value: number;\n}\nexport type BeatArray = [number, number, number];\nexport class BpmList {\n  public baseBpm: number;\n  private accTime: number;\n  private readonly list: BpmEventPec[];\n  public constructor(baseBpm: unknown) {\n    this.baseBpm = Number(baseBpm) || 120;\n    this.accTime = 0;\n    this.list = []; // 存放bpm变速事件\n  }\n  public push(start: number, end: number, bpm: number): void {\n    const value = this.accTime;\n    this.list.push({ start, end, bpm, value });\n    this.accTime += (end - start) / bpm;\n  }\n  public calc(beat: number): number {\n    let time = 0;\n    for (const i of this.list) {\n      if (beat > i.end) { continue }\n      if (beat < i.start) { break }\n      time = Math.round(((beat - i.start) / i.bpm + i.value) * this.baseBpm * 32);\n    }\n    return time;\n  }\n  public calc2(time: BeatArray): number {\n    return this.calc(time[0] + time[1] / time[2]);\n  }\n}\n","import { easing, isLinear } from './easing.js';\ninterface SpeedEventPec {\n  time: number;\n  value: number;\n}\ninterface NotePecExtends {\n  type: number;\n  time: number;\n  positionX: number;\n  holdTime: number;\n  speed: number;\n  isAbove: boolean;\n  isFake: boolean;\n}\ninterface LineEventPec {\n  startTime: number;\n  endTime: number;\n  value: number;\n  motionType: number;\n}\ninterface LineEventPecExtends extends LineEventPec {\n  value2: number;\n}\nexport class LinePec {\n  private readonly bpm: number;\n  private readonly speedEvents: SpeedEventPec[];\n  private readonly notes: NotePecExtends[];\n  private readonly alphaEvents: LineEventPec[];\n  private readonly moveEvents: LineEventPecExtends[];\n  private readonly rotateEvents: LineEventPec[];\n  public constructor(bpm: number) {\n    this.bpm = 120;\n    this.speedEvents = [];\n    this.notes = [];\n    this.alphaEvents = [];\n    this.moveEvents = [];\n    this.rotateEvents = [];\n    if (!isNaN(bpm)) { this.bpm = bpm }\n  }\n  public pushNote(type: number, time: number, positionX: number, holdTime: number, speed: number, isAbove: boolean, isFake: boolean): void {\n    this.notes.push({ type, time, positionX, holdTime, speed, isAbove, isFake });\n  }\n  public pushSpeedEvent(time: number, value: number): void {\n    this.speedEvents.push({ time, value });\n  }\n  public pushAlphaEvent(startTime: number, endTime: number, value: number, motionType: number): void {\n    this.alphaEvents.push({ startTime, endTime, value, motionType });\n  }\n  public pushMoveEvent(startTime: number, endTime: number, value: number, value2: number, motionType: number): void {\n    this.moveEvents.push({ startTime, endTime, value, value2, motionType });\n  }\n  public pushRotateEvent(startTime: number, endTime: number, value: number, motionType: number): void {\n    this.rotateEvents.push({ startTime, endTime, value, motionType });\n  }\n  public format(): JudgeLine {\n    const sortFn = (a: { time: number }, b: { time: number }) => a.time - b.time;\n    const sortFn2 = (a: { startTime: number; endTime: number }, b: { startTime: number; endTime: number }) => a.startTime - b.startTime + (a.endTime - b.endTime);\n    // 不单独判断以避免误差\n    const result = {\n      formatVersion: 3,\n      offset: 0,\n      bpm: this.bpm,\n      speedEvents: [] as SpeedEvent[],\n      numOfNotes: 0,\n      numOfNotesAbove: 0,\n      numOfNotesBelow: 0,\n      notesAbove: [] as Note[],\n      notesBelow: [] as Note[],\n      judgeLineDisappearEvents: [] as JudgeLineEvent[],\n      judgeLineMoveEvents: [] as JudgeLineEvent[],\n      judgeLineRotateEvents: [] as JudgeLineEvent[]\n    };\n    const pushDisappearEvent = (startTime: number, endTime: number, start: number, end: number) => {\n      result.judgeLineDisappearEvents.push({ startTime, endTime, start, end, start2: 0, end2: 0 });\n    };\n    const pushMoveEvent = (startTime: number, endTime: number, start: number, end: number, start2: number, end2: number) => {\n      result.judgeLineMoveEvents.push({ startTime, endTime, start, end, start2, end2 });\n    };\n    const pushRotateEvent = (startTime: number, endTime: number, start: number, end: number) => {\n      result.judgeLineRotateEvents.push({ startTime, endTime, start, end, start2: 0, end2: 0 });\n    };\n    // cv和floorPosition一并处理\n    const cvp = this.speedEvents.sort(sortFn);\n    let s1 = 0;\n    for (let i = 0; i < cvp.length; i++) {\n      const startTime = Math.max(cvp[i].time, 0);\n      const endTime = i < cvp.length - 1 ? cvp[i + 1].time : 1e9;\n      const { value } = cvp[i];\n      const floorPosition = s1;\n      s1 += (endTime - startTime) * value / this.bpm * 1.875;\n      s1 = Math.fround(s1);\n      result.speedEvents.push({ startTime, endTime, value, floorPosition });\n    }\n    for (const i of this.notes.sort(sortFn)) {\n      const { time } = i;\n      let v1 = 0;\n      let v2 = 0;\n      let v3 = 0;\n      for (const e of result.speedEvents) {\n        if (time > e.endTime) { continue }\n        if (time < e.startTime) { break }\n        v1 = e.floorPosition;\n        v2 = e.value;\n        v3 = time - e.startTime;\n      }\n      const note = {\n        type: i.type,\n        time: time + (i.isFake ? 1e9 : 0),\n        positionX: i.positionX,\n        holdTime: i.holdTime,\n        speed: i.speed * (i.type === 3 ? v2 : 1),\n        floorPosition: Math.fround(v1 + v2 * v3 / this.bpm * 1.875)\n      };\n      if (i.isAbove) {\n        result.notesAbove.push(note);\n        if (i.isFake) { continue }\n        result.numOfNotes++;\n        result.numOfNotesAbove++;\n      } else {\n        result.notesBelow.push(note);\n        if (i.isFake) { continue }\n        result.numOfNotes++;\n        result.numOfNotesBelow++;\n      }\n    }\n    // 整合motionType\n    let dt = 0;\n    let d1 = 0;\n    for (const e of this.alphaEvents.sort(sortFn2)) {\n      pushDisappearEvent(dt, e.startTime, d1, d1);\n      if (!isLinear(e.motionType)) {\n        const t1 = e.value - d1;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easing(e.motionType)((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushDisappearEvent(i, i + 1, d1 + x1 * t1, d1 + x2 * t1);\n        }\n      } else if (e.motionType) { pushDisappearEvent(e.startTime, e.endTime, d1, e.value) }\n      dt = e.endTime;\n      d1 = e.value;\n    }\n    pushDisappearEvent(dt, 1e9, d1, d1);\n    //\n    let mt = 0;\n    let m1 = 0;\n    let m2 = 0;\n    for (const e of this.moveEvents.sort(sortFn2)) {\n      pushMoveEvent(mt, e.startTime, m1, m1, m2, m2);\n      if (e.motionType === 1) { pushMoveEvent(e.startTime, e.endTime, m1, e.value, m2, e.value2) } else {\n        const t1 = e.value - m1;\n        const t2 = e.value2 - m2;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easing(e.motionType)((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushMoveEvent(i, i + 1, m1 + x1 * t1, m1 + x2 * t1, m2 + x1 * t2, m2 + x2 * t2);\n        }\n      }\n      mt = e.endTime;\n      m1 = e.value;\n      m2 = e.value2;\n    }\n    pushMoveEvent(mt, 1e9, m1, m1, m2, m2);\n    //\n    let rt = 0;\n    let r1 = 0;\n    for (const e of this.rotateEvents.sort(sortFn2)) {\n      pushRotateEvent(rt, e.startTime, r1, r1);\n      if (e.motionType === 1) { pushRotateEvent(e.startTime, e.endTime, r1, e.value) } else {\n        const t1 = e.value - r1;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easing(e.motionType)((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushRotateEvent(i, i + 1, r1 + x1 * t1, r1 + x2 * t1);\n        }\n      }\n      rt = e.endTime;\n      r1 = e.value;\n    }\n    pushRotateEvent(rt, 1e9, r1, r1);\n    return result;\n  }\n}\n","export function cubicBezier(p1x, p1y, p2x, p2y) {\n  const ZERO_LIMIT = 1e-6;\n  // Calculate the polynomial coefficients,\n  // implicit first and last control points are (0,0) and (1,1).\n  const ax = 3 * p1x - 3 * p2x + 1;\n  const bx = 3 * p2x - 6 * p1x;\n  const cx = 3 * p1x;\n  const ay = 3 * p1y - 3 * p2y + 1;\n  const by = 3 * p2y - 6 * p1y;\n  const cy = 3 * p1y;\n  function sampleCurveDerivativeX(t) {\n    // `ax t^3 + bx t^2 + cx t` expanded using Horner's rule\n    return (3 * ax * t + 2 * bx) * t + cx;\n  }\n  function sampleCurveX(t) {\n    return ((ax * t + bx) * t + cx) * t;\n  }\n  function sampleCurveY(t) {\n    return ((ay * t + by) * t + cy) * t;\n  }\n  // Given an x value, find a parametric value it came from.\n  function solveCurveX(x) {\n    let t2 = x;\n    let derivative, x2;\n    // https://trac.webkit.org/browser/trunk/Source/WebCore/platform/animation\n    // first try a few iterations of Newton's method -- normally very fast.\n    // http://en.wikipedia.org/wikiNewton's_method\n    for (let i = 0; i < 8; i++) {\n      // f(t) - x = 0\n      x2 = sampleCurveX(t2) - x;\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n      derivative = sampleCurveDerivativeX(t2);\n      // == 0, failure\n      if (Math.abs(derivative) < ZERO_LIMIT) {\n        break;\n      }\n      t2 -= x2 / derivative;\n    }\n    // Fall back to the bisection method for reliability.\n    // bisection\n    // http://en.wikipedia.org/wiki/Bisection_method\n    let t1 = 1;\n    let t0 = 0;\n    t2 = x;\n    while (t1 > t0) {\n      x2 = sampleCurveX(t2) - x;\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n      if (x2 > 0) {\n        t1 = t2;\n      } else {\n        t0 = t2;\n      }\n      t2 = (t1 + t0) / 2;\n    }\n    // Failure\n    return t2;\n  }\n  function solve(x) {\n    return sampleCurveY(solveCurveX(x));\n  }\n  return solve;\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { type BeatArray, BpmList } from './BpmList';\nimport { easing } from './easing.js';\nimport { cubicBezier } from './cubicBezier.js';\ninterface BpmEventRPE {\n  startTime: BeatArray;\n  bpm: number;\n}\ninterface BpmEventRPEExtends extends BpmEventRPE {\n  time: number;\n}\ninterface LineEventPec {\n  startTime: number;\n  endTime: number;\n  start: number;\n  end: number;\n}\ninterface LineEventPec2 extends LineEventPec {\n  start2: number;\n  end2: number;\n}\ninterface LineEventPecDelta extends LineEventPec {\n  delta: number;\n}\ninterface SpeedEventPec {\n  time: number;\n  value: number;\n}\ninterface LineEventRPE {\n  startTime: BeatArray;\n  endTime: BeatArray;\n  start: number;\n  end: number;\n  easingType: number;\n  linkgroup?: number;\n  easingLeft?: number;\n  easingRight?: number;\n  bezier?: number;\n  bezierPoints?: [number, number, number, number];\n}\ninterface LineEventRPE2 {\n  startTime: number;\n  endTime: number;\n  start: number;\n  end: number;\n  easingFn?: (t: number) => number;\n}\nfunction getEasingFn(le: LineEventRPE, startTime: number, endTime: number) {\n  const { start, end, bezier = 0 } = le;\n  if (start === end) return undefined;\n  if (bezier === 0) {\n    const { easingType, easingLeft = 0, easingRight = 1 } = le;\n    if (easingType === 1) return undefined;\n    const easingFn = easing(easingType);\n    const eHead = easingFn(easingLeft);\n    const eTail = easingFn(easingRight);\n    const eSpeed = (easingRight - easingLeft) / (endTime - startTime);\n    const eDelta = (eTail - eHead) / (end - start);\n    return (t: number) => (easingFn((t - startTime) * eSpeed + easingLeft) - eHead) / eDelta;\n  }\n  if (bezier !== 0) {\n    const { bezierPoints: [p1x, p1y, p2x, p2y] = [0, 0, 0, 0] } = le;\n    if (p1x === p1y && p2x === p2y) return undefined;\n    const eSpeed = 1 / (endTime - startTime);\n    const eDelta = 1 / (end - start);\n    const easingFn = cubicBezier(p1x, p1y, p2x, p2y);\n    return (t: number) => easingFn((t - startTime) * eSpeed) / eDelta;\n  }\n  throw new Error('Not implemented');\n}\nfunction pushLineEvent(ls: LineEventPecDelta[], le: LineEventRPE2) {\n  const { startTime, endTime, start, end, easingFn } = le;\n  const delta = (end - start) / (endTime - startTime);\n  // 插入之前考虑事件时间的相互关系\n  for (let i = ls.length - 1; i >= 0; i--) {\n    const e = ls[i];\n    if (e.endTime < startTime) { // 相离：补全空隙\n      ls[i + 1] = { startTime: e.endTime, endTime: startTime, start: e.end, end: e.end, delta: 0 };\n      break;\n    }\n    if (e.startTime === startTime) { // 相切：直接截断\n      ls.length = i;\n      break;\n    }\n    if (e.startTime < startTime) { // 相交：截断交点以后的部分\n      e.end = e.start + (startTime - e.startTime) * e.delta;\n      e.endTime = startTime;\n      e.delta = (e.end - e.start) / (startTime - e.startTime);\n      ls.length = i + 1;\n      break;\n    }\n  }\n  // 插入新事件\n  if (easingFn == null) {\n    ls.push({ startTime, endTime, start, end, delta });\n  } else { // 暂未考虑开始时间大于结束时间的情况\n    let v1 = 0;\n    let v2 = 0;\n    for (let j = startTime; j < endTime; j++) {\n      v1 = v2;\n      v2 = easingFn(j + 1);\n      ls.push({ startTime: j, endTime: j + 1, start: start + v1, end: start + v2, delta: v2 - v1 });\n    }\n  }\n}\nfunction toSpeedEvent(le: LineEventRPE2[]) {\n  const result = [];\n  for (const i of le) {\n    const { startTime, endTime, start, end } = i;\n    result.push({ time: startTime, value: start });\n    if (start !== end) { // 暂未考虑开始时间大于结束时间的情况\n      const t1 = (end - start) / (endTime - startTime);\n      for (let j = startTime; j < endTime; j++) {\n        const x = j + 1 - startTime;\n        result.push({ time: j + 1, value: start + x * t1 });\n      }\n    }\n  }\n  return result;\n}\nfunction getEventsValue(e: LineEventPecDelta[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end, delta } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) result = end;\n    else result = start + (t - startTime) * delta;\n  }\n  return result;\n}\nfunction getMoveValue(e: LineEventPec2[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  let result2 = e[0]?.start2 ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end, start2, end2 } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) {\n      result = end;\n      result2 = end2;\n    } else {\n      result = start + (t - startTime) * (end - start) / (endTime - startTime);\n      result2 = start2 + (t - startTime) * (end2 - start2) / (endTime - startTime);\n    }\n  }\n  return [result, result2];\n}\nfunction getRotateValue(e: LineEventRPE2[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) result = end;\n    else { result = start + (t - startTime) * (end - start) / (endTime - startTime) }\n  }\n  return result;\n}\nfunction combineXYEvents(xe: LineEventPecDelta[], ye: LineEventPecDelta[]) {\n  const le = [];\n  const splits = [];\n  for (const i of xe) splits.push(i.startTime, i.endTime);\n  for (const i of ye) splits.push(i.startTime, i.endTime);\n  splits.sort((a, b) => a - b);\n  for (let i = 0; i < splits.length - 1; i++) {\n    const startTime = splits[i];\n    const endTime = splits[i + 1];\n    if (startTime === endTime) continue;\n    const startX = getEventsValue(xe, startTime, false);\n    const endX = getEventsValue(xe, endTime, true);\n    const startY = getEventsValue(ye, startTime, false);\n    const endY = getEventsValue(ye, endTime, true);\n    le.push({ startTime, endTime, start: startX, end: endX, start2: startY, end2: endY });\n  }\n  return le;\n}\nfunction combineMultiEvents(es: LineEventPecDelta[][]) {\n  const le = [];\n  const splits = [];\n  for (const e of es) {\n    for (const i of e) splits.push(i.startTime, i.endTime);\n  }\n  splits.sort((a, b) => a - b);\n  for (let i = 0; i < splits.length - 1; i++) {\n    const startTime = splits[i];\n    const endTime = splits[i + 1];\n    if (startTime === endTime) continue;\n    const start = es.reduce((n, e) => n + getEventsValue(e, startTime, false), 0);\n    const end = es.reduce((n, e) => n + getEventsValue(e, endTime, true), 0);\n    le.push({ startTime, endTime, start, end, delta: (end - start) / (endTime - startTime) });\n  }\n  return le;\n}\nfunction mergeFather(child: LineRPE1, father: LineRPE1) {\n  const moveEvents = [];\n  const splits = [];\n  for (const i of father.moveEvents!) splits.push(i.startTime, i.endTime);\n  for (const i of father.rotateEvents!) splits.push(i.startTime, i.endTime);\n  for (const i of child.moveEvents!) splits.push(i.startTime, i.endTime);\n  splits.sort((a, b) => a - b);\n  for (let i = splits[0]; i < splits[splits.length - 1]; i++) {\n    const startTime = i;\n    const endTime = i + 1;\n    if (startTime === endTime) continue;\n    // 计算父级移动和旋转\n    const [fatherX, fatherY] = getMoveValue(father.moveEvents!, startTime, false);\n    const fatherR = getRotateValue(father.rotateEvents!, startTime, false) * -Math.PI / 180;\n    const [fatherX2, fatherY2] = getMoveValue(father.moveEvents!, endTime, true);\n    const fatherR2 = getRotateValue(father.rotateEvents!, endTime, true) * -Math.PI / 180;\n    // 计算子级移动\n    const [childX, childY] = getMoveValue(child.moveEvents!, startTime, false);\n    const [childX2, childY2] = getMoveValue(child.moveEvents!, endTime, true);\n    // 坐标转换\n    const start = fatherX + childX * Math.cos(fatherR) - childY * Math.sin(fatherR);\n    const end = fatherX2 + childX2 * Math.cos(fatherR2) - childY2 * Math.sin(fatherR2);\n    const start2 = fatherY + childX * Math.sin(fatherR) + childY * Math.cos(fatherR);\n    const end2 = fatherY2 + childX2 * Math.sin(fatherR2) + childY2 * Math.cos(fatherR2);\n    moveEvents.push({ startTime, endTime, start, end, start2, end2 });\n  }\n  child.moveEvents = moveEvents;\n}\ninterface EventLayer {\n  moveXEvents: LineEventRPE[];\n  moveYEvents: LineEventRPE[];\n  rotateEvents: LineEventRPE[];\n  alphaEvents: LineEventRPE[];\n  speedEvents: LineEventRPE[];\n}\nclass EventLayer1 {\n  public moveXEvents: LineEventRPE2[];\n  public moveYEvents: LineEventRPE2[];\n  public rotateEvents: LineEventRPE2[];\n  public alphaEvents: LineEventRPE2[];\n  public speedEvents: LineEventRPE2[];\n  public constructor() {\n    this.moveXEvents = [];\n    this.moveYEvents = [];\n    this.rotateEvents = [];\n    this.alphaEvents = [];\n    this.speedEvents = [];\n  }\n  public pushMoveXEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.moveXEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushMoveYEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.moveYEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushRotateEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.rotateEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushAlphaEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.alphaEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushSpeedEvent(startTime: number, endTime: number, start: number, end: number) { this.speedEvents.push({ startTime, endTime, start, end }) }\n}\ninterface NoteRPE {\n  type: number;\n  startTime: BeatArray;\n  endTime: BeatArray;\n  positionX: number;\n  above: number;\n  isFake: number;\n  speed: number;\n  size: number;\n  yOffset: number;\n  visibleTime: number;\n  alpha: number;\n}\ninterface NoteRPE1 {\n  type: number;\n  time: number;\n  positionX: number;\n  holdTime: number;\n  speed: number;\n  isAbove: boolean;\n  isFake: boolean;\n}\nclass LineRPE1 {\n  public bpm: number;\n  public notes: NoteRPE1[];\n  public eventLayers: EventLayer1[];\n  public id?: number;\n  public father: LineRPE1 | null;\n  public moveEvents?: LineEventPec2[];\n  public rotateEvents?: LineEventPec[];\n  public alphaEvents?: LineEventPec[];\n  public speedEvents?: SpeedEventPec[];\n  private settled: boolean;\n  private merged: boolean;\n  public constructor(bpm: number) {\n    this.bpm = 120;\n    this.notes = [];\n    this.eventLayers = [];\n    this.father = null;\n    this.settled = false;\n    this.merged = false;\n    if (!isNaN(bpm)) this.bpm = bpm;\n  }\n  public pushNote(type: number, time: number, positionX: number, holdTime: number, speed: number, isAbove: boolean, isFake: boolean) {\n    this.notes.push({ type, time, positionX, holdTime, speed, isAbove, isFake });\n  }\n  public setId(id = NaN) { this.id = id }\n  public setFather(fatherLine: LineRPE1 | null) { this.father = fatherLine }\n  public preset() {\n    const sortFn2 = (a: { startTime: number }, b: { startTime: number }) => a.startTime - b.startTime;\n    const events = [];\n    for (const e of this.eventLayers) {\n      const moveXEvents: LineEventPecDelta[] = [];\n      const moveYEvents: LineEventPecDelta[] = [];\n      const rotateEvents: LineEventPecDelta[] = [];\n      const alphaEvents: LineEventPecDelta[] = [];\n      const speedEvents: LineEventPecDelta[] = [];\n      for (const i of e.moveXEvents.sort(sortFn2)) { pushLineEvent(moveXEvents, i) }\n      for (const i of e.moveYEvents.sort(sortFn2)) { pushLineEvent(moveYEvents, i) }\n      for (const i of e.rotateEvents.sort(sortFn2)) { pushLineEvent(rotateEvents, i) }\n      for (const i of e.alphaEvents.sort(sortFn2)) { pushLineEvent(alphaEvents, i) }\n      for (const i of e.speedEvents.sort(sortFn2)) { pushLineEvent(speedEvents, i) }\n      events.push({ moveXEvents, moveYEvents, rotateEvents, alphaEvents, speedEvents });\n    }\n    const moveXEvents = combineMultiEvents(events.map(i => i.moveXEvents));\n    const moveYEvents = combineMultiEvents(events.map(i => i.moveYEvents));\n    this.moveEvents = combineXYEvents(moveXEvents, moveYEvents);\n    this.rotateEvents = combineMultiEvents(events.map(i => i.rotateEvents));\n    this.alphaEvents = combineMultiEvents(events.map(i => i.alphaEvents));\n    this.speedEvents = toSpeedEvent(combineMultiEvents(events.map(i => i.speedEvents)));\n    this.settled = true;\n  }\n  public fitFather(stack: LineRPE1[] = [], onwarning = console.warn) {\n    if (!this.settled) this.preset();\n    if (stack.includes(this)) {\n      onwarning(`检测到循环继承：${stack.concat(this).map(i => i.id).join('->')}(对应的father将被视为-1)`);\n      stack.map(i => i.setFather(null));\n      return;\n    }\n    if (this.father) {\n      this.father.fitFather(stack.concat(this), onwarning);\n      if (!this.merged) mergeFather(this, this.father);\n      this.merged = true;\n    }\n  }\n  public format({ onwarning = console.warn } = {}) {\n    this.fitFather([], onwarning);\n    const result = {\n      bpm: this.bpm,\n      speedEvents: [] as SpeedEvent[],\n      numOfNotes: 0,\n      numOfNotesAbove: 0,\n      numOfNotesBelow: 0,\n      notesAbove: [] as Note[],\n      notesBelow: [] as Note[],\n      judgeLineDisappearEvents: [] as JudgeLineEvent[],\n      judgeLineMoveEvents: [] as JudgeLineEvent[],\n      judgeLineRotateEvents: [] as JudgeLineEvent[]\n    };\n    for (const i of this.moveEvents!) {\n      result.judgeLineMoveEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: (i.start + 675) / 1350,\n        end: (i.end + 675) / 1350,\n        start2: (i.start2 + 450) / 900,\n        end2: (i.end2 + 450) / 900\n      });\n    }\n    for (const i of this.rotateEvents!) {\n      result.judgeLineRotateEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: -i.start,\n        end: -i.end,\n        start2: 0,\n        end2: 0\n      });\n    }\n    for (const i of this.alphaEvents!) {\n      result.judgeLineDisappearEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: Math.max(0, i.start / 255),\n        end: Math.max(0, i.end / 255),\n        start2: 0,\n        end2: 0\n      });\n    }\n    // 添加floorPosition\n    let floorPos = 0;\n    const speedEvents = this.speedEvents!;\n    for (let i = 0; i < speedEvents.length; i++) {\n      const startTime = Math.max(speedEvents[i].time, 0);\n      const endTime = i < speedEvents.length - 1 ? speedEvents[i + 1].time : 1e9;\n      const value = speedEvents[i].value * 11 / 45;\n      const floorPosition = floorPos;\n      floorPos += (endTime - startTime) * value / this.bpm * 1.875;\n      floorPos = Math.fround(floorPos);\n      result.speedEvents.push({ startTime, endTime, value, floorPosition });\n    }\n    // 处理notes\n    const sortFn = (a: { time: number }, b: { time: number }) => a.time - b.time;\n    for (const i of this.notes.sort(sortFn)) {\n      const { time } = i;\n      let v1 = 0;\n      let v2 = 0;\n      let v3 = 0;\n      for (const e of result.speedEvents) {\n        if (time > e.endTime) continue;\n        if (time < e.startTime) break;\n        v1 = e.floorPosition;\n        v2 = e.value;\n        v3 = time - e.startTime;\n      }\n      const note = {\n        type: i.type,\n        time: time + (i.isFake ? 1e9 : 0),\n        positionX: i.positionX,\n        holdTime: i.holdTime,\n        speed: i.speed * (i.type === 3 ? v2 : 1),\n        floorPosition: Math.fround(v1 + v2 * v3 / this.bpm * 1.875)\n      };\n      if (i.isAbove) {\n        result.notesAbove.push(note);\n        if (i.isFake) continue;\n        result.numOfNotes++;\n        result.numOfNotesAbove++;\n      } else {\n        result.notesBelow.push(note);\n        if (i.isFake) continue;\n        result.numOfNotes++;\n        result.numOfNotesBelow++;\n      }\n    }\n    return result;\n  }\n}\ninterface RPEMeta {\n  RPEVersion: string;\n  song: string;\n  background: string;\n  name: string;\n  composer: string;\n  charter: string;\n  level: string;\n  offset: number;\n}\ninterface RPEDataBase {\n  BPMList: BpmEventRPEExtends[];\n  judgeLineList: JudgeLineRPEExtends[];\n}\ntype RPEDataLegacy = RPEDataBase & RPEMeta & { META: undefined };\ntype RPEDataCurrent = RPEDataBase & { META: RPEMeta };\ntype RPEData = RPEDataCurrent | RPEDataLegacy;\ninterface JudgeLineRPE {\n  numOfNotes: number;\n  isCover: number;\n  Texture: string;\n  eventLayers: (EventLayer | null)[];\n  extended?: {\n    scaleXEvents: LineEventRPE[];\n    scaleYEvents: LineEventRPE[];\n  } | null;\n  notes: NoteRPE[] | null;\n  Group: number;\n  Name: string;\n  zOrder: number;\n  bpmfactor: number;\n  father: number;\n}\ninterface JudgeLineRPEExtends extends JudgeLineRPE {\n  LineId: number;\n  judgeLineRPE: LineRPE1;\n}\nexport function parse(pec: string, filename: string): {\n  data: string;\n  messages: string[];\n  info: ChartInfoData;\n  line: ChartLineData[];\n} {\n  const data = JSON.parse(pec) as RPEData;\n  const meta = data.META || data;\n  if (!meta?.RPEVersion) throw new Error('Invalid rpe file');\n  const result = { formatVersion: 3, offset: 0, numOfNotes: 0, judgeLineList: [] as JudgeLine[] };\n  const warnings = [];\n  warnings.push(`RPE谱面兼容建设中...\\n检测到RPE版本:${meta.RPEVersion}\\n来自${filename}`); // 谱面信息\n  const info: ChartInfoData = {};\n  info.Chart = filename;\n  info.Music = meta.song;\n  info.Image = meta.background;\n  info.Name = meta.name;\n  info.Artist = meta.composer;\n  info.Charter = meta.charter;\n  info.Level = meta.level;\n  result.offset = meta.offset / 1e3;\n  // 判定线贴图\n  const line: ChartLineData[] = [];\n  data.judgeLineList.forEach((i: JudgeLineRPEExtends, index: number) => {\n    i.LineId = index;\n    const texture = String(i.Texture).replace(/\\0/g, '');\n    if (texture === 'line.png') return;\n    const { extended } = i;\n    const scaleX = extended?.scaleXEvents ? extended.scaleXEvents[extended.scaleXEvents.length - 1].end : 1;\n    const scaleY = extended?.scaleYEvents ? extended.scaleYEvents[extended.scaleYEvents.length - 1].end : 1;\n    line.push({\n      Chart: filename,\n      LineId: index,\n      Image: texture,\n      Scale: scaleY,\n      Aspect: scaleX / scaleY,\n      UseBackgroundDim: 0,\n      UseLineColor: 1,\n      UseLineScale: 1\n    });\n  });\n  // bpm变速\n  const bpmList = new BpmList(data.BPMList[0].bpm);\n  for (const i of data.BPMList) { i.time = i.startTime[0] + i.startTime[1] / i.startTime[2] }\n  data.BPMList.sort((a: { time: number }, b: { time: number }) => a.time - b.time).forEach((i, idx, arr) => {\n    if (arr[idx + 1]?.time <= 0) return; // 过滤负数\n    bpmList.push(i.time < 0 ? 0 : i.time, arr[idx + 1]?.time ?? 1e9, i.bpm);\n  });\n  for (const i of data.judgeLineList) {\n    if (i.zOrder === undefined) i.zOrder = 0;\n    if (i.bpmfactor === undefined) i.bpmfactor = 1;\n    if (i.father === undefined) i.father = -1;\n    if (i.isCover !== 1) { warnings.push(`未兼容isCover=${i.isCover}(可能无法正常显示)\\n位于${i.LineId}号判定线\\n来自${filename}`) }\n    if (i.zOrder !== 0) { warnings.push(`未兼容zOrder=${i.zOrder}(可能无法正常显示)\\n位于${i.LineId}号判定线\\n来自${filename}`) }\n    if (i.bpmfactor !== 1) { warnings.push(`未兼容bpmfactor=${i.bpmfactor}(可能无法正常显示)\\n位于${i.LineId}号判定线\\n来自${filename}`) }\n    const lineRPE = new LineRPE1(bpmList.baseBpm);\n    lineRPE.setId(i.LineId);\n    if (i.notes) {\n      for (const note of i.notes) {\n        if (note.alpha === undefined) note.alpha = 255;\n        // if (note.above !== 1 && note.above !== 2) warnings.push(`检测到非法方向:${note.above}(将被视为2)\\n位于:\"${JSON.stringify(note)}\"\\n来自${filename}`);\n        if (note.isFake !== 0) warnings.push(`检测到FakeNote(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"\\n来自${filename}`);\n        if (note.size !== 1) warnings.push(`未兼容size=${note.size}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"\\n来自${filename}`);\n        if (note.yOffset !== 0) warnings.push(`未兼容yOffset=${note.yOffset}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"\\n来自${filename}`);\n        if (note.visibleTime !== 999999) warnings.push(`未兼容visibleTime=${note.visibleTime}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"\\n来自${filename}`);\n        if (note.alpha !== 255) warnings.push(`未兼容alpha=${note.alpha}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"\\n来自${filename}`);\n        const type = [0, 1, 4, 2, 3].indexOf(note.type);\n        const time = bpmList.calc2(note.startTime);\n        const holdTime = bpmList.calc2(note.endTime) - time;\n        const { speed } = note;\n        const positionX = note.positionX / 75.375;\n        lineRPE.pushNote(type, time, positionX, holdTime, speed, note.above === 1, note.isFake !== 0);\n      }\n    }\n    for (const e of i.eventLayers) {\n      if (!e) continue;\n      // 有可能是null\n      const layer = new EventLayer1();\n      for (const j of e.moveXEvents ?? []) {\n        if (j.linkgroup === undefined) j.linkgroup = 0;\n        if (j.linkgroup !== 0) {\n          warnings.push(`未兼容linkgroup=${j.linkgroup}(可能无法正常显示)\\n位于:\"${JSON.stringify(j)}\"\\n来自${filename}`);\n        }\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        layer.pushMoveXEvent(startTime, endTime, j.start, j.end, getEasingFn(j, startTime, endTime));\n      }\n      for (const j of e.moveYEvents ?? []) {\n        if (j.linkgroup === undefined) j.linkgroup = 0;\n        if (j.linkgroup !== 0) {\n          warnings.push(`未兼容linkgroup=${j.linkgroup}(可能无法正常显示)\\n位于:\"${JSON.stringify(j)}\"\\n来自${filename}`);\n        }\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        layer.pushMoveYEvent(startTime, endTime, j.start, j.end, getEasingFn(j, startTime, endTime));\n      }\n      for (const j of e.rotateEvents ?? []) {\n        if (j.linkgroup === undefined) j.linkgroup = 0;\n        if (j.linkgroup !== 0) {\n          warnings.push(`未兼容linkgroup=${j.linkgroup}(可能无法正常显示)\\n位于:\"${JSON.stringify(j)}\"\\n来自${filename}`);\n        }\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        layer.pushRotateEvent(startTime, endTime, j.start, j.end, getEasingFn(j, startTime, endTime));\n      }\n      for (const j of e.alphaEvents ?? []) {\n        if (j.linkgroup === undefined) j.linkgroup = 0;\n        if (j.linkgroup !== 0) {\n          warnings.push(`未兼容linkgroup=${j.linkgroup}(可能无法正常显示)\\n位于:\"${JSON.stringify(j)}\"\\n来自${filename}`);\n        }\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        layer.pushAlphaEvent(startTime, endTime, j.start, j.end, getEasingFn(j, startTime, endTime));\n      }\n      for (const j of e.speedEvents ?? []) {\n        if (j.linkgroup === undefined) j.linkgroup = 0;\n        if (j.linkgroup !== 0) {\n          warnings.push(`未兼容linkgroup=${j.linkgroup}(可能无法正常显示)\\n位于:\"${JSON.stringify(j)}\"\\n来自${filename}`);\n        }\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        layer.pushSpeedEvent(startTime, endTime, j.start, j.end);\n      }\n      lineRPE.eventLayers.push(layer);\n    }\n    i.judgeLineRPE = lineRPE;\n  }\n  for (const i of data.judgeLineList) {\n    const lineRPE = i.judgeLineRPE; // TODO: 待优化\n    const father = data.judgeLineList[i.father];\n    lineRPE.setFather(father?.judgeLineRPE);\n  }\n  for (const i of data.judgeLineList) {\n    const lineRPE = i.judgeLineRPE; // TODO: 待优化\n    const judgeLine = lineRPE.format({ onwarning: (msg: string) => warnings.push(`${msg}\\n来自${filename}`) });\n    result.judgeLineList.push(judgeLine);\n    result.numOfNotes += judgeLine.numOfNotes;\n  }\n  return { data: JSON.stringify(result), messages: warnings, info, line };\n}\n","import { parse } from './pec2json';\nimport { parse as parseRPE } from './rpe2json';\n// 读取info.txt\nfunction readInfo(text: string): Record<string, string>[] {\n  const lines = String(text).split(/\\r?\\n/);\n  const result = [];\n  let current = {} as Record<string, string>;\n  for (const i of lines) {\n    if (i.startsWith('#')) {\n      if (Object.keys(current).length) result.push(current);\n      current = {};\n    } else {\n      let [key, value] = i.split(/:(.+)/).map(s => s.trim());\n      if (key === 'Song') key = 'Music';\n      if (key === 'Picture') key = 'Image';\n      if (key) current[key] = value;\n    }\n  }\n  if (Object.keys(current).length) result.push(current);\n  return result;\n}\nexport default { parse, parseRPE, readInfo };\n","import { isLinear } from './easing.js';\nimport { BpmList } from './BpmList';\nimport { LinePec } from './LinePec';\ninterface BpmCommand {\n  time: number;\n  bpm: number;\n}\ninterface NoteCommand {\n  type: number;\n  lineId: number;\n  time: number;\n  time2: number;\n  offsetX: number;\n  isAbove: number;\n  isFake: number;\n  text: string;\n  speed: number;\n  size: number;\n}\ninterface LineCommand {\n  type: string;\n  lineId: number;\n  time: number;\n  time2: number;\n  speed: number;\n  offsetX: number;\n  offsetY: number;\n  rotation: number;\n  alpha: number;\n  motionType: number;\n  text: string;\n}\ninterface PecParseResult {\n  data: string;\n  messages: string[];\n}\nexport function parse(pec: string, filename: string): PecParseResult {\n  const data = pec.split(/\\s+/); // 切分pec文本\n  const data2 = {\n    offset: 0,\n    bpmList: [] as BpmCommand[],\n    notes: [] as NoteCommand[],\n    lines: [] as LineCommand[]\n  };\n  const result = {\n    formatVersion: 3,\n    offset: 0,\n    numOfNotes: 0,\n    judgeLineList: [] as JudgeLine[]\n  };\n  const warnings = []; //\n  let ptr = 0;\n  data2.offset = isNaN(Number(data[ptr])) ? 0 : Number(data[ptr++]);\n  while (ptr < data.length) {\n    const command = data[ptr++];\n    if (command === '') { continue }\n    if (command === 'bp') {\n      const time = Number(data[ptr++]);\n      const bpm = Number(data[ptr++]);\n      data2.bpmList.push({ time, bpm });\n    } else if (command.startsWith('n')) {\n      if (!'1234'.includes(command[1])) { throw new Error(`Unsupported Command: ${command}`) }\n      const cmd = {} as NoteCommand;\n      const type = command[1];\n      cmd.type = Number(type);\n      cmd.lineId = Number(data[ptr++]);\n      cmd.time = Number(data[ptr++]);\n      cmd.time2 = '2'.includes(type) ? Number(data[ptr++]) : cmd.time;\n      cmd.offsetX = Number(data[ptr++]);\n      cmd.isAbove = Number(data[ptr++]);\n      cmd.isFake = Number(data[ptr++]);\n      cmd.text = `n${Object.values(cmd).join(' ')}`;\n      cmd.speed = (data[ptr++] || '').startsWith('#') ? Number(data[ptr++]) : (ptr--, 1);\n      cmd.size = (data[ptr++] || '').startsWith('&') ? Number(data[ptr++]) : (ptr--, 1);\n      data2.notes.push(cmd);\n    } else if (command.startsWith('c')) {\n      if (!'vpdamrf'.includes(command[1])) { throw new Error(`Unsupported Command: ${command}`) }\n      const cmd = {} as LineCommand;\n      const type = command[1];\n      cmd.type = type;\n      cmd.lineId = Number(data[ptr++]);\n      cmd.time = Number(data[ptr++]);\n      if ('v'.includes(type)) { cmd.speed = Number(data[ptr++]) }\n      cmd.time2 = 'mrf'.includes(type) ? Number(data[ptr++]) : cmd.time;\n      if ('pm'.includes(type)) { cmd.offsetX = Number(data[ptr++]) }\n      if ('pm'.includes(type)) { cmd.offsetY = Number(data[ptr++]) }\n      if ('dr'.includes(type)) { cmd.rotation = Number(data[ptr++]) }\n      if ('af'.includes(type)) { cmd.alpha = Number(data[ptr++]) }\n      if ('mr'.includes(type)) { cmd.motionType = Number(data[ptr++]) }\n      cmd.text = `c${Object.values(cmd).join(' ')}`;\n      if ('pdaf'.includes(type)) { cmd.motionType = 1 }\n      data2.lines.push(cmd);\n    } else { throw new Error(`Unexpected Command: ${command}`) }\n  }\n  result.offset = data2.offset / 1e3 - 0.175; // v18x固定延迟\n  // bpm变速\n  if (!data2.bpmList.length) { throw new Error('Invalid pec file') }\n  const bpmList = new BpmList(data2.bpmList[0].bpm); // FIXME: 考虑合适的bpm范围\n  data2.bpmList.sort((a, b) => a.time - b.time).forEach((i, idx, arr) => {\n    if (arr[idx + 1]?.time <= 0) { return } // 过滤负数\n    bpmList.push(i.time < 0 ? 0 : i.time, arr[idx + 1]?.time ?? 1e9, i.bpm);\n  });\n  // note和判定线事件\n  const linesPec = [] as LinePec[];\n  for (const i of data2.notes) {\n    const type = [0, 1, 4, 2, 3].indexOf(i.type);\n    const time = bpmList.calc(i.time);\n    const holdTime = bpmList.calc(i.time2) - time;\n    const speed = isNaN(i.speed) ? 1 : i.speed;\n    linesPec[i.lineId] ??= new LinePec(bpmList.baseBpm);\n    linesPec[i.lineId].pushNote(type, time, i.offsetX / 115.2, holdTime, speed, i.isAbove === 1, i.isFake !== 0); // 102.4\n    // if (i.isAbove !== 1 && i.isAbove !== 2) warnings.push(`检测到非法方向:${i.isAbove}(将被视为2)\\n位于:\"${i.text}\"\\n来自${filename}`);\n    if (i.isFake !== 0) {\n      warnings.push(`检测到FakeNote(可能无法正常显示)\\n位于:\"${i.text}\"\\n来自${filename}`);\n    }\n    if (i.size !== 1) { warnings.push(`检测到异常Note(可能无法正常显示)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n  }\n  const isMotion = (i: number) => !isLinear(i) || i === 1;\n  for (const i of data2.lines) {\n    const t1 = bpmList.calc(i.time);\n    const t2 = bpmList.calc(i.time2);\n    if (t1 > t2) {\n      warnings.push(`检测到开始时间大于结束时间(将禁用此事件)\\n位于:\"${i.text}\"\\n来自${filename}`);\n      continue;\n    }\n    linesPec[i.lineId] ??= new LinePec(bpmList.baseBpm);\n    // 变速\n    if (i.type === 'v') {\n      linesPec[i.lineId].pushSpeedEvent(t1, i.speed / 7.0); // 6.0??\n    }\n    // 不透明度\n    if (i.type === 'a' || i.type === 'f') {\n      linesPec[i.lineId].pushAlphaEvent(t1, t2, Math.max(i.alpha / 255, 0), i.motionType); // 暂不支持alpha值扩展\n      if (i.alpha < 0) { warnings.push(`检测到负数Alpha:${i.alpha}(将被视为0)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n    // 移动\n    if (i.type === 'p' || i.type === 'm') {\n      linesPec[i.lineId].pushMoveEvent(t1, t2, i.offsetX / 2048, i.offsetY / 1400, isMotion(i.motionType) ? i.motionType : 1);\n      if (!isMotion(i.motionType)) { warnings.push(`未知的缓动类型:${i.motionType}(将被视为1)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n    // 旋转\n    if (i.type === 'd' || i.type === 'r') {\n      linesPec[i.lineId].pushRotateEvent(t1, t2, -i.rotation, isMotion(i.motionType) ? i.motionType : 1);\n      if (!isMotion(i.motionType)) { warnings.push(`未知的缓动类型:${i.motionType}(将被视为1)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n  }\n  for (const i of linesPec) {\n    const judgeLine = i.format();\n    result.judgeLineList.push(judgeLine);\n    result.numOfNotes += judgeLine.numOfNotes;\n  }\n  return { data: JSON.stringify(result), messages: warnings };\n}\n","import Pec from '../extends/pec/index';\nimport { chart123, defineReader, fileReader, joinPathInfo } from './reader';\nimport md5 from 'md5';\nfileReader.use(defineReader({\n  pattern: /\\.(json|pec)$/i,\n  type: 'json',\n  read(i: ByteData) {\n    const rpeData = Pec.parseRPE(i.text!, i.name/* , path */); // TODO: path\n    const jsonData = chart123(rpeData.data);\n    const { messages: msg, info, line } = rpeData;\n    return { type: 'chart', name: i.name, md5: md5(i.text!), data: jsonData, msg, info, line };\n  }\n}));\nfileReader.use(defineReader({\n  pattern: /\\.pec$/i,\n  type: 'text',\n  read(i: ByteData) {\n    const pecData = Pec.parse(i.text!, i.name);\n    const jsonData = chart123(pecData.data);\n    return { type: 'chart', name: i.name, md5: md5(i.text!), data: jsonData, msg: pecData.messages };\n  }\n}));\nfileReader.use(defineReader({\n  pattern: /^(Settings|info)\\.txt$/i,\n  type: 'text',\n  mustMatch: true,\n  read(i: ByteData, path: string) {\n    const data = i.text!;\n    const chartInfo = joinPathInfo(Pec.readInfo(data), path);\n    return { type: 'info' as const, data: chartInfo };\n  }\n}));\nif (Object.hasOwn(self, 'webp')) {\n  fileReader.use(defineReader({\n    pattern: /\\.webp$/i,\n    type: 'binary',\n    async read(i: ByteData) {\n      const webp2canvas = Object.getOwnPropertyDescriptor(self, 'webp')?.value.default as (buffer: ArrayBuffer) => Promise<HTMLCanvasElement>;\n      const img = await webp2canvas(i.buffer);\n      const bitmap = await createImageBitmap(img);\n      return { type: 'image', name: i.name, data: bitmap };\n    }\n  }));\n}\n// fileReader.use(defineReader({\n//   pattern: /^\\.ogg$/i,\n//   type: 'binary',\n//   async read(i: ByteData) {\n//     const { OggVorbisDecoder } = await import('@wasm-audio-decoders/ogg-vorbis');\n//     const decoder = new OggVorbisDecoder();\n//     await decoder.ready;\n//     const { channelData, samplesDecoded, sampleRate } = await decoder.decodeFile(new Uint8Array(i.buffer));\n//     decoder.free();\n//     const actx = new (window.AudioContext || window.webkitAudioContext)();\n//     const ab = actx.createBuffer(channelData.length, samplesDecoded, sampleRate);\n//     channelData.forEach((channel, idx) => ab.getChannelData(idx).set(channel));\n//     return { type: 'audio', name: i.name, data: { audio: ab, video: null } };\n//   }\n// }));\n"],"names":["tl","Math","sin","t","PI","cos","sqrt","isLinear","index","trunc","easing","BpmList","constructor","baseBpm","__publicField","this","Number","accTime","list","push","start","end","bpm","value","calc","beat","time","i","round","calc2","LinePec","speedEvents","notes","alphaEvents","moveEvents","rotateEvents","isNaN","pushNote","type","positionX","holdTime","speed","isAbove","isFake","pushSpeedEvent","pushAlphaEvent","startTime","endTime","motionType","pushMoveEvent","value2","pushRotateEvent","format","sortFn","e","a","b","sortFn2","s","result","formatVersion","offset","numOfNotes","numOfNotesAbove","numOfNotesBelow","notesAbove","notesBelow","judgeLineDisappearEvents","judgeLineMoveEvents","judgeLineRotateEvents","pushDisappearEvent","start2","end2","c","cvp","sort","s1","length","max","floorPosition","fround","v1","v2","v3","note","dt","d1","t1","x1","x2","mt","m1","m2","t2","rt","r1","cubicBezier","p1x","p1y","p2x","p2y","ax","bx","cx","ay","by","cy","sampleCurveDerivativeX","sampleCurveX","solve","x","sampleCurveY","derivative","abs","t0","solveCurveX","getEasingFn","le","bezier","easingType","easingLeft","easingRight","easingFn","eHead","eTail","eSpeed","eDelta","bezierPoints","Error","pushLineEvent","ls","delta","j","getEventsValue","d","_ref2","_a","getMoveValue","_ref3","_ref4","result2","_b","getRotateValue","_ref5","combineMultiEvents","es","splits","reduce","n","EventLayer1","moveXEvents","moveYEvents","pushMoveXEvent","pushMoveYEvent","LineRPE1","eventLayers","father","settled","merged","setId","id","NaN","setFather","fatherLine","preset","events","map","xe","ye","startX","endX","startY","endY","combineXYEvents","toSpeedEvent","fitFather","stack","onwarning","console","warn","includes","concat","join","child","fatherX","fatherY","fatherR","fatherX2","fatherY2","fatherR2","childX","childY","childX2","childY2","mergeFather","floorPos","Pec","pec","filename","data","split","data2","bpmList","lines","judgeLineList","warnings","ptr","command","startsWith","cmd","lineId","time2","offsetX","text","Object","values","size","offsetY","rotation","alpha","forEach","idx","arr","_ref","linesPec","_p$l","indexOf","isMotion","_p$f","judgeLine","JSON","stringify","messages","parseRPE","parse","meta","META","RPEVersion","info","Chart","Music","song","Image","background","Name","name","Artist","composer","Charter","charter","Level","level","line","LineId","texture","String","Texture","replace","extended","scaleX","scaleXEvents","scaleY","scaleYEvents","Scale","Aspect","UseBackgroundDim","UseLineColor","UseLineScale","BPMList","_ref6","zOrder","bpmfactor","isCover","lineRPE","yOffset","visibleTime","above","layer","_f$moveXEvents","linkgroup","_f$moveYEvents","_f$rotateEvents","_f$alphaEvents","_f$speedEvents","judgeLineRPE","msg","readInfo","current","keys","key","trim","fileReader","use","defineReader","pattern","read","rpeData","jsonData","chart123","md5","pecData","mustMatch","path","joinPathInfo","hasOwn","self","img","getOwnPropertyDescriptor","default","buffer","bitmap","createImageBitmap"],"mappings":"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"}