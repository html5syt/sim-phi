{"version":3,"file":"reader--9d7c21a2.js","sources":["../src/extends/pec/easing.js","../src/extends/pec/BpmList.ts","../src/extends/pec/LinePec.ts","../src/extends/pec/cubicBezier.js","../src/extends/pec/rpe2json.ts","../src/extends/pec/index.ts","../src/extends/pec/pec2json.ts","../src/utils/reader-.ts"],"sourcesContent":["/* eslint-disable no-param-reassign */\nconst tl = [\n  null, // 0\n  null, // 1\n  t => Math.sin(t * Math.PI / 2), // 2\n  t => 1 - Math.cos(t * Math.PI / 2), // 3\n  t => 1 - (t - 1) ** 2, // 4\n  t => t ** 2, // 5\n  t => (1 - Math.cos(t * Math.PI)) / 2, // 6\n  t => ((t *= 2) < 1 ? t ** 2 : -((t - 2) ** 2 - 2)) / 2, // 7\n  t => 1 + (t - 1) ** 3, // 8\n  t => t ** 3, // 9\n  t => 1 - (t - 1) ** 4, // 10\n  t => t ** 4, // 11\n  t => ((t *= 2) < 1 ? t ** 3 : (t - 2) ** 3 + 2) / 2, // 12\n  t => ((t *= 2) < 1 ? t ** 4 : -((t - 2) ** 4 - 2)) / 2, // 13\n  t => 1 + (t - 1) ** 5, // 14\n  t => t ** 5, // 15\n  t => 1 - 2 ** (-10 * t), // 16\n  t => 2 ** (10 * (t - 1)), // 17\n  t => Math.sqrt(1 - (t - 1) ** 2), // 18\n  t => 1 - Math.sqrt(1 - t ** 2), // 19\n  t => (2.70158 * t - 1) * (t - 1) ** 2 + 1, // 20\n  t => (2.70158 * t - 1.70158) * t ** 2, // 21\n  t => ((t *= 2) < 1 ? 1 - Math.sqrt(1 - t ** 2) : Math.sqrt(1 - (t - 2) ** 2) + 1) / 2, // 22\n  t => t < 0.5 ? (14.379638 * t - 5.189819) * t ** 2 : (14.379638 * t - 9.189819) * (t - 1) ** 2 + 1, // 23\n  t => 1 - 2 ** (-10 * t) * Math.cos(t * Math.PI / 0.15), // 24\n  t => 2 ** (10 * (t - 1)) * Math.cos((t - 1) * Math.PI / 0.15), // 25\n  t => ((t *= 11) < 4 ? t ** 2 : t < 8 ? (t - 6) ** 2 + 12 : t < 10 ? (t - 9) ** 2 + 15 : (t - 10.5) ** 2 + 15.75) / 16, // 26\n  t => 1 - tl[26](1 - t), // 27\n  t => (t *= 2) < 1 ? tl[26](t) / 2 : tl[27](t - 1) / 2 + 0.5, // 28\n  t => t < 0.5 ? 2 ** (20 * t - 11) * Math.sin((160 * t + 1) * Math.PI / 18) : 1 - 2 ** (9 - 20 * t) * Math.sin((160 * t + 1) * Math.PI / 18) // 29\n];\nfunction isLinear(index) {\n  index = Math.trunc(index);\n  return index < 2 || index > 29;\n}\n/**\n * @param {number} index\n * @returns {((t: number) => number) | null}\n */\nfunction easing(index) {\n  index = Math.trunc(index);\n  return tl[index];\n}\nexport { isLinear, easing };\n","interface BpmEventPec {\n  start: number;\n  end: number;\n  bpm: number;\n  value: number;\n}\nexport type BeatArray = [number, number, number];\nexport class BpmList {\n  public baseBpm: number;\n  private accTime: number;\n  private readonly list: BpmEventPec[];\n  public constructor(baseBpm: unknown) {\n    this.baseBpm = Number(baseBpm) || 120;\n    this.accTime = 0;\n    this.list = []; // 存放bpm变速事件\n  }\n  public push(start: number, end: number, bpm: number): void {\n    const value = this.accTime;\n    this.list.push({ start, end, bpm, value });\n    this.accTime += (end - start) / bpm;\n  }\n  public calc(beat: number): number {\n    let time = 0;\n    for (const i of this.list) {\n      if (beat > i.end) continue;\n      if (beat < i.start) break;\n      time = Math.round(((beat - i.start) / i.bpm + i.value) * this.baseBpm * 32);\n    }\n    return time;\n  }\n  public calc2(time: BeatArray): number {\n    return this.calc(time[0] + time[1] / time[2]);\n  }\n}\n","import { easing } from './easing.js';\ninterface SpeedEventPec {\n  time: number;\n  value: number;\n}\ninterface NotePecExtends {\n  type: number;\n  time: number;\n  positionX: number;\n  holdTime: number;\n  speed: number;\n  isAbove: boolean;\n  isFake: boolean;\n}\ninterface LineEventPec {\n  startTime: number;\n  endTime: number;\n  value: number;\n  motionType: number;\n}\ninterface LineEventPecExtends extends LineEventPec {\n  value2: number;\n}\nexport class LinePec {\n  private readonly bpm: number;\n  private readonly speedEvents: SpeedEventPec[];\n  private readonly notes: NotePecExtends[];\n  private readonly alphaEvents: LineEventPec[];\n  private readonly moveEvents: LineEventPecExtends[];\n  private readonly rotateEvents: LineEventPec[];\n  public constructor(bpm: number) {\n    this.bpm = 120;\n    this.speedEvents = [];\n    this.notes = [];\n    this.alphaEvents = [];\n    this.moveEvents = [];\n    this.rotateEvents = [];\n    if (!isNaN(bpm)) { this.bpm = bpm }\n  }\n  public pushNote(type: number, time: number, positionX: number, holdTime: number, speed: number, isAbove: boolean, isFake: boolean): void {\n    this.notes.push({ type, time, positionX, holdTime, speed, isAbove, isFake });\n  }\n  public pushSpeedEvent(time: number, value: number): void {\n    this.speedEvents.push({ time, value });\n  }\n  public pushAlphaEvent(startTime: number, endTime: number, value: number, motionType: number): void {\n    this.alphaEvents.push({ startTime, endTime, value, motionType });\n  }\n  public pushMoveEvent(startTime: number, endTime: number, value: number, value2: number, motionType: number): void {\n    this.moveEvents.push({ startTime, endTime, value, value2, motionType });\n  }\n  public pushRotateEvent(startTime: number, endTime: number, value: number, motionType: number): void {\n    this.rotateEvents.push({ startTime, endTime, value, motionType });\n  }\n  public format(): JudgeLine {\n    const sortFn = (a: { time: number }, b: { time: number }) => a.time - b.time;\n    const sortFn2 = (a: { startTime: number; endTime: number }, b: { startTime: number; endTime: number }) => a.startTime - b.startTime + (a.endTime - b.endTime);\n    // 不单独判断以避免误差\n    const result = {\n      formatVersion: 3,\n      offset: 0,\n      bpm: this.bpm,\n      speedEvents: [] as SpeedEvent[],\n      numOfNotes: 0,\n      numOfNotesAbove: 0,\n      numOfNotesBelow: 0,\n      notesAbove: [] as Note[],\n      notesBelow: [] as Note[],\n      judgeLineDisappearEvents: [] as JudgeLineEvent[],\n      judgeLineMoveEvents: [] as JudgeLineEvent[],\n      judgeLineRotateEvents: [] as JudgeLineEvent[]\n    };\n    const pushDisappearEvent = (startTime: number, endTime: number, start: number, end: number) => {\n      result.judgeLineDisappearEvents.push({ startTime, endTime, start, end, start2: 0, end2: 0 });\n    };\n    const pushMoveEvent = (startTime: number, endTime: number, start: number, end: number, start2: number, end2: number) => {\n      result.judgeLineMoveEvents.push({ startTime, endTime, start, end, start2, end2 });\n    };\n    const pushRotateEvent = (startTime: number, endTime: number, start: number, end: number) => {\n      result.judgeLineRotateEvents.push({ startTime, endTime, start, end, start2: 0, end2: 0 });\n    };\n    // cv和floorPosition一并处理\n    const cvp = this.speedEvents.sort(sortFn);\n    let s1 = 0;\n    for (let i = 0; i < cvp.length; i++) {\n      const startTime = Math.max(cvp[i].time, 0);\n      const endTime = i < cvp.length - 1 ? cvp[i + 1].time : 1e9;\n      const { value } = cvp[i];\n      const floorPosition = s1;\n      s1 += (endTime - startTime) * value / this.bpm * 1.875;\n      s1 = Math.fround(s1);\n      result.speedEvents.push({ startTime, endTime, value, floorPosition });\n    }\n    for (const i of this.notes.sort(sortFn)) {\n      const { time } = i;\n      let v1 = 0;\n      let v2 = 0;\n      let v3 = 0;\n      for (const e of result.speedEvents) {\n        if (time > e.endTime) { continue }\n        if (time < e.startTime) { break }\n        v1 = e.floorPosition;\n        v2 = e.value;\n        v3 = time - e.startTime;\n      }\n      const note = {\n        type: i.type,\n        time: time + (i.isFake ? 1e9 : 0),\n        positionX: i.positionX,\n        holdTime: i.holdTime,\n        speed: i.speed * (i.type === 3 ? v2 : 1),\n        floorPosition: Math.fround(v1 + v2 * v3 / this.bpm * 1.875)\n      };\n      if (i.isAbove) {\n        result.notesAbove.push(note);\n        if (i.isFake) { continue }\n        result.numOfNotes++;\n        result.numOfNotesAbove++;\n      } else {\n        result.notesBelow.push(note);\n        if (i.isFake) { continue }\n        result.numOfNotes++;\n        result.numOfNotesBelow++;\n      }\n    }\n    // 整合motionType\n    let dt = 0;\n    let d1 = 0;\n    for (const e of this.alphaEvents.sort(sortFn2)) {\n      pushDisappearEvent(dt, e.startTime, d1, d1);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - d1;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushDisappearEvent(i, i + 1, d1 + x1 * t1, d1 + x2 * t1);\n        }\n      } else if (e.motionType) pushDisappearEvent(e.startTime, e.endTime, d1, e.value);\n      dt = e.endTime;\n      d1 = e.value;\n    }\n    pushDisappearEvent(dt, 1e9, d1, d1);\n    //\n    let mt = 0;\n    let m1 = 0;\n    let m2 = 0;\n    for (const e of this.moveEvents.sort(sortFn2)) {\n      pushMoveEvent(mt, e.startTime, m1, m1, m2, m2);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - m1;\n        const t2 = e.value2 - m2;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushMoveEvent(i, i + 1, m1 + x1 * t1, m1 + x2 * t1, m2 + x1 * t2, m2 + x2 * t2);\n        }\n      } else if (e.motionType === 1) pushMoveEvent(e.startTime, e.endTime, m1, e.value, m2, e.value2);\n      mt = e.endTime;\n      m1 = e.value;\n      m2 = e.value2;\n    }\n    pushMoveEvent(mt, 1e9, m1, m1, m2, m2);\n    //\n    let rt = 0;\n    let r1 = 0;\n    for (const e of this.rotateEvents.sort(sortFn2)) {\n      pushRotateEvent(rt, e.startTime, r1, r1);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - r1;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushRotateEvent(i, i + 1, r1 + x1 * t1, r1 + x2 * t1);\n        }\n      } else if (e.motionType === 1) pushRotateEvent(e.startTime, e.endTime, r1, e.value);\n      rt = e.endTime;\n      r1 = e.value;\n    }\n    pushRotateEvent(rt, 1e9, r1, r1);\n    return result;\n  }\n}\n","export function cubicBezier(p1x, p1y, p2x, p2y) {\n  const ZERO_LIMIT = 1e-6;\n  // Calculate the polynomial coefficients,\n  // implicit first and last control points are (0,0) and (1,1).\n  const ax = 3 * p1x - 3 * p2x + 1;\n  const bx = 3 * p2x - 6 * p1x;\n  const cx = 3 * p1x;\n  const ay = 3 * p1y - 3 * p2y + 1;\n  const by = 3 * p2y - 6 * p1y;\n  const cy = 3 * p1y;\n  function sampleCurveDerivativeX(t) {\n    // `ax t^3 + bx t^2 + cx t` expanded using Horner's rule\n    return (3 * ax * t + 2 * bx) * t + cx;\n  }\n  function sampleCurveX(t) {\n    return ((ax * t + bx) * t + cx) * t;\n  }\n  function sampleCurveY(t) {\n    return ((ay * t + by) * t + cy) * t;\n  }\n  // Given an x value, find a parametric value it came from.\n  function solveCurveX(x) {\n    let t2 = x;\n    let derivative, x2;\n    // https://trac.webkit.org/browser/trunk/Source/WebCore/platform/animation\n    // first try a few iterations of Newton's method -- normally very fast.\n    // http://en.wikipedia.org/wikiNewton's_method\n    for (let i = 0; i < 8; i++) {\n      // f(t) - x = 0\n      x2 = sampleCurveX(t2) - x;\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n      derivative = sampleCurveDerivativeX(t2);\n      // == 0, failure\n      if (Math.abs(derivative) < ZERO_LIMIT) {\n        break;\n      }\n      t2 -= x2 / derivative;\n    }\n    // Fall back to the bisection method for reliability.\n    // bisection\n    // http://en.wikipedia.org/wiki/Bisection_method\n    let t1 = 1;\n    let t0 = 0;\n    t2 = x;\n    while (t1 > t0) {\n      x2 = sampleCurveX(t2) - x;\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n      if (x2 > 0) {\n        t1 = t2;\n      } else {\n        t0 = t2;\n      }\n      t2 = (t1 + t0) / 2;\n    }\n    // Failure\n    return t2;\n  }\n  function solve(x) {\n    return sampleCurveY(solveCurveX(x));\n  }\n  return solve;\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { type BeatArray, BpmList } from './BpmList';\nimport { easing } from './easing.js';\nimport { cubicBezier } from './cubicBezier.js';\ninterface BpmEventRPE {\n  startTime: BeatArray;\n  bpm: number;\n}\ninterface BpmEventRPEExtends extends BpmEventRPE {\n  time: number;\n}\ninterface LineEventPec {\n  startTime: number;\n  endTime: number;\n  start: number;\n  end: number;\n}\ninterface LineEventPec2 extends LineEventPec {\n  start2: number;\n  end2: number;\n}\ninterface LineEventPecDelta extends LineEventPec {\n  delta: number;\n}\ninterface SpeedEventPec {\n  time: number;\n  value: number;\n}\ninterface LineEventRPE {\n  startTime: BeatArray;\n  endTime: BeatArray;\n  start: number;\n  end: number;\n  easingType: number;\n  linkgroup?: number;\n  easingLeft?: number;\n  easingRight?: number;\n  bezier?: number;\n  bezierPoints?: [number, number, number, number];\n}\ninterface LineEventRPE2 {\n  startTime: number;\n  endTime: number;\n  start: number;\n  end: number;\n  easingFn?: (t: number) => number;\n}\nconst enum EasingCode {\n  NoError = 0,\n  EqualsLinear = 1,\n  LeftEqualsRight = -1,\n  TypeNotSupported = -2,\n  ValueNotFinite = -3\n}\ninterface EasingResult {\n  code: EasingCode;\n  fn?: (t: number) => number;\n}\nfunction getEasingFn(le: LineEventRPE, startTime: number, endTime: number): EasingResult {\n  const { start, end, bezier = 0 } = le;\n  if (Math.floor(bezier) === 1) return bezierFn();\n  return clipFn();\n  function clipFn() {\n    const { easingType, easingLeft = 0, easingRight = 1 } = le;\n    if (easingLeft === easingRight) return { code: EasingCode.LeftEqualsRight };\n    if (start === end) return { code: EasingCode.EqualsLinear };\n    const easingFn = easing(easingType);\n    if (easingFn == null) return { code: easingType === 1 ? EasingCode.EqualsLinear : EasingCode.TypeNotSupported };\n    const eHead = easingFn(easingLeft);\n    const eTail = easingFn(easingRight);\n    const eSpeed = (easingRight - easingLeft) / (endTime - startTime);\n    const e1Delta = (end - start) / (eTail - eHead);\n    if (!isFinite(e1Delta)) return { code: EasingCode.ValueNotFinite };\n    return { code: EasingCode.NoError, fn: (t: number) => (easingFn((t - startTime) * eSpeed + easingLeft) - eHead) * e1Delta };\n  }\n  function bezierFn() {\n    if (start === end) return { code: EasingCode.EqualsLinear };\n    const { bezierPoints: [p1x, p1y, p2x, p2y] = [0, 0, 0, 0] } = le;\n    if (p1x === p1y && p2x === p2y) return { code: EasingCode.EqualsLinear };\n    const eSpeed = 1 / (endTime - startTime);\n    const e1Delta = end - start;\n    const easingFn = cubicBezier(p1x, p1y, p2x, p2y);\n    return { code: EasingCode.NoError, fn: (t: number) => easingFn((t - startTime) * eSpeed) * e1Delta };\n  }\n}\nfunction pushLineEvent(ls: LineEventPecDelta[], le: LineEventRPE2) {\n  const { startTime, endTime, start, end, easingFn } = le;\n  const delta = (end - start) / (endTime - startTime);\n  // 插入之前考虑事件时间的相互关系\n  for (let i = ls.length - 1; i >= 0; i--) {\n    const e = ls[i];\n    if (e.endTime < startTime) { // 相离：补全空隙\n      ls[i + 1] = { startTime: e.endTime, endTime: startTime, start: e.end, end: e.end, delta: 0 };\n      break;\n    }\n    if (e.startTime === startTime) { // 相切：直接截断\n      ls.length = i;\n      break;\n    }\n    if (e.startTime < startTime) { // 相交：截断交点以后的部分\n      e.end = e.start + (startTime - e.startTime) * e.delta;\n      e.endTime = startTime;\n      e.delta = (e.end - e.start) / (startTime - e.startTime);\n      ls.length = i + 1;\n      break;\n    }\n  }\n  // 插入新事件\n  if (startTime >= endTime) {\n    ls.push({ startTime, endTime: startTime, start: end, end, delta: 0 });\n    return;\n  }\n  if (easingFn == null) {\n    ls.push({ startTime, endTime, start, end, delta });\n  } else {\n    let v1 = 0;\n    let v2 = 0;\n    for (let j = startTime; j < endTime; j++) {\n      v1 = v2;\n      v2 = easingFn(j + 1);\n      ls.push({ startTime: j, endTime: j + 1, start: start + v1, end: start + v2, delta: v2 - v1 });\n    }\n  }\n}\nfunction toSpeedEvent(le: LineEventRPE2[]) {\n  const result = [];\n  for (const i of le) {\n    const { startTime, endTime, start, end } = i;\n    result.push({ time: startTime, value: start });\n    if (start !== end) { // 暂未考虑开始时间大于结束时间的情况\n      const t1 = (end - start) / (endTime - startTime);\n      for (let j = startTime; j < endTime; j++) {\n        const x = j + 1 - startTime;\n        result.push({ time: j + 1, value: start + x * t1 });\n      }\n    }\n  }\n  return result;\n}\nfunction getEventsValue(e: LineEventPecDelta[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end, delta } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) result = end;\n    else result = start + (t - startTime) * delta;\n  }\n  return result;\n}\nfunction getMoveValue(e: LineEventPec2[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  let result2 = e[0]?.start2 ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end, start2, end2 } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) {\n      result = end;\n      result2 = end2;\n    } else {\n      result = start + (t - startTime) * (end - start) / (endTime - startTime);\n      result2 = start2 + (t - startTime) * (end2 - start2) / (endTime - startTime);\n    }\n  }\n  return [result, result2];\n}\nfunction getRotateValue(e: LineEventRPE2[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) result = end;\n    else { result = start + (t - startTime) * (end - start) / (endTime - startTime) }\n  }\n  return result;\n}\nfunction combineXYEvents(xe: LineEventPecDelta[], ye: LineEventPecDelta[]) {\n  const le = [];\n  const splits = [];\n  for (const i of xe) splits.push(i.startTime, i.endTime);\n  for (const i of ye) splits.push(i.startTime, i.endTime);\n  splits.sort((a, b) => a - b);\n  for (let i = 0; i < splits.length - 1; i++) {\n    const startTime = splits[i];\n    const endTime = splits[i + 1];\n    if (startTime === endTime) continue;\n    const startX = getEventsValue(xe, startTime, false);\n    const endX = getEventsValue(xe, endTime, true);\n    const startY = getEventsValue(ye, startTime, false);\n    const endY = getEventsValue(ye, endTime, true);\n    le.push({ startTime, endTime, start: startX, end: endX, start2: startY, end2: endY });\n  }\n  return le;\n}\nfunction combineMultiEvents(es: LineEventPecDelta[][]) {\n  const le = [];\n  const splits = [];\n  for (const e of es) {\n    for (const i of e) splits.push(i.startTime, i.endTime);\n  }\n  splits.sort((a, b) => a - b);\n  for (let i = 0; i < splits.length - 1; i++) {\n    const startTime = splits[i];\n    const endTime = splits[i + 1];\n    if (startTime === endTime) continue;\n    const start = es.reduce((n, e) => n + getEventsValue(e, startTime, false), 0);\n    const end = es.reduce((n, e) => n + getEventsValue(e, endTime, true), 0);\n    le.push({ startTime, endTime, start, end, delta: (end - start) / (endTime - startTime) });\n  }\n  return le;\n}\nfunction mergeFather(child: LineRPE1, father: LineRPE1) {\n  const moveEvents = [];\n  const splits = [];\n  for (const i of father.moveEvents!) splits.push(i.startTime, i.endTime);\n  for (const i of father.rotateEvents!) splits.push(i.startTime, i.endTime);\n  for (const i of child.moveEvents!) splits.push(i.startTime, i.endTime);\n  splits.sort((a, b) => a - b);\n  for (let i = splits[0]; i < splits[splits.length - 1]; i++) {\n    const startTime = i;\n    const endTime = i + 1;\n    if (startTime === endTime) continue;\n    // 计算父级移动和旋转\n    const [fatherX, fatherY] = getMoveValue(father.moveEvents!, startTime, false);\n    const fatherR = getRotateValue(father.rotateEvents!, startTime, false) * -Math.PI / 180;\n    const [fatherX2, fatherY2] = getMoveValue(father.moveEvents!, endTime, true);\n    const fatherR2 = getRotateValue(father.rotateEvents!, endTime, true) * -Math.PI / 180;\n    // 计算子级移动\n    const [childX, childY] = getMoveValue(child.moveEvents!, startTime, false);\n    const [childX2, childY2] = getMoveValue(child.moveEvents!, endTime, true);\n    // 坐标转换\n    const start = fatherX + childX * Math.cos(fatherR) - childY * Math.sin(fatherR);\n    const end = fatherX2 + childX2 * Math.cos(fatherR2) - childY2 * Math.sin(fatherR2);\n    const start2 = fatherY + childX * Math.sin(fatherR) + childY * Math.cos(fatherR);\n    const end2 = fatherY2 + childX2 * Math.sin(fatherR2) + childY2 * Math.cos(fatherR2);\n    moveEvents.push({ startTime, endTime, start, end, start2, end2 });\n  }\n  child.moveEvents = moveEvents;\n}\ninterface EventLayer {\n  moveXEvents: LineEventRPE[];\n  moveYEvents: LineEventRPE[];\n  rotateEvents: LineEventRPE[];\n  alphaEvents: LineEventRPE[];\n  speedEvents: LineEventRPE[];\n}\nclass EventLayer1 {\n  public moveXEvents: LineEventRPE2[];\n  public moveYEvents: LineEventRPE2[];\n  public rotateEvents: LineEventRPE2[];\n  public alphaEvents: LineEventRPE2[];\n  public speedEvents: LineEventRPE2[];\n  public constructor() {\n    this.moveXEvents = [];\n    this.moveYEvents = [];\n    this.rotateEvents = [];\n    this.alphaEvents = [];\n    this.speedEvents = [];\n  }\n  public pushMoveXEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.moveXEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushMoveYEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.moveYEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushRotateEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.rotateEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushAlphaEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.alphaEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushSpeedEvent(startTime: number, endTime: number, start: number, end: number) { this.speedEvents.push({ startTime, endTime, start, end }) }\n}\ninterface NoteRPE {\n  type: number;\n  startTime: BeatArray;\n  endTime: BeatArray;\n  positionX: number;\n  above: number;\n  isFake: number;\n  speed: number;\n  size: number;\n  yOffset: number;\n  visibleTime: number;\n  alpha: number;\n}\ninterface NoteRPE1 {\n  type: number;\n  time: number;\n  positionX: number;\n  holdTime: number;\n  speed: number;\n  isAbove: boolean;\n  isFake: boolean;\n}\nclass LineRPE1 {\n  public bpm: number;\n  public notes: NoteRPE1[];\n  public eventLayers: EventLayer1[];\n  public id?: number;\n  public father: LineRPE1 | null;\n  public moveEvents?: LineEventPec2[];\n  public rotateEvents?: LineEventPec[];\n  public alphaEvents?: LineEventPec[];\n  public speedEvents?: SpeedEventPec[];\n  private settled: boolean;\n  private merged: boolean;\n  public constructor(bpm: number) {\n    this.bpm = 120;\n    this.notes = [];\n    this.eventLayers = [];\n    this.father = null;\n    this.settled = false;\n    this.merged = false;\n    if (!isNaN(bpm)) this.bpm = bpm;\n  }\n  public pushNote(type: number, time: number, positionX: number, holdTime: number, speed: number, isAbove: boolean, isFake: boolean) {\n    this.notes.push({ type, time, positionX, holdTime, speed, isAbove, isFake });\n  }\n  public setId(id = NaN) { this.id = id }\n  public setFather(fatherLine: LineRPE1 | null) { this.father = fatherLine }\n  public preset() {\n    const sortFn2 = (a: { startTime: number }, b: { startTime: number }) => a.startTime - b.startTime;\n    const events = [];\n    for (const e of this.eventLayers) {\n      const moveXEvents: LineEventPecDelta[] = [];\n      const moveYEvents: LineEventPecDelta[] = [];\n      const rotateEvents: LineEventPecDelta[] = [];\n      const alphaEvents: LineEventPecDelta[] = [];\n      const speedEvents: LineEventPecDelta[] = [];\n      for (const i of e.moveXEvents.sort(sortFn2)) pushLineEvent(moveXEvents, i);\n      for (const i of e.moveYEvents.sort(sortFn2)) pushLineEvent(moveYEvents, i);\n      for (const i of e.rotateEvents.sort(sortFn2)) pushLineEvent(rotateEvents, i);\n      for (const i of e.alphaEvents.sort(sortFn2)) pushLineEvent(alphaEvents, i);\n      for (const i of e.speedEvents.sort(sortFn2)) pushLineEvent(speedEvents, i); // TODO: 特殊处理\n      events.push({ moveXEvents, moveYEvents, rotateEvents, alphaEvents, speedEvents });\n    }\n    const moveXEvents = combineMultiEvents(events.map(i => i.moveXEvents));\n    const moveYEvents = combineMultiEvents(events.map(i => i.moveYEvents));\n    this.moveEvents = combineXYEvents(moveXEvents, moveYEvents);\n    this.rotateEvents = combineMultiEvents(events.map(i => i.rotateEvents));\n    this.alphaEvents = combineMultiEvents(events.map(i => i.alphaEvents));\n    this.speedEvents = toSpeedEvent(combineMultiEvents(events.map(i => i.speedEvents)));\n    this.settled = true;\n  }\n  public fitFather(stack: LineRPE1[] = [], onwarning = console.warn) {\n    if (!this.settled) this.preset();\n    if (stack.includes(this)) {\n      onwarning(`检测到循环继承：${stack.concat(this).map(i => i.id).join('->')}(对应的father将被视为-1)`);\n      stack.map(i => i.setFather(null));\n      return;\n    }\n    if (this.father) this.father.fitFather(stack.concat(this), onwarning);\n    // this.father可能会在上一行被修改成null\n    if (this.father && !this.merged) {\n      mergeFather(this, this.father);\n      this.merged = true;\n    }\n  }\n  public format({ onwarning = console.warn } = {}) {\n    this.fitFather([], onwarning);\n    const result = {\n      bpm: this.bpm,\n      speedEvents: [] as SpeedEvent[],\n      numOfNotes: 0,\n      numOfNotesAbove: 0,\n      numOfNotesBelow: 0,\n      notesAbove: [] as Note[],\n      notesBelow: [] as Note[],\n      judgeLineDisappearEvents: [] as JudgeLineEvent[],\n      judgeLineMoveEvents: [] as JudgeLineEvent[],\n      judgeLineRotateEvents: [] as JudgeLineEvent[]\n    };\n    for (const i of this.moveEvents!) {\n      result.judgeLineMoveEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: (i.start + 675) / 1350,\n        end: (i.end + 675) / 1350,\n        start2: (i.start2 + 450) / 900,\n        end2: (i.end2 + 450) / 900\n      });\n    }\n    for (const i of this.rotateEvents!) {\n      result.judgeLineRotateEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: -i.start,\n        end: -i.end,\n        start2: 0,\n        end2: 0\n      });\n    }\n    for (const i of this.alphaEvents!) {\n      result.judgeLineDisappearEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: Math.max(0, i.start / 255),\n        end: Math.max(0, i.end / 255),\n        start2: 0,\n        end2: 0\n      });\n    }\n    // 添加floorPosition\n    let floorPos = 0;\n    const speedEvents = this.speedEvents!;\n    for (let i = 0; i < speedEvents.length; i++) {\n      const startTime = Math.max(speedEvents[i].time, 0);\n      const endTime = i < speedEvents.length - 1 ? speedEvents[i + 1].time : 1e9;\n      const value = speedEvents[i].value * 11 / 45;\n      const floorPosition = floorPos;\n      floorPos += (endTime - startTime) * value / this.bpm * 1.875;\n      floorPos = Math.fround(floorPos);\n      result.speedEvents.push({ startTime, endTime, value, floorPosition });\n    }\n    // 处理notes\n    const sortFn = (a: { time: number }, b: { time: number }) => a.time - b.time;\n    for (const i of this.notes.sort(sortFn)) {\n      const { time } = i;\n      let v1 = 0;\n      let v2 = 0;\n      let v3 = 0;\n      for (const e of result.speedEvents) {\n        if (time > e.endTime) continue;\n        if (time < e.startTime) break;\n        v1 = e.floorPosition;\n        v2 = e.value;\n        v3 = time - e.startTime;\n      }\n      const note = {\n        type: i.type,\n        time: time + (i.isFake ? 1e9 : 0),\n        positionX: i.positionX,\n        holdTime: i.holdTime,\n        speed: i.speed * (i.type === 3 ? v2 : 1),\n        floorPosition: Math.fround(v1 + v2 * v3 / this.bpm * 1.875)\n      };\n      if (i.isAbove) {\n        result.notesAbove.push(note);\n        if (i.isFake) continue;\n        result.numOfNotes++;\n        result.numOfNotesAbove++;\n      } else {\n        result.notesBelow.push(note);\n        if (i.isFake) continue;\n        result.numOfNotes++;\n        result.numOfNotesBelow++;\n      }\n    }\n    return result;\n  }\n}\ninterface RPEMeta {\n  RPEVersion: string;\n  song: string;\n  background: string;\n  name: string;\n  composer: string;\n  charter: string;\n  level: string;\n  offset: number;\n}\ninterface RPEDataBase {\n  BPMList: BpmEventRPEExtends[];\n  judgeLineList: JudgeLineRPEExtends[];\n}\ntype RPEDataLegacy = RPEDataBase & RPEMeta & { META: undefined };\ntype RPEDataCurrent = RPEDataBase & { META: RPEMeta };\ntype RPEData = RPEDataCurrent | RPEDataLegacy;\ninterface JudgeLineRPE {\n  numOfNotes: number;\n  isCover: number;\n  Texture: string;\n  eventLayers: (EventLayer | null)[];\n  extended?: {\n    scaleXEvents: LineEventRPE[];\n    scaleYEvents: LineEventRPE[];\n  } | null;\n  notes: NoteRPE[] | null;\n  Group: number;\n  Name: string;\n  zOrder: number;\n  bpmfactor: number;\n  father: number;\n}\ninterface JudgeLineRPEExtends extends JudgeLineRPE {\n  LineId: number;\n  judgeLineRPE: LineRPE1;\n}\nexport function parse(pec: string, filename: string): {\n  data: string;\n  messages: BetterMessage[];\n  info: Record<string, string>;\n  line: Record<string, string>[];\n  format: string;\n} {\n  const data = JSON.parse(pec) as RPEData;\n  const meta = data.META || data;\n  if (!meta?.RPEVersion) throw new Error('Invalid rpe file');\n  const result = { formatVersion: 3, offset: 0, numOfNotes: 0, judgeLineList: [] as JudgeLine[] };\n  const warnings = [] as BetterMessage[];\n  const warn = (code: number, name: string, message: string) => warnings.push({ host: 'RPE2JSON', code, name, message, target: filename });\n  warn(0, 'RPEVersionNotice', `RPE谱面兼容建设中...\\n检测到RPE版本:${meta.RPEVersion}`);\n  const format = `RPE(${meta.RPEVersion})`;\n  // 谱面信息\n  const info: Record<string, string> = {};\n  info.Chart = filename;\n  info.Music = meta.song;\n  info.Image = meta.background;\n  info.Name = meta.name;\n  info.Artist = meta.composer;\n  info.Charter = meta.charter;\n  info.Level = meta.level;\n  result.offset = meta.offset / 1e3;\n  // 判定线贴图(WIP)\n  const line: Record<string, string>[] = [];\n  data.judgeLineList.forEach((i: JudgeLineRPEExtends, index: number) => {\n    i.LineId = index;\n    const texture = String(i.Texture).replace(/\\0/g, '');\n    if (texture === 'line.png') return;\n    const { extended } = i;\n    const scaleX = extended?.scaleXEvents ? extended.scaleXEvents[extended.scaleXEvents.length - 1].end : 1;\n    const scaleY = extended?.scaleYEvents ? extended.scaleYEvents[extended.scaleYEvents.length - 1].end : 1;\n    line.push({\n      Chart: filename,\n      LineId: index.toString(),\n      Image: texture,\n      Scale: scaleY.toString(),\n      Aspect: (scaleX / scaleY).toString(),\n      UseBackgroundDim: '0',\n      UseLineColor: '1',\n      UseLineScale: '1'\n    });\n  });\n  // bpm变速\n  const bpmList = new BpmList(data.BPMList[0].bpm);\n  for (const i of data.BPMList) { i.time = i.startTime[0] + i.startTime[1] / i.startTime[2] }\n  data.BPMList.sort((a: { time: number }, b: { time: number }) => a.time - b.time).forEach((i, idx, arr) => {\n    if (arr[idx + 1]?.time <= 0) return; // 过滤负数\n    bpmList.push(i.time < 0 ? 0 : i.time, arr[idx + 1]?.time ?? 1e9, i.bpm);\n  });\n  for (const i of data.judgeLineList) {\n    if (i.zOrder === undefined) i.zOrder = 0;\n    if (i.bpmfactor === undefined) i.bpmfactor = 1;\n    if (i.father === undefined) i.father = -1;\n    if (i.isCover !== 1) warn(1, 'ImplementionWarning', `未兼容isCover=${i.isCover}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    if (i.zOrder !== 0) warn(1, 'ImplementionWarning', `未兼容zOrder=${i.zOrder}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    if (i.bpmfactor !== 1) warn(1, 'ImplementionWarning', `未兼容bpmfactor=${i.bpmfactor}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    const lineRPE = new LineRPE1(bpmList.baseBpm);\n    lineRPE.setId(i.LineId);\n    if (i.notes) {\n      for (const note of i.notes) {\n        if (note.alpha === undefined) note.alpha = 255;\n        // if (note.above !== 1 && note.above !== 2) ({code:1,name:'NoteSideWarning',message:`检测到非法方向:${note.above}(将被视为2)\\n位于:\"${JSON.stringify(note)}\"`});\n        if (note.isFake !== 0) warn(1, 'FakeNoteWarning', `检测到FakeNote(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.size !== 1) warn(1, 'ImplementionWarning', `未兼容size=${note.size}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.yOffset !== 0) warn(1, 'ImplementionWarning', `未兼容yOffset=${note.yOffset}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.visibleTime !== 999999) warn(1, 'ImplementionWarning', `未兼容visibleTime=${note.visibleTime}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.alpha !== 255) warn(1, 'ImplementionWarning', `未兼容alpha=${note.alpha}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        const type = [0, 1, 4, 2, 3].indexOf(note.type);\n        const time = bpmList.calc2(note.startTime);\n        const holdTime = bpmList.calc2(note.endTime) - time;\n        const { speed } = note;\n        const positionX = note.positionX / 75.375;\n        lineRPE.pushNote(type, time, positionX, holdTime, speed, note.above === 1, note.isFake !== 0);\n      }\n    }\n    for (const e of i.eventLayers) {\n      if (!e) continue; // 有可能是null\n      const layer = new EventLayer1();\n      for (const j of e.moveXEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const { fn, code } = getEasingFn(j, startTime, endTime);\n        getWarning(code, j);\n        layer.pushMoveXEvent(startTime, endTime, j.start, j.end, fn);\n      }\n      for (const j of e.moveYEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const { fn, code } = getEasingFn(j, startTime, endTime);\n        getWarning(code, j);\n        layer.pushMoveYEvent(startTime, endTime, j.start, j.end, fn);\n      }\n      for (const j of e.rotateEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const { fn, code } = getEasingFn(j, startTime, endTime);\n        getWarning(code, j);\n        layer.pushRotateEvent(startTime, endTime, j.start, j.end, fn);\n      }\n      for (const j of e.alphaEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const { fn, code } = getEasingFn(j, startTime, endTime);\n        getWarning(code, j);\n        layer.pushAlphaEvent(startTime, endTime, j.start, j.end, fn);\n      }\n      for (const j of e.speedEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        layer.pushSpeedEvent(startTime, endTime, j.start, j.end);\n      }\n      lineRPE.eventLayers.push(layer);\n    }\n    i.judgeLineRPE = lineRPE;\n  }\n  for (const i of data.judgeLineList) {\n    const lineRPE = i.judgeLineRPE; // TODO: 待优化\n    const father = data.judgeLineList[i.father];\n    lineRPE.setFather(father?.judgeLineRPE);\n  }\n  for (const i of data.judgeLineList) {\n    const lineRPE = i.judgeLineRPE; // TODO: 待优化\n    const judgeLine = lineRPE.format({ onwarning: (msg: string) => warn(1, 'OtherWarning', `${msg}`) });\n    result.judgeLineList.push(judgeLine);\n    result.numOfNotes += judgeLine.numOfNotes;\n  }\n  return { data: JSON.stringify(result), messages: warnings, info, line, format };\n  function getWarning(code: EasingCode, le: LineEventRPE) {\n    if (code === EasingCode.TypeNotSupported) warn(1, 'EasingTypeWarning', `未知的缓动类型:${le.easingType}(将被视为1)\\n位于:\"${JSON.stringify(le)}\"`);\n    if (code === EasingCode.LeftEqualsRight) warn(1, 'EasingClipWarning', `检测到easingLeft等于easingRight(将被视为线性)\\n位于:\"${JSON.stringify(le)}\"`);\n    if (code === EasingCode.ValueNotFinite) warn(1, 'EasingClipWarning', `非法的缓动函数(将被视为线性)\\n位于:\"${JSON.stringify(le)}\"`);\n  }\n}\n","import { parse } from './pec2json';\nimport { parse as parseRPE } from './rpe2json';\n// 读取info.txt\nfunction readInfo(text: string): Record<string, string>[] {\n  const lines = String(text).split(/\\r?\\n/);\n  const result = [];\n  let current = {} as Record<string, string>;\n  for (const i of lines) {\n    if (i.startsWith('#')) {\n      if (Object.keys(current).length) result.push(current);\n      current = {};\n    } else {\n      let [key, value] = i.split(/:(.+)/).map(s => s.trim());\n      if (key === 'Song') key = 'Music';\n      if (key === 'Picture') key = 'Image';\n      if (key) current[key] = value;\n    }\n  }\n  if (Object.keys(current).length) result.push(current);\n  return result;\n}\nexport default { parse, parseRPE, readInfo };\n","import { isLinear } from './easing.js';\nimport { BpmList } from './BpmList';\nimport { LinePec } from './LinePec';\ninterface BpmCommand {\n  time: number;\n  bpm: number;\n}\ninterface NoteCommand {\n  type: number;\n  lineId: number;\n  time: number;\n  time2: number;\n  offsetX: number;\n  isAbove: number;\n  isFake: number;\n  text: string;\n  speed: number;\n  size: number;\n}\ninterface LineCommand {\n  type: string;\n  lineId: number;\n  time: number;\n  time2: number;\n  speed: number;\n  offsetX: number;\n  offsetY: number;\n  rotation: number;\n  alpha: number;\n  motionType: number;\n  text: string;\n}\ninterface PecParseResult {\n  data: string;\n  messages: string[];\n  format: string;\n}\nexport function parse(pec: string, filename: string): PecParseResult {\n  const data = pec.split(/\\s+/); // 切分pec文本\n  const data2 = {\n    offset: 0,\n    bpmList: [] as BpmCommand[],\n    notes: [] as NoteCommand[],\n    lines: [] as LineCommand[]\n  };\n  const result = {\n    formatVersion: 3,\n    offset: 0,\n    numOfNotes: 0,\n    judgeLineList: [] as JudgeLine[]\n  };\n  const warnings = []; //\n  let ptr = 0;\n  data2.offset = isNaN(Number(data[ptr])) ? 0 : Number(data[ptr++]);\n  while (ptr < data.length) {\n    const command = data[ptr++];\n    if (command === '') { continue }\n    if (command === 'bp') {\n      const time = Number(data[ptr++]);\n      const bpm = Number(data[ptr++]);\n      data2.bpmList.push({ time, bpm });\n    } else if (command.startsWith('n')) {\n      if (!'1234'.includes(command[1])) { throw new Error(`Unsupported Command: ${command}`) }\n      const cmd = {} as NoteCommand;\n      const type = command[1];\n      cmd.type = Number(type);\n      cmd.lineId = Number(data[ptr++]);\n      cmd.time = Number(data[ptr++]);\n      cmd.time2 = '2'.includes(type) ? Number(data[ptr++]) : cmd.time;\n      cmd.offsetX = Number(data[ptr++]);\n      cmd.isAbove = Number(data[ptr++]);\n      cmd.isFake = Number(data[ptr++]);\n      cmd.text = `n${Object.values(cmd).join(' ')}`;\n      cmd.speed = (data[ptr++] || '').startsWith('#') ? Number(data[ptr++]) : (ptr--, 1);\n      cmd.size = (data[ptr++] || '').startsWith('&') ? Number(data[ptr++]) : (ptr--, 1);\n      data2.notes.push(cmd);\n    } else if (command.startsWith('c')) {\n      if (!'vpdamrf'.includes(command[1])) { throw new Error(`Unsupported Command: ${command}`) }\n      const cmd = {} as LineCommand;\n      const type = command[1];\n      cmd.type = type;\n      cmd.lineId = Number(data[ptr++]);\n      cmd.time = Number(data[ptr++]);\n      if ('v'.includes(type)) { cmd.speed = Number(data[ptr++]) }\n      cmd.time2 = 'mrf'.includes(type) ? Number(data[ptr++]) : cmd.time;\n      if ('pm'.includes(type)) { cmd.offsetX = Number(data[ptr++]) }\n      if ('pm'.includes(type)) { cmd.offsetY = Number(data[ptr++]) }\n      if ('dr'.includes(type)) { cmd.rotation = Number(data[ptr++]) }\n      if ('af'.includes(type)) { cmd.alpha = Number(data[ptr++]) }\n      if ('mr'.includes(type)) { cmd.motionType = Number(data[ptr++]) }\n      cmd.text = `c${Object.values(cmd).join(' ')}`;\n      if ('pdaf'.includes(type)) { cmd.motionType = 1 }\n      data2.lines.push(cmd);\n    } else { throw new Error(`Unexpected Command: ${command}`) }\n  }\n  result.offset = data2.offset / 1e3 - 0.175; // v18x固定延迟\n  // bpm变速\n  if (!data2.bpmList.length) { throw new Error('Invalid pec file') }\n  const bpmList = new BpmList(data2.bpmList[0].bpm); // FIXME: 考虑合适的bpm范围\n  data2.bpmList.sort((a, b) => a.time - b.time).forEach((i, idx, arr) => {\n    if (arr[idx + 1]?.time <= 0) { return } // 过滤负数\n    bpmList.push(i.time < 0 ? 0 : i.time, arr[idx + 1]?.time ?? 1e9, i.bpm);\n  });\n  // note和判定线事件\n  const linesPec = [] as LinePec[];\n  for (const i of data2.notes) {\n    const type = [0, 1, 4, 2, 3].indexOf(i.type);\n    const time = bpmList.calc(i.time);\n    const holdTime = bpmList.calc(i.time2) - time;\n    const speed = isNaN(i.speed) ? 1 : i.speed;\n    linesPec[i.lineId] ??= new LinePec(bpmList.baseBpm);\n    linesPec[i.lineId].pushNote(type, time, i.offsetX / 115.2, holdTime, speed, i.isAbove === 1, i.isFake !== 0); // 102.4\n    // if (i.isAbove !== 1 && i.isAbove !== 2) warnings.push(`检测到非法方向:${i.isAbove}(将被视为2)\\n位于:\"${i.text}\"\\n来自${filename}`);\n    if (i.isFake !== 0) warnings.push(`检测到FakeNote(可能无法正常显示)\\n位于:\"${i.text}\"\\n来自${filename}`);\n    if (i.size !== 1) warnings.push(`检测到异常Note(可能无法正常显示)\\n位于:\"${i.text}\"\\n来自${filename}`);\n  }\n  const isMotion = (i: number) => !isLinear(i) || i === 1;\n  for (const i of data2.lines) {\n    const t1 = bpmList.calc(i.time);\n    const t2 = bpmList.calc(i.time2);\n    if (t1 > t2) {\n      warnings.push(`检测到开始时间大于结束时间(将禁用此事件)\\n位于:\"${i.text}\"\\n来自${filename}`);\n      continue;\n    }\n    linesPec[i.lineId] ??= new LinePec(bpmList.baseBpm);\n    // 变速\n    if (i.type === 'v') {\n      linesPec[i.lineId].pushSpeedEvent(t1, i.speed / 7.0); // 6.0??\n    }\n    // 不透明度\n    if (i.type === 'a' || i.type === 'f') {\n      linesPec[i.lineId].pushAlphaEvent(t1, t2, Math.max(i.alpha / 255, 0), i.motionType); // 暂不支持alpha值扩展\n      if (i.alpha < 0) { warnings.push(`检测到负数Alpha:${i.alpha}(将被视为0)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n    // 移动\n    if (i.type === 'p' || i.type === 'm') {\n      linesPec[i.lineId].pushMoveEvent(t1, t2, i.offsetX / 2048, i.offsetY / 1400, isMotion(i.motionType) ? i.motionType : 1);\n      if (!isMotion(i.motionType)) { warnings.push(`未知的缓动类型:${i.motionType}(将被视为1)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n    // 旋转\n    if (i.type === 'd' || i.type === 'r') {\n      linesPec[i.lineId].pushRotateEvent(t1, t2, -i.rotation, isMotion(i.motionType) ? i.motionType : 1);\n      if (!isMotion(i.motionType)) { warnings.push(`未知的缓动类型:${i.motionType}(将被视为1)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n  }\n  for (const i of linesPec) {\n    const judgeLine = i.format();\n    result.judgeLineList.push(judgeLine);\n    result.numOfNotes += judgeLine.numOfNotes;\n  }\n  return { data: JSON.stringify(result), messages: warnings, format: 'PEC' };\n}\n","import Pec from '../extends/pec/index';\nimport { reader } from './reader';\nimport { structChart } from './structChart';\nimport { structInfoData, structLineData } from './structInfo';\nimport md5 from 'md5';\nreader.use({\n  pattern: /\\.(json|pec)$/i,\n  type: 'json',\n  read(i: ByteData, path: string) {\n    const rpeData = Pec.parseRPE(i.text!, i.name/* , path */); // TODO: path\n    const data = structChart(rpeData.data);\n    const info = structInfoData([rpeData.info], path);\n    const line = structLineData(rpeData.line, path);\n    const { messages: msg, format } = rpeData;\n    return { type: 'chart', name: i.name, md5: md5(i.text!), data, msg, info, line, format };\n  }\n});\nreader.use({\n  pattern: /\\.pec$/i,\n  type: 'text',\n  read(i: ByteData) {\n    const pecData = Pec.parse(i.text!, i.name);\n    const data = structChart(pecData.data);\n    const { messages: msg, format } = pecData;\n    return { type: 'chart', name: i.name, md5: md5(i.text!), data, msg, format };\n  }\n});\nreader.use({\n  pattern: /^(Settings|info)\\.txt$/i,\n  type: 'text',\n  mustMatch: true,\n  read(i: ByteData, path: string) {\n    const data = i.text!;\n    const chartInfo = structInfoData(Pec.readInfo(data), path);\n    return { type: 'info' as const, data: chartInfo };\n  }\n});\nif (Object.hasOwn(self, 'webp')) {\n  reader.use({\n    pattern: /\\.webp$/i,\n    type: 'binary',\n    async read(i: ByteData) {\n      const webp2canvas = Object.getOwnPropertyDescriptor(self, 'webp')?.value.default as (buffer: ArrayBuffer) => Promise<HTMLCanvasElement>;\n      const img = await webp2canvas(i.buffer);\n      const bitmap = await createImageBitmap(img);\n      return { type: 'image', name: i.name, data: bitmap };\n    }\n  });\n}\n// fileReader.use({\n//   pattern: /^\\.ogg$/i,\n//   type: 'binary',\n//   async read(i: ByteData) {\n//     const { OggVorbisDecoder } = await import('@wasm-audio-decoders/ogg-vorbis');\n//     const decoder = new OggVorbisDecoder();\n//     await decoder.ready;\n//     const { channelData, samplesDecoded, sampleRate } = await decoder.decodeFile(new Uint8Array(i.buffer));\n//     decoder.free();\n//     const actx = new (window.AudioContext || window.webkitAudioContext)();\n//     const ab = actx.createBuffer(channelData.length, samplesDecoded, sampleRate);\n//     channelData.forEach((channel, idx) => ab.getChannelData(idx).set(channel));\n//     return { type: 'audio', name: i.name, data: { audio: ab, video: null } };\n//   }\n// });\n"],"names":["tl","t","Math","sin","PI","cos","sqrt","easing","index","trunc","BpmList","constructor","baseBpm","__publicField","this","Number","accTime","list","push","start","end","bpm","value","calc","beat","time","i","round","calc2","LinePec","speedEvents","notes","alphaEvents","moveEvents","rotateEvents","isNaN","pushNote","type","positionX","holdTime","speed","isAbove","isFake","pushSpeedEvent","pushAlphaEvent","startTime","endTime","motionType","pushMoveEvent","value2","pushRotateEvent","format","sortFn","a","b","sortFn2","result","formatVersion","offset","numOfNotes","numOfNotesAbove","numOfNotesBelow","notesAbove","notesBelow","judgeLineDisappearEvents","judgeLineMoveEvents","judgeLineRotateEvents","pushDisappearEvent","start2","end2","c","r","cvp","sort","s1","length","max","floorPosition","fround","v1","v2","v3","e","note","dt","d1","easingFn","t1","x1","x2","mt","m1","m2","t2","rt","r1","cubicBezier","p1x","p1y","p2x","p2y","ax","bx","cx","ay","by","cy","sampleCurveDerivativeX","sampleCurveX","solve","x","sampleCurveY","derivative","abs","t0","solveCurveX","getEasingFn","le","bezier","floor","code","bezierPoints","eSpeed","e1Delta","fn","bezierFn","easingType","easingLeft","easingRight","eHead","eTail","isFinite","clipFn","pushLineEvent","ls","delta","j","getEventsValue","d","_ref2","_a","getMoveValue","_ref3","_ref4","result2","_b","getRotateValue","_ref5","combineMultiEvents","es","splits","reduce","n","EventLayer1","moveXEvents","moveYEvents","pushMoveXEvent","pushMoveYEvent","LineRPE1","eventLayers","father","settled","merged","setId","id","NaN","setFather","fatherLine","preset","events","map","xe","ye","startX","endX","startY","endY","combineXYEvents","toSpeedEvent","fitFather","stack","onwarning","console","warn","includes","concat","join","child","fatherX","fatherY","fatherR","fatherX2","fatherY2","fatherR2","childX","childY","childX2","childY2","mergeFather","floorPos","Pec","pec","filename","data","split","data2","bpmList","lines","judgeLineList","warnings","ptr","command","startsWith","Error","cmd","lineId","time2","offsetX","text","Object","values","size","offsetY","rotation","alpha","forEach","idx","arr","_ref","linesPec","_u$d","indexOf","isMotion","isLinear","_u$g","judgeLine","JSON","stringify","messages","parseRPE","parse","meta","META","RPEVersion","name","message","host","target","info","Chart","Music","song","Image","background","Name","Artist","composer","Charter","charter","Level","level","line","LineId","texture","String","Texture","replace","extended","scaleX","scaleXEvents","scaleY","scaleYEvents","toString","Scale","Aspect","UseBackgroundDim","UseLineColor","UseLineScale","BPMList","_ref6","zOrder","bpmfactor","isCover","lineRPE","yOffset","visibleTime","above","layer","_f$moveXEvents","getWarning","_f$moveYEvents","_f$rotateEvents","_f$alphaEvents","_f$speedEvents","judgeLineRPE","msg","readInfo","current","keys","key","s","trim","reader","use","pattern","read","path","rpeData","structChart","structInfoData","structLineData","md5","pecData","mustMatch","hasOwn","self","img","getOwnPropertyDescriptor","default","buffer","bitmap","createImageBitmap"],"mappings":"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"}