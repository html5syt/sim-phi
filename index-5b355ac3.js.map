{"version":3,"file":"index-5b355ac3.js","sources":["../src/js/common.js","../src/components/Timer.ts","../src/utils/csv2array.ts","../src/utils/stringify.ts","../node_modules/crypt/crypt.js","../node_modules/charenc/charenc.js","../node_modules/is-buffer/index.js","../node_modules/md5/md5.js","../src/utils/reader.ts","../src/core.ts","../src/components/HitManager.ts","../src/components/Stat.ts","../src/utils/createCtx.ts","../src/utils/imgAny.ts","../src/components/Checkbox.ts","../src/components/HitEvents.ts","../src/components/HitFeedback.ts","../src/components/HitImage.ts","../src/components/HitWord.ts","../src/components/ScaledNote.ts","../node_modules/stackblur-canvas/dist/stackblur-es.js","../src/utils/hex2rgba.ts","../src/utils/imgShader.ts","../src/utils/imgSplit.ts","../src/utils/checkSupport.ts","../src/utils/adjustSize.ts","../src/index.ts","../src/components/Stage.ts","../src/components/StatusManager.ts","../src/utils/imgBlur.ts","../src/components/FrameTimer.ts","../src/components/FrameAnimater.ts","../src/utils/imgPainter.ts","../src/utils/fixme.ts"],"sourcesContent":["// 全屏相关\nexport const full = {\n  /**\n   * @param {HTMLElement} [elem]\n   * @returns {Promise<void>}\n   */\n  toggle(elem) {\n    // 踩坑：Apple第三方浏览器可能根本没有包含full的属性或方法\n    if (!this.enabled) return Promise.reject(new Error('Fullscreen is not supported'));\n    const onFullscreen = () => new Promise((resolve, reject) => {\n      document.addEventListener(this.onchange, resolve, { once: true });\n      document.addEventListener(this.onerror, reject, { once: true });\n    });\n    if (this.element) {\n      const handler = document.exitFullscreen || document.webkitExitFullscreen || document.mozCancelFullScreen;\n      if (handler) { handler.call(document); return onFullscreen() }\n    } else {\n      const element = elem instanceof HTMLElement ? elem : document.body;\n      const handler = element.requestFullscreen || element.webkitRequestFullscreen || element.mozRequestFullScreen;\n      if (handler) { handler.call(element); return onFullscreen() }\n    }\n    return Promise.reject(new Error('Fullscreen is not supported'));\n  },\n  check(elem) {\n    const element = elem instanceof HTMLElement ? elem : document.body;\n    return this.element === element;\n  },\n  get onchange() {\n    if (document.onfullscreenchange !== undefined) return 'fullscreenchange';\n    if (document.onwebkitfullscreenchange !== undefined) return 'webkitfullscreenchange';\n    if (document.onmozfullscreenchange !== undefined) return 'mozfullscreenchange';\n    return null;\n  },\n  get onerror() {\n    if (document.onfullscreenerror !== undefined) return 'fullscreenerror';\n    if (document.onwebkitfullscreenerror !== undefined) return 'webkitfullscreenerror';\n    if (document.onmozfullscreenerror !== undefined) return 'mozfullscreenerror';\n    return null;\n  },\n  get element() {\n    return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || null;\n  },\n  get enabled() {\n    return document.fullscreenEnabled || document.webkitFullscreenEnabled || document.mozFullScreenEnabled || false;\n  }\n};\nexport const orientation = {\n  async checkSupport() {\n    const s = screen.orientation;\n    if (!s) return false;\n    try {\n      await s.lock(s.type);\n      s.unlock();\n      hook.toast('如果你看到了这个提示，请联系开发者：Unexpected Allow Orientation Lock Without Permission');\n      return true;\n    } catch (e) {\n      if (e.name === 'SecurityError') {\n        if (e.message === 'The operation is insecure.') return false; // Firefox\n        return true;\n      } else if (e.name === 'NotSupportedError') return false;\n      else if (e.name === 'TypeError') return false; // Safari 16.4\n      throw e;\n    }\n  },\n  lockLandscape() {\n    const s = screen.orientation;\n    if (!s) return Promise.reject(new Error('Orientation is not supported'));\n    return s.lock('landscape-primary');\n  },\n  lockPortrait() {\n    const s = screen.orientation;\n    if (!s) return Promise.reject(new Error('Orientation is not supported'));\n    return s.lock('portrait-primary');\n  },\n  unlock() {\n    const s = screen.orientation;\n    if (!s) return Promise.reject(new Error('Orientation is not supported'));\n    return s.unlock();\n  }\n};\n// function loadJS(url, callback) {\n//   const script = document.createElement('script');\n//   const fn = callback || function() {};\n//   script.type = 'text/javascript';\n//   script.onload = function() {\n//     fn();\n//   };\n//   script.src = url;\n//   document.getElementsByTagName('head')[0].appendChild(script);\n// }\n// function loadJS2(url) {\n//   return new Promise((resolve, reject) => {\n//     const script = document.createElement('script');\n//     script.type = 'text/javascript';\n//     script.onload = resolve;\n//     script.onerror = reject;\n//     script.src = url;\n//     document.getElementsByTagName('head')[0].appendChild(script);\n//   });\n// }\n// self.onerror=(...a)=>console.log('awa',a);\n// self.addEventListener('error',(...a)=>console.log('awa',a));\nexport const urls0 = {\n  jszip: ['//unpkg.com/jszip/dist/jszip.min.js', '//cdn.jsdelivr.net/npm/jszip', '//fastly.jsdelivr.net/npm/jszip'],\n  blur: ['//unpkg.com/stackblur-canvas/dist/stackblur.min.js', '//cdn.jsdelivr.net/npm/stackblur-canvas', '//fastly.jsdelivr.net/npm/stackblur-canvas'],\n  md5: ['//unpkg.com/md5-js/md5.min.js', '//cdn.jsdelivr.net/npm/md5-js', '//fastly.jsdelivr.net/npm/md5-js']\n};\nexport const getConstructorName = obj => {\n  if (obj === null) return 'Null';\n  if (obj === undefined) return 'Undefined';\n  return obj.constructor.name;\n};\nexport const isUndefined = name => self[name] === undefined;\n// Legacy\n{\n  // EventTarget.constructor polyfill for Safari 14-\n  try {\n    Reflect.construct(EventTarget, []);\n  } catch (e) {\n    self.EventTarget = function() {\n      this.listeners = {};\n    };\n    EventTarget.prototype = {\n      constructor: EventTarget,\n      addEventListener(type, callback) {\n        if (!(type in this.listeners)) this.listeners[type] = [];\n        this.listeners[type].push(callback);\n      },\n      removeEventListener(type, callback) {\n        if (!(type in this.listeners)) return;\n        const stack = this.listeners[type];\n        for (let i = 0, l = stack.length; i < l; i++) {\n          if (stack[i] === callback) {\n            stack.splice(i, 1);\n            return;\n          }\n        }\n      },\n      dispatchEvent(event) {\n        if (!(event.type in this.listeners)) return true;\n        const stack = this.listeners[event.type];\n        // event.target = this;\n        for (let i = 0, l = stack.length; i < l; i++) {\n          stack[i].call(this, event);\n        }\n        return !event.defaultPrevented;\n      }\n    };\n  }\n  // Error.cause polyfill for Safari 15-\n  const error = new Error();\n  if (new Error('', { cause: error }).cause !== error) {\n    class Error extends self.Error {\n      constructor(message, { cause } = {}) {\n        super(message);\n        this.cause = cause;\n      }\n    }\n    Object.defineProperty(Error, 'name', { value: 'Error' });\n    self.Error = Error;\n  }\n  // DOMException.stack polyfill for All Browsers\n  class DOMException extends self.DOMException {\n    constructor(message, name) {\n      super(message, name);\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, DOMException); // 过滤自身stack\n      } else {\n        this.stack = new Error().stack.replace(/.+\\n/, '');\n      }\n    }\n  }\n  Object.defineProperty(DOMException, 'name', { value: 'DOMException' });\n  self.DOMException = DOMException;\n  // AudioContext constructor polyfill for Safari 14.5-\n  if (isUndefined('AudioContext')) {\n    self.AudioContext = self.webkitAudioContext;\n  }\n  // Object.hasOwn polyfill for Safari 15.4-\n  if (Object.hasOwn === undefined) {\n    Object.defineProperty(Object, 'hasOwn', {\n      value(obj, prop) {\n        // eslint-disable-next-line prefer-object-has-own\n        return Object.prototype.hasOwnProperty.call(obj, prop);\n      }\n    });\n  }\n}\nexport function loadJS(...args) {\n  const arr = Array.from(args[0] instanceof Array ? args[0] : args, i => new URL(i, location).href);\n  const args0 = (function *(arg) { yield* arg }(arr));\n  const load = url => new Promise((resolve, reject) => {\n    if (!url) { reject(new DOMException(`All urls are invalid\\n${arr.join('\\n')}`, 'NetworkError')); return }\n    const script = document.createElement('script');\n    script.onload = () => resolve(script);\n    script.onerror = () => load(args0.next().value).then(s => resolve(s)).catch(e => reject(e));\n    script.src = url;\n    if (!location.port) script.crossOrigin = 'anonymous';\n    document.head.appendChild(script);\n  });\n  return load(args0.next().value);\n}\n","export class Timer {\n  private t0: number;\n  private t1: number;\n  private isPaused: boolean;\n  public constructor() {\n    this.t0 = 0;\n    this.t1 = 0;\n    this.isPaused = true;\n  }\n  public get time(): number {\n    if (this.isPaused) return this.t0;\n    return this.t0 + performance.now() - this.t1;\n  }\n  public get second(): number {\n    return this.time / 1e3;\n  }\n  public play(): void {\n    if (!this.isPaused) throw new Error('Time has been playing');\n    this.t1 = performance.now();\n    this.isPaused = false;\n  }\n  public pause(): void {\n    if (this.isPaused) throw new Error('Time has been paused');\n    this.t0 = this.time;\n    this.isPaused = true;\n  }\n  public reset(): void {\n    this.t0 = 0;\n    this.t1 = 0;\n    this.isPaused = true;\n  }\n  public addTime(num = 0): void {\n    this.t0 += num;\n  }\n}\n","export function csv2array(data: string, isObject: boolean): Record<string, string>[] | string[][] {\n  const strarr = data.replace(/\\ufeff|\\r/g, '').split('\\n');\n  const col = [];\n  for (const i of strarr) {\n    let rowstr = '';\n    let isQuot = false;\n    let beforeQuot = false;\n    const row = [];\n    for (const j of i) {\n      if (j === '\"') {\n        if (!isQuot) isQuot = true;\n        else if (beforeQuot) {\n          rowstr += j; beforeQuot = false;\n        } else beforeQuot = true;\n      } else if (j === ',') {\n        if (!isQuot) {\n          row.push(rowstr);\n          rowstr = '';\n        } else if (beforeQuot) {\n          row.push(rowstr);\n          rowstr = '';\n          isQuot = false;\n          beforeQuot = false;\n        } else rowstr += j;\n      } else if (beforeQuot) throw new SyntaxError('Unexpected token , (-1)');\n      else rowstr += j;\n    }\n    if (!isQuot) {\n      row.push(rowstr);\n      rowstr = '';\n    } else if (beforeQuot) {\n      row.push(rowstr);\n      rowstr = '';\n      isQuot = false;\n      beforeQuot = false;\n    } else throw new SyntaxError('Unexpected token , (-2)');\n    col.push(row);\n  }\n  if (!isObject) return col;\n  const arr = [];\n  for (let i = 1; i < col.length; i++) {\n    const obj = {} as Record<string, string>;\n    for (let j = 0; j < col[0].length; j++) obj[col[0][j]] = col[i][j];\n    arr.push(obj);\n  }\n  return arr;\n}\n","export function stringify(bfs: BufferSource): string {\n  const labels = ['utf-8', 'gbk', 'big5', 'shift_jis'];\n  for (const label of labels) {\n    const decoder = new TextDecoder(label, { fatal: true }); // '\\ufffd'\n    try {\n      return decoder.decode(bfs);\n    } catch (e) {\n      if (label === labels[labels.length - 1]) throw e;\n    }\n  }\n  throw new Error('Unknown encoding');\n}\n","(function() {\n  var base64map\n      = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n\n  crypt = {\n    // Bit-wise rotation left\n    rotl: function(n, b) {\n      return (n << b) | (n >>> (32 - b));\n    },\n\n    // Bit-wise rotation right\n    rotr: function(n, b) {\n      return (n << (32 - b)) | (n >>> b);\n    },\n\n    // Swap big-endian to little-endian and vice versa\n    endian: function(n) {\n      // If number given, swap endian\n      if (n.constructor == Number) {\n        return crypt.rotl(n, 8) & 0x00FF00FF | crypt.rotl(n, 24) & 0xFF00FF00;\n      }\n\n      // Else, assume array and swap all items\n      for (var i = 0; i < n.length; i++)\n        n[i] = crypt.endian(n[i]);\n      return n;\n    },\n\n    // Generate an array of any length of random bytes\n    randomBytes: function(n) {\n      for (var bytes = []; n > 0; n--)\n        bytes.push(Math.floor(Math.random() * 256));\n      return bytes;\n    },\n\n    // Convert a byte array to big-endian 32-bit words\n    bytesToWords: function(bytes) {\n      for (var words = [], i = 0, b = 0; i < bytes.length; i++, b += 8)\n        words[b >>> 5] |= bytes[i] << (24 - b % 32);\n      return words;\n    },\n\n    // Convert big-endian 32-bit words to a byte array\n    wordsToBytes: function(words) {\n      for (var bytes = [], b = 0; b < words.length * 32; b += 8)\n        bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a hex string\n    bytesToHex: function(bytes) {\n      for (var hex = [], i = 0; i < bytes.length; i++) {\n        hex.push((bytes[i] >>> 4).toString(16));\n        hex.push((bytes[i] & 0xF).toString(16));\n      }\n      return hex.join('');\n    },\n\n    // Convert a hex string to a byte array\n    hexToBytes: function(hex) {\n      for (var bytes = [], c = 0; c < hex.length; c += 2)\n        bytes.push(parseInt(hex.substr(c, 2), 16));\n      return bytes;\n    },\n\n    // Convert a byte array to a base-64 string\n    bytesToBase64: function(bytes) {\n      for (var base64 = [], i = 0; i < bytes.length; i += 3) {\n        var triplet = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];\n        for (var j = 0; j < 4; j++)\n          if (i * 8 + j * 6 <= bytes.length * 8)\n            base64.push(base64map.charAt((triplet >>> 6 * (3 - j)) & 0x3F));\n          else\n            base64.push('=');\n      }\n      return base64.join('');\n    },\n\n    // Convert a base-64 string to a byte array\n    base64ToBytes: function(base64) {\n      // Remove non-base-64 characters\n      base64 = base64.replace(/[^A-Z0-9+\\/]/ig, '');\n\n      for (var bytes = [], i = 0, imod4 = 0; i < base64.length;\n          imod4 = ++i % 4) {\n        if (imod4 == 0) continue;\n        bytes.push(((base64map.indexOf(base64.charAt(i - 1))\n            & (Math.pow(2, -2 * imod4 + 8) - 1)) << (imod4 * 2))\n            | (base64map.indexOf(base64.charAt(i)) >>> (6 - imod4 * 2)));\n      }\n      return bytes;\n    }\n  };\n\n  module.exports = crypt;\n})();\n","var charenc = {\n  // UTF-8 encoding\n  utf8: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      return charenc.bin.stringToBytes(unescape(encodeURIComponent(str)));\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      return decodeURIComponent(escape(charenc.bin.bytesToString(bytes)));\n    }\n  },\n\n  // Binary encoding\n  bin: {\n    // Convert a string to a byte array\n    stringToBytes: function(str) {\n      for (var bytes = [], i = 0; i < str.length; i++)\n        bytes.push(str.charCodeAt(i) & 0xFF);\n      return bytes;\n    },\n\n    // Convert a byte array to a string\n    bytesToString: function(bytes) {\n      for (var str = [], i = 0; i < bytes.length; i++)\n        str.push(String.fromCharCode(bytes[i]));\n      return str.join('');\n    }\n  }\n};\n\nmodule.exports = charenc;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","(function(){\r\n  var crypt = require('crypt'),\r\n      utf8 = require('charenc').utf8,\r\n      isBuffer = require('is-buffer'),\r\n      bin = require('charenc').bin,\r\n\r\n  // The core\r\n  md5 = function (message, options) {\r\n    // Convert to byte array\r\n    if (message.constructor == String)\r\n      if (options && options.encoding === 'binary')\r\n        message = bin.stringToBytes(message);\r\n      else\r\n        message = utf8.stringToBytes(message);\r\n    else if (isBuffer(message))\r\n      message = Array.prototype.slice.call(message, 0);\r\n    else if (!Array.isArray(message) && message.constructor !== Uint8Array)\r\n      message = message.toString();\r\n    // else, assume byte array already\r\n\r\n    var m = crypt.bytesToWords(message),\r\n        l = message.length * 8,\r\n        a =  1732584193,\r\n        b = -271733879,\r\n        c = -1732584194,\r\n        d =  271733878;\r\n\r\n    // Swap endian\r\n    for (var i = 0; i < m.length; i++) {\r\n      m[i] = ((m[i] <<  8) | (m[i] >>> 24)) & 0x00FF00FF |\r\n             ((m[i] << 24) | (m[i] >>>  8)) & 0xFF00FF00;\r\n    }\r\n\r\n    // Padding\r\n    m[l >>> 5] |= 0x80 << (l % 32);\r\n    m[(((l + 64) >>> 9) << 4) + 14] = l;\r\n\r\n    // Method shortcuts\r\n    var FF = md5._ff,\r\n        GG = md5._gg,\r\n        HH = md5._hh,\r\n        II = md5._ii;\r\n\r\n    for (var i = 0; i < m.length; i += 16) {\r\n\r\n      var aa = a,\r\n          bb = b,\r\n          cc = c,\r\n          dd = d;\r\n\r\n      a = FF(a, b, c, d, m[i+ 0],  7, -680876936);\r\n      d = FF(d, a, b, c, m[i+ 1], 12, -389564586);\r\n      c = FF(c, d, a, b, m[i+ 2], 17,  606105819);\r\n      b = FF(b, c, d, a, m[i+ 3], 22, -1044525330);\r\n      a = FF(a, b, c, d, m[i+ 4],  7, -176418897);\r\n      d = FF(d, a, b, c, m[i+ 5], 12,  1200080426);\r\n      c = FF(c, d, a, b, m[i+ 6], 17, -1473231341);\r\n      b = FF(b, c, d, a, m[i+ 7], 22, -45705983);\r\n      a = FF(a, b, c, d, m[i+ 8],  7,  1770035416);\r\n      d = FF(d, a, b, c, m[i+ 9], 12, -1958414417);\r\n      c = FF(c, d, a, b, m[i+10], 17, -42063);\r\n      b = FF(b, c, d, a, m[i+11], 22, -1990404162);\r\n      a = FF(a, b, c, d, m[i+12],  7,  1804603682);\r\n      d = FF(d, a, b, c, m[i+13], 12, -40341101);\r\n      c = FF(c, d, a, b, m[i+14], 17, -1502002290);\r\n      b = FF(b, c, d, a, m[i+15], 22,  1236535329);\r\n\r\n      a = GG(a, b, c, d, m[i+ 1],  5, -165796510);\r\n      d = GG(d, a, b, c, m[i+ 6],  9, -1069501632);\r\n      c = GG(c, d, a, b, m[i+11], 14,  643717713);\r\n      b = GG(b, c, d, a, m[i+ 0], 20, -373897302);\r\n      a = GG(a, b, c, d, m[i+ 5],  5, -701558691);\r\n      d = GG(d, a, b, c, m[i+10],  9,  38016083);\r\n      c = GG(c, d, a, b, m[i+15], 14, -660478335);\r\n      b = GG(b, c, d, a, m[i+ 4], 20, -405537848);\r\n      a = GG(a, b, c, d, m[i+ 9],  5,  568446438);\r\n      d = GG(d, a, b, c, m[i+14],  9, -1019803690);\r\n      c = GG(c, d, a, b, m[i+ 3], 14, -187363961);\r\n      b = GG(b, c, d, a, m[i+ 8], 20,  1163531501);\r\n      a = GG(a, b, c, d, m[i+13],  5, -1444681467);\r\n      d = GG(d, a, b, c, m[i+ 2],  9, -51403784);\r\n      c = GG(c, d, a, b, m[i+ 7], 14,  1735328473);\r\n      b = GG(b, c, d, a, m[i+12], 20, -1926607734);\r\n\r\n      a = HH(a, b, c, d, m[i+ 5],  4, -378558);\r\n      d = HH(d, a, b, c, m[i+ 8], 11, -2022574463);\r\n      c = HH(c, d, a, b, m[i+11], 16,  1839030562);\r\n      b = HH(b, c, d, a, m[i+14], 23, -35309556);\r\n      a = HH(a, b, c, d, m[i+ 1],  4, -1530992060);\r\n      d = HH(d, a, b, c, m[i+ 4], 11,  1272893353);\r\n      c = HH(c, d, a, b, m[i+ 7], 16, -155497632);\r\n      b = HH(b, c, d, a, m[i+10], 23, -1094730640);\r\n      a = HH(a, b, c, d, m[i+13],  4,  681279174);\r\n      d = HH(d, a, b, c, m[i+ 0], 11, -358537222);\r\n      c = HH(c, d, a, b, m[i+ 3], 16, -722521979);\r\n      b = HH(b, c, d, a, m[i+ 6], 23,  76029189);\r\n      a = HH(a, b, c, d, m[i+ 9],  4, -640364487);\r\n      d = HH(d, a, b, c, m[i+12], 11, -421815835);\r\n      c = HH(c, d, a, b, m[i+15], 16,  530742520);\r\n      b = HH(b, c, d, a, m[i+ 2], 23, -995338651);\r\n\r\n      a = II(a, b, c, d, m[i+ 0],  6, -198630844);\r\n      d = II(d, a, b, c, m[i+ 7], 10,  1126891415);\r\n      c = II(c, d, a, b, m[i+14], 15, -1416354905);\r\n      b = II(b, c, d, a, m[i+ 5], 21, -57434055);\r\n      a = II(a, b, c, d, m[i+12],  6,  1700485571);\r\n      d = II(d, a, b, c, m[i+ 3], 10, -1894986606);\r\n      c = II(c, d, a, b, m[i+10], 15, -1051523);\r\n      b = II(b, c, d, a, m[i+ 1], 21, -2054922799);\r\n      a = II(a, b, c, d, m[i+ 8],  6,  1873313359);\r\n      d = II(d, a, b, c, m[i+15], 10, -30611744);\r\n      c = II(c, d, a, b, m[i+ 6], 15, -1560198380);\r\n      b = II(b, c, d, a, m[i+13], 21,  1309151649);\r\n      a = II(a, b, c, d, m[i+ 4],  6, -145523070);\r\n      d = II(d, a, b, c, m[i+11], 10, -1120210379);\r\n      c = II(c, d, a, b, m[i+ 2], 15,  718787259);\r\n      b = II(b, c, d, a, m[i+ 9], 21, -343485551);\r\n\r\n      a = (a + aa) >>> 0;\r\n      b = (b + bb) >>> 0;\r\n      c = (c + cc) >>> 0;\r\n      d = (d + dd) >>> 0;\r\n    }\r\n\r\n    return crypt.endian([a, b, c, d]);\r\n  };\r\n\r\n  // Auxiliary functions\r\n  md5._ff  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & c | ~b & d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._gg  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b & d | c & ~d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._hh  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (b ^ c ^ d) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n  md5._ii  = function (a, b, c, d, x, s, t) {\r\n    var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;\r\n    return ((n << s) | (n >>> (32 - s))) + b;\r\n  };\r\n\r\n  // Package private blocksize\r\n  md5._blocksize = 16;\r\n  md5._digestsize = 16;\r\n\r\n  module.exports = function (message, options) {\r\n    if (message === undefined || message === null)\r\n      throw new Error('Illegal argument ' + message);\r\n\r\n    var digestbytes = crypt.wordsToBytes(md5(message, options));\r\n    return options && options.asBytes ? digestbytes :\r\n        options && options.asString ? bin.bytesToString(digestbytes) :\r\n        crypt.bytesToHex(digestbytes);\r\n  };\r\n\r\n})();\r\n","import { csv2array } from './csv2array';\nimport { stringify } from './stringify';\nimport md5 from 'md5';\n// @ts-expect-error: vite-plugin-worker-loader\nimport Zip from '../zip.worker?worker';\nexport class FileEmitter extends EventTarget {\n  private readonly input: HTMLInputElement;\n  public constructor() {\n    super();\n    this.input = Object.assign(document.createElement('input'), {\n      type: 'file',\n      accept: '',\n      multiple: true,\n      onchange: () => {\n        this.fireChange(this.input.files);\n        for (const i of this.input.files || []) {\n          // 加载文件\n          const reader = new FileReader();\n          reader.readAsArrayBuffer(i);\n          reader.onprogress = evt => this.fireProgress(evt.loaded, evt.total);\n          reader.onload = evt => evt.target && evt.target.result instanceof ArrayBuffer && this.fireLoad(i, evt.target.result);\n        }\n      }\n    });\n  }\n  public uploadFile(): void {\n    this.input.webkitdirectory = false;\n    this.input.click();\n  }\n  public uploadDir(): void {\n    this.input.webkitdirectory = true;\n    this.input.click();\n  }\n  public fireChange(files: FileList | null): boolean {\n    return this.dispatchEvent(Object.assign(new Event('change'), { files }));\n  }\n  public fireProgress(loaded: number, total: number): boolean {\n    return this.dispatchEvent(new ProgressEvent('progress', { lengthComputable: true, loaded, total }));\n  }\n  public fireLoad(file: Pick<File, 'name'>, buffer: ArrayBuffer): boolean {\n    return this.dispatchEvent(Object.assign(new ProgressEvent('load'), { file, buffer }));\n  }\n}\nexport class ZipReader extends EventTarget {\n  public total: number;\n  private worker: Worker | null;\n  private readonly handler: (data: ByteData) => Promise<unknown>;\n  public constructor({ handler = async data => Promise.resolve(data) }: ReaderOptions) {\n    super();\n    this.worker = null;\n    this.total = 0;\n    this.handler = handler;\n  }\n  public read(result0: ByteData): void {\n    if (!this.worker) {\n      this.dispatchEvent(new CustomEvent('loadstart'));\n      const worker = new Zip() as Worker; // 以后考虑indexedDB存储url\n      worker.addEventListener('message', msg => {\n        const handler = async() => {\n          const { data } = msg as { data: { data: ByteData; total: number } };\n          this.total = data.total;\n          const result = await this.handler(data.data);\n          this.dispatchEvent(new CustomEvent('read', { detail: result }));\n        };\n        handler().catch((err: Error) => this.dispatchEvent(new CustomEvent('error', { detail: err })));\n      });\n      this.worker = worker;\n    }\n    this.worker.postMessage(result0, [result0.buffer]);\n  }\n  public terminate(): void {\n    if (this.worker) {\n      this.worker.terminate();\n      this.worker = null;\n    }\n  }\n}\ninterface ReaderInit {\n  pattern: RegExp;\n  /** binary(not text)/text(not json)/json */\n  type?: 'binary' | 'json' | 'text';\n  mustMatch?: boolean;\n  weight?: number;\n  read: (data: ByteData, path: string, options?: Record<string, unknown>) => Promise<ReaderData | null> | ReaderData | null;\n}\nexport function defineReader(readerInit: ReaderInit): ByteReader {\n  const { pattern, type = 'binary', mustMatch = false, weight = 0, read } = readerInit;\n  const reader = { pattern, type, mustMatch, weight, read };\n  if (type === 'text') {\n    reader.read = async(i: ByteData, path: string) => {\n      if (i.isText == null) {\n        try {\n          i.text = stringify(i.buffer);\n          i.isText = true;\n        } catch (error) {\n          i.isText = false;\n        }\n      }\n      return i.isText ? read(i, path) : null;\n    };\n  }\n  if (type === 'json') {\n    reader.read = async(i: ByteData, path: string) => {\n      if (i.isText == null) {\n        try {\n          i.text = stringify(i.buffer);\n          i.isText = true;\n        } catch (error) {\n          i.isText = false;\n        }\n      }\n      if (i.isJSON == null) {\n        try {\n          i.data = JSON.parse(i.text!);\n          i.isJSON = true;\n        } catch (error) {\n          i.isJSON = false;\n        }\n      }\n      return i.isJSON ? read(i, path) : null;\n    };\n  }\n  return reader;\n}\nconst readers: ByteReader[] = [\n  defineReader({\n    pattern: /\\.(mp3|ogg|wav|mp4|webm|ogv|mpg|mpeg|avi|mov|flv|wmv|mkv)$/i,\n    async read(i: ByteData, _path, { createAudioBuffer }: Record<string, unknown> = {}) {\n      return readMediaData(i, async(arraybuffer: ArrayBuffer) => {\n        if (typeof createAudioBuffer === 'function') return createAudioBuffer(arraybuffer) as AudioBuffer;\n        return defaultDecode(arraybuffer);\n      });\n    }\n  }), defineReader({\n    pattern: /\\.json$/i,\n    type: 'json',\n    read(i: ByteData) {\n      const jsonData = chart123(i.text!, (_, value) => typeof value === 'number' ? Math.fround(value) : value);\n      return { type: 'chart', name: i.name, md5: md5(i.text!), data: jsonData };\n    }\n  }), defineReader({\n    pattern: /\\.(png|jpg|jpeg|gif|bmp|webp|svg)$/i,\n    async read(i: ByteData) {\n      const data = new Blob([i.buffer]);\n      const imageData = await createImageBitmap(data);\n      return { type: 'image' as const, name: i.name, data: imageData };\n    }\n  }), defineReader({\n    pattern: /^line\\.csv$/i,\n    type: 'text',\n    mustMatch: true,\n    read(i: ByteData, path: string) {\n      const data = i.text!;\n      const chartLine = joinPathInfo(csv2array(data, true) as ChartLineData[], path);\n      return { type: 'line' as const, data: chartLine };\n    }\n  }), defineReader({\n    pattern: /^info\\.csv$/i,\n    type: 'text',\n    mustMatch: true,\n    read(i: ByteData, path: string) {\n      const data = i.text!;\n      const chartInfo = joinPathInfo(csv2array(data, true) as ChartInfoData[], path);\n      return { type: 'info' as const, data: chartInfo };\n    }\n  })\n];\nasync function defaultDecode(arraybuffer: ArrayBuffer) {\n  const actx: AudioContext = new self.AudioContext();\n  await actx.close();\n  // return actx.decodeAudioData(arraybuffer);\n  return new Promise((resolve: (value: AudioBuffer) => void, reject) => {\n    const a = actx.decodeAudioData(arraybuffer, resolve, reject);\n    if (a instanceof Promise) { a.then(resolve, reject) }\n  }).catch(err => {\n    if (err == null) { throw new DOMException('Unable to decode audio data', 'EncodingError') }\n    throw err;\n  });\n}\nasync function readFile(i: ByteData, options = {}): Promise<ReaderData> {\n  const { name, path } = splitPath(i.name);\n  const readers0 = readers.filter(a => a.pattern.test(name) || !a.mustMatch);\n  readers0.sort((a, b) => {\n    if (a.pattern.test(name) && !b.pattern.test(name)) return -1;\n    if (!a.pattern.test(name) && b.pattern.test(name)) return 1;\n    if (a.weight > b.weight) return -1;\n    if (a.weight < b.weight) return 1;\n    return 0;\n  });\n  const errors = [] as Error[];\n  const errorHandler = (reader: ByteReader, err: Error) => {\n    if (reader.pattern.test(name)) errors.push(err);\n  };\n  for (const reader of readers0) {\n    try {\n      const data = await reader.read(i, path, options);\n      if (data) return data;\n    } catch (err) {\n      errorHandler(reader, err as Error);\n    }\n  }\n  return { type: 'unknown', name, data: readers[0].pattern.test(name) ? errors : '' };\n}\nexport const fileReader = {\n  readFile,\n  use: (reader: ByteReader): void => {\n    readers.push(reader);\n  }\n};\nfunction splitPath(i: string) {\n  const j = i.lastIndexOf('/');\n  const name = i.slice(j + 1);\n  const path = ~j ? i.slice(0, j) : '';\n  return { name, path };\n}\nexport function joinPathInfo(info: ChartInfoData[], path: string): ChartInfoData[] {\n  if (!path) return info;\n  for (const i of info) {\n    if (i.Chart != null) i.Chart = `${path}/${i.Chart}`;\n    if (i.Music != null) i.Music = `${path}/${i.Music}`;\n    if (i.Image != null) i.Image = `${path}/${i.Image}`;\n  }\n  return info;\n}\nasync function readMediaData(i: ByteData, createAudioBuffer: (arraybuffer: ArrayBuffer) => Promise<AudioBuffer>) {\n  const videoElement = document.createElement('video');\n  await new Promise(resolve => {\n    videoElement.src = URL.createObjectURL(new Blob([i.buffer]));\n    videoElement.preload = 'metadata';\n    videoElement.onloadedmetadata = resolve;\n    videoElement.onerror = resolve;\n  });\n  const { videoWidth: width, videoHeight: height } = videoElement;\n  const data = {\n    audio: await createAudioBuffer(i.buffer.slice(0)),\n    video: width && height ? videoElement : null\n  };\n  return { type: 'media' as const, name: i.name, data };\n}\n// test\nexport function chart123(text: string, reviver?: (this: unknown, key: string, value: unknown) => unknown): Chart {\n  const chart = (typeof reviver === 'function' ? JSON.parse(text, reviver) : JSON.parse(text)) as Chart;\n  if (chart.formatVersion === undefined) throw new Error('Invalid chart file');\n  switch (Number(chart.formatVersion) | 0) {\n    case 1: {\n      chart.formatVersion = 3;\n      for (const i of chart.judgeLineList) {\n        for (const j of i.judgeLineMoveEvents) {\n          j.start2 = j.start % 1e3 / 520;\n          j.end2 = j.end % 1e3 / 520;\n          j.start = Math.floor(j.start / 1e3) / 880;\n          j.end = Math.floor(j.end / 1e3) / 880;\n        }\n      } // fallthrough\n    }\n    case 3: {\n      for (const i of chart.judgeLineList) {\n        let y = 0;\n        let y2 = 0; // float32\n        for (const j of i.speedEvents) {\n          if (j.startTime < 0) j.startTime = 0;\n          j.floorPosition = y;\n          j.floorPosition2 = y2;\n          y += (j.endTime - j.startTime) / i.bpm * 1.875 * j.value;\n          y2 += Math.fround(Math.fround((j.endTime - j.startTime) / i.bpm * 1.875) * j.value);\n          y = Math.fround(y);\n          y2 = Math.fround(y2);\n        }\n      } // fallthrough\n    }\n    case 3473:\n      for (const i of chart.judgeLineList) {\n        if (i.numOfNotes == null) {\n          i.numOfNotes = 0;\n          for (const j of i.notesAbove) {\n            if (j.type === 1) i.numOfNotes++;\n            if (j.type === 2) i.numOfNotes++;\n            if (j.type === 3) i.numOfNotes++;\n            if (j.type === 4) i.numOfNotes++;\n          }\n          for (const j of i.notesBelow) {\n            if (j.type === 1) i.numOfNotes++;\n            if (j.type === 2) i.numOfNotes++;\n            if (j.type === 3) i.numOfNotes++;\n            if (j.type === 4) i.numOfNotes++;\n          }\n        }\n      }\n      if (chart.numOfNotes == null) {\n        chart.numOfNotes = 0;\n        for (const i of chart.judgeLineList) chart.numOfNotes += i.numOfNotes;\n      }\n      break;\n    default:\n      throw new Error(`Unsupported formatVersion: ${chart.formatVersion}`);\n  }\n  return chart;\n}\n","// type ArrayMapParameters<T> = typeof Array.prototype.map<T>;\n// type ArrayMapCallback<T> = Parameters<ArrayMapParameters<T>>[0];\nnamespace To {\n  export function int(a: unknown): number {\n    return Number(a) | 0;\n  }\n  export function float(a: unknown): number {\n    return Number(a) || 0;\n  }\n  export function bool(a: unknown): boolean {\n    return Boolean(a);\n  }\n  export function str(a: unknown): string {\n    return String(a);\n  }\n  // export function arr<T>(a: unknown, callbackfn: ArrayMapCallback<T>): T[] {\n  //   return Array.isArray(a) ? a.map(callbackfn) : [];\n  // }\n  export function arr<T>(a: unknown, constructor: new (b: Record<string, unknown>) => T): T[] {\n    return Array.isArray(a) ? a.map((i?: Record<string, unknown>) => new constructor(i || {})) : [];\n  }\n}\n// const to = {\n//   int(a: unknown): number {\n//     return Number(a) | 0;\n//   },\n//   float(a: unknown): number {\n//     return Number(a) || 0;\n//   },\n//   bool(a: unknown): boolean {\n//     return Boolean(a);\n//   },\n//   str(a: unknown): string {\n//     return String(a);\n//   },\n//   // arr<T>(a: unknown, callbackfn: ArrayMapCallback<T>): T[] {\n//   //   return Array.isArray(a) ? a.map(callbackfn) : [];\n//   // },\n//   arr<T>(a: unknown, constructor: new (b: Record<string, unknown>) => T): T[] {\n//     return Array.isArray(a) ? a.map((i?: Record<string, unknown>) => new constructor(i || {})) : [];\n//   }\n// };\nclass SpeedEvent {\n  public startTime: number;\n  public endTime: number;\n  public value: number;\n  public floorPosition: number;\n  public floorPosition2: number;\n  public constructor(event: Record<string, unknown>) {\n    this.startTime = To.int(event.startTime);\n    this.endTime = To.int(event.endTime);\n    this.value = To.float(event.value);\n    this.floorPosition = To.float(event.floorPosition);\n    this.floorPosition2 = To.float(event.floorPosition2);\n  }\n}\ninterface SpeedEventExtends extends SpeedEvent {\n  startSeconds: number;\n  endSeconds: number;\n}\nclass Note {\n  public type: number;\n  public time: number;\n  public positionX: number;\n  public holdTime: number;\n  public speed: number;\n  public floorPosition: number;\n  public constructor(note: Record<string, unknown>) {\n    this.type = To.int(note.type);\n    this.time = To.int(note.time);\n    this.positionX = To.float(note.positionX);\n    this.holdTime = To.int(note.holdTime);\n    this.speed = To.float(note.speed);\n    this.floorPosition = To.float(note.floorPosition);\n  }\n}\nexport interface NoteExtends extends Note {\n  maxVisiblePos: number;\n  offsetX: number;\n  offsetY: number;\n  alpha: number;\n  seconds: number;\n  holdSeconds: number;\n  line: JudgeLine;\n  lineId: number;\n  noteId: number;\n  isAbove: boolean;\n  name: string;\n  isMulti: boolean;\n  nearNotes: NoteExtends[];\n  badTime?: number;\n  badY?: number;\n  projectX: number;\n  projectY: number;\n  cosr: number;\n  sinr: number;\n  visible: boolean;\n  showPoint: boolean;\n  frameCount: number;\n  status: number;\n  scored: boolean;\n  holdTapTime: number;\n  holdStatus: number;\n  holdBroken: boolean;\n  statOffset: number;\n}\nclass LineEvent {\n  public startTime: number;\n  public endTime: number;\n  public start: number;\n  public end: number;\n  public start2: number;\n  public end2: number;\n  public constructor(event: Record<string, unknown>) {\n    this.startTime = To.int(event.startTime);\n    this.endTime = To.int(event.endTime);\n    this.start = To.float(event.start);\n    this.end = To.float(event.end);\n    this.start2 = To.float(event.start2);\n    this.end2 = To.float(event.end2);\n  }\n}\ninterface LineEventExtends extends LineEvent {\n  startSeconds: number;\n  endSeconds: number;\n}\nclass JudgeLine {\n  public numOfNotes: number;\n  public numOfNotesAbove: number;\n  public numOfNotesBelow: number;\n  public bpm: number;\n  public speedEvents: SpeedEvent[];\n  public notesAbove: Note[];\n  public notesBelow: Note[];\n  public judgeLineDisappearEvents: LineEvent[];\n  public judgeLineMoveEvents: LineEvent[];\n  public judgeLineRotateEvents: LineEvent[];\n  public constructor(line: Record<string, unknown>) {\n    this.numOfNotes = To.int(line.numOfNotes);\n    this.numOfNotesAbove = To.int(line.numOfNotesAbove);\n    this.numOfNotesBelow = To.int(line.numOfNotesBelow);\n    this.bpm = To.float(line.bpm);\n    this.speedEvents = To.arr(line.speedEvents, SpeedEvent);\n    this.notesAbove = To.arr(line.notesAbove, Note);\n    this.notesBelow = To.arr(line.notesBelow, Note);\n    this.judgeLineDisappearEvents = To.arr(line.judgeLineDisappearEvents, LineEvent);\n    this.judgeLineMoveEvents = To.arr(line.judgeLineMoveEvents, LineEvent);\n    this.judgeLineRotateEvents = To.arr(line.judgeLineRotateEvents, LineEvent);\n  }\n}\nexport interface JudgeLineExtends extends JudgeLine {\n  lineId: number;\n  offsetX: number;\n  offsetY: number;\n  alpha: number;\n  rotation: number;\n  positionY: number;\n  positionY2: number;\n  speedEvents: SpeedEventExtends[];\n  notesAbove: NoteExtends[];\n  notesBelow: NoteExtends[];\n  judgeLineDisappearEvents: LineEventExtends[];\n  judgeLineMoveEvents: LineEventExtends[];\n  judgeLineRotateEvents: LineEventExtends[];\n  disappearEventsIndex: number;\n  moveEventsIndex: number;\n  rotateEventsIndex: number;\n  speedEventsIndex: number;\n  cosr: number;\n  sinr: number;\n  imageW: number;\n  imageH: number;\n  imageD: boolean;\n  imageU: boolean;\n  imageS: number;\n  imageA: number;\n  imageL: [ImageBitmap, ImageBitmap, null, ImageBitmap];\n  imageC: boolean;\n}\nclass Chart {\n  public formatVersion: number;\n  public offset: number;\n  public numOfNotes: number;\n  public judgeLineList: JudgeLine[];\n  public constructor(chart: Record<string, unknown>) {\n    this.formatVersion = To.int(chart.formatVersion);\n    this.offset = To.float(chart.offset);\n    this.numOfNotes = To.int(chart.numOfNotes);\n    this.judgeLineList = To.arr(chart.judgeLineList, JudgeLine);\n  }\n}\ninterface ChartExtends extends Chart {\n  maxSeconds: number;\n  judgeLineList: JudgeLineExtends[];\n}\ninterface EventSeconds {\n  startTime: number;\n  endTime: number;\n  startSeconds: number;\n  endSeconds: number;\n}\nexport class Renderer {\n  // 容器和画布上下文\n  public stage: HTMLDivElement;\n  public canvas: HTMLCanvasElement;\n  public ctx: CanvasRenderingContext2D;\n  public canvasfg: HTMLCanvasElement;\n  public ctxfg: CanvasRenderingContext2D;\n  /** Half of the width of the canvas. */\n  public wlen: number;\n  /** Half of the height of the canvas. */\n  public hlen: number;\n  public scaleX: number;\n  public scaleY: number;\n  private width: number;\n  private height: number;\n  private matX: (x: number) => number;\n  private matY: (y: number) => number;\n  private matR: (r: number) => number;\n  // 用户设置项\n  public speed: number;\n  public lineScale: number;\n  public noteScale: number;\n  public noteScaleRatio: number;\n  public brightness: number;\n  public multiHint: boolean;\n  public playMode: number;\n  public musicVolume: number;\n  public soundVolume: number;\n  public enableFR: boolean;\n  public enableVP: boolean;\n  public lowResFactor: number;\n  // 谱面数据\n  public readonly lines: JudgeLineExtends[];\n  public readonly notes: NoteExtends[];\n  public readonly taps: NoteExtends[];\n  public readonly drags: NoteExtends[];\n  public readonly flicks: NoteExtends[];\n  public readonly holds: NoteExtends[];\n  public linesReversed: JudgeLineExtends[];\n  public notesReversed: NoteExtends[];\n  public tapsReversed: NoteExtends[];\n  public dragsReversed: NoteExtends[];\n  public flicksReversed: NoteExtends[];\n  public holdsReversed: NoteExtends[];\n  public readonly tapholds: NoteExtends[];\n  // 资源数据\n  public chart: ChartExtends | null;\n  public bgImage: ImageBitmap;\n  public bgImageBlur: ImageBitmap;\n  public bgMusic: AudioBuffer;\n  public bgVideo: HTMLVideoElement | null;\n  private _mirrorType: number;\n  private initialized: boolean;\n  public constructor(stage: unknown) {\n    if (!(stage instanceof HTMLDivElement)) throw new Error('Not a container');\n    const fail = () => { throw new Error('Failed to initialize canvas') };\n    this.stage = stage;\n    this.canvas = document.createElement('canvas');\n    this.ctx = this.canvas.getContext('2d', { alpha: false }) || fail(); // 游戏界面(alpha:false会使Firefox显示异常/需要验证)\n    this.canvasfg = document.createElement('canvas'); // 绘制游戏主界面(OffscreenCanvas会使Safari崩溃)\n    this.ctxfg = this.canvasfg.getContext('2d') || fail();\n    this.stage.appendChild(this.canvas);\n    this.canvas.style.cssText = ';position:absolute;top:0px;left:0px;right:0px;bottom:0px';\n    console.log('Hello, Phixos!');\n    // config\n    this.speed = 1;\n    this.lineScale = 57.6;\n    this.noteScale = 1; // note缩放设定值\n    this.noteScaleRatio = 8e3; // note缩放比率，由noteScale计算而来\n    this.brightness = 0.6;\n    // this.songName = '';\n    // this.chartLevel = '';\n    // this.illustrator = '';\n    // this.chartDesign = '';\n    // this.feedback = true;\n    // this.imageBlur = true;\n    this.multiHint = true;\n    // this.hitSound = true;\n    // this.anchorPoint = false;\n    // this.coloredLine = true;\n    // this.perfectLine = '#feffa9';\n    // this.goodLine = '#a2eeff';\n    // this.perfectNote = '#ffeca0';\n    // this.goodNote = '#b4e1ff';\n    // this.badNote = '#6c4343';\n    this.playMode = 1; // 0:game,1:auto,2:hyper,3:auto&hyper\n    this.musicVolume = 1;\n    this.soundVolume = 1;\n    // this.showTransition = true;\n    // this.chartOffset = 0;\n    this._mirrorType = 0;\n    this.enableFR = false;\n    this.enableVP = false;\n    // chart\n    this.chart = null;\n    this.bgImage = null as unknown as ImageBitmap;\n    this.bgImageBlur = null as unknown as ImageBitmap;\n    this.bgMusic = null as unknown as AudioBuffer;\n    this.bgVideo = null;\n    this.lines = [];\n    this.notes = [];\n    this.taps = [];\n    this.drags = [];\n    this.flicks = [];\n    this.holds = [];\n    this.linesReversed = [];\n    this.notesReversed = [];\n    this.tapsReversed = [];\n    this.dragsReversed = [];\n    this.flicksReversed = [];\n    this.holdsReversed = [];\n    this.tapholds = [];\n    // canvas\n    this.lowResFactor = 1;\n    this.width = 0;\n    this.height = 0;\n    this.wlen = 0;\n    this.hlen = 0;\n    this.scaleX = 0;\n    this.scaleY = 0;\n    this.matX = x => x;\n    this.matY = y => y;\n    this.matR = r => r;\n    this.initialized = false;\n    // event\n    this._setLowResFactor(1);\n    this.resizeCanvas();\n  }\n  // public get bgImage(): ImageBitmap {\n  //   if (!this._bgImage) throw new Error('No background image');\n  //   return this._bgImage;\n  // }\n  // public set bgImage(value: ImageBitmap) {\n  //   this._bgImage = value;\n  // }\n  // public get bgImageBlur(): ImageBitmap {\n  //   if (!this._bgImageBlur) throw new Error('No background image');\n  //   return this._bgImageBlur;\n  // }\n  // public set bgImageBlur(value: ImageBitmap) {\n  //   this._bgImageBlur = value;\n  // }\n  // public get bgMusic(): AudioBuffer {\n  //   if (!this._bgMusic) throw new Error('No background music');\n  //   return this._bgMusic;\n  // }\n  // public set bgMusic(value: AudioBuffer) {\n  //   this._bgMusic = value;\n  // }\n  // config\n  public setNoteScale(num = 1): void {\n    this.noteScale = num;\n    this.noteScaleRatio = this.canvasfg.width * this.noteScale / 8080; // note、特效缩放\n  }\n  public setLowResFactor(num = 1): void {\n    this._setLowResFactor(num);\n    this._resizeCanvas();\n  }\n  public resizeCanvas(): void {\n    const { clientWidth: width, clientHeight: height } = this.stage;\n    if (this.width === width && this.height === height) return;\n    this.width = width;\n    this.height = height;\n    this.canvas.style.cssText += `;width:${width}px;height:${height}px`; // 只有inset还是会溢出\n    this._resizeCanvas();\n  }\n  public mirrorView(code = this._mirrorType): void {\n    const n = 3 & code;\n    this._mirrorType = n;\n    this.transformView(1 & n ? -1 : 1, 2 & n ? -1 : 1, 0, 0);\n  }\n  public transformView(scaleX = 1, scaleY = 1, offsetX = 0, offsetY = 0): void {\n    const { canvasfg } = this;\n    const xa = canvasfg.width * scaleX;\n    const xb = (canvasfg.width - xa) * 0.5;\n    const ya = -canvasfg.height * scaleY;\n    const yb = (canvasfg.height - ya) * 0.5;\n    const ra = -Math.sign(scaleX * scaleY) * Math.PI / 180;\n    const rb = scaleY > 0 ? 0 : Math.PI;\n    const tx = Math.sign(scaleY) * xa * 0.05625;\n    const ty = Math.sign(scaleY) * -ya * 0.6; // 控制note流速\n    this.matX = x => xb + xa * (x - offsetX);\n    this.matY = y => yb + ya * (y - offsetY);\n    this.matR = r => rb + ra * r;\n    this.scaleX = tx;\n    this.scaleY = ty;\n    this.initialized = true;\n  }\n  // note预处理\n  public prerenderChart(chart: Record<string, unknown>): void {\n    this.lines.length = 0;\n    this.notes.length = 0;\n    this.taps.length = 0;\n    this.drags.length = 0;\n    this.flicks.length = 0;\n    this.holds.length = 0;\n    this.tapholds.length = 0;\n    const chartNew = new Chart(chart) as ChartExtends;\n    const ss = {\n      aniStart: 1e9,\n      aniEnd: 0,\n      hitStart: 1e9,\n      hitEnd: 0\n    };\n    const aniUpdate = (seconds: number) => {\n      if (seconds < ss.aniStart) ss.aniStart = seconds;\n      if (seconds > ss.aniEnd) ss.aniEnd = seconds;\n    };\n    const hitUpdate = (seconds: number) => {\n      aniUpdate(seconds);\n      if (seconds < ss.hitStart) ss.hitStart = seconds;\n      if (seconds > ss.hitEnd) ss.hitEnd = seconds;\n    };\n    // 添加seconds\n    const addSeconds = (events: EventSeconds[], bpm: number) => {\n      for (const i of events) {\n        i.startSeconds = i.startTime / bpm * 1.875;\n        i.endSeconds = i.endTime / bpm * 1.875;\n        if (i.startTime > 1 - 1e6) aniUpdate(i.startSeconds);\n        if (i.endTime < 1e9) aniUpdate(i.endSeconds);\n      }\n    };\n    // 获取note最大可见位置\n    const getMaxVisiblePos = (x: number) => {\n      const n = Math.fround(x);\n      if (!isFinite(n)) throw new TypeError('Argument must be a finite number');\n      const magic = 11718.75;\n      const prime = n >= magic ? 2 ** Math.floor(1 + Math.log2(n / magic)) : 1;\n      const a = n / prime + 0.001;\n      const r = Math.fround(a);\n      if (r <= a) return r * prime;\n      const a_ = new Float32Array([a]);\n      new Uint32Array(a_.buffer)[0] += a_[0] <= 0 ? 1 : -1;\n      return a_[0] * prime;\n    };\n    // 向Renderer添加Note\n    const addNote = (note: NoteExtends, beat32: number, line: JudgeLineExtends, noteId: number, isAbove: boolean) => {\n      note.offsetX = 0;\n      note.offsetY = 0;\n      note.alpha = 0;\n      note.seconds = note.time * beat32;\n      note.holdSeconds = note.holdTime * beat32;\n      note.maxVisiblePos = getMaxVisiblePos(note.floorPosition);\n      if (note.time < 1e9) {\n        hitUpdate(note.seconds);\n        hitUpdate(note.seconds + note.holdSeconds);\n      }\n      note.line = line;\n      note.lineId = line.lineId;\n      note.noteId = noteId;\n      note.isAbove = isAbove;\n      note.name = `${line.lineId}${isAbove ? '+' : '-'}${noteId}${'?tdhf'[note.type]}`;\n      this.notes.push(note);\n      if (note.type === 1) this.taps.push(note);\n      else if (note.type === 2) this.drags.push(note);\n      else if (note.type === 3) this.holds.push(note);\n      else if (note.type === 4) this.flicks.push(note);\n      if (note.type === 1 || note.type === 3) this.tapholds.push(note);\n    };\n    const sortNote = (a: NoteExtends, b: NoteExtends) => a.seconds - b.seconds || a.lineId - b.lineId || a.noteId - b.noteId;\n    // 优化events\n    chartNew.judgeLineList.forEach((i, lineId) => i.lineId = lineId);\n    for (const i of chartNew.judgeLineList) {\n      i.bpm *= this.speed;\n      i.offsetX = 0;\n      i.offsetY = 0;\n      i.alpha = 0;\n      i.rotation = 0;\n      i.positionY = 0; // 临时过渡用\n      i.positionY2 = 0;\n      i.speedEvents = normalizeSpeedEvent(i.speedEvents) as SpeedEventExtends[];\n      i.judgeLineDisappearEvents = normalizeLineEvent(i.judgeLineDisappearEvents) as LineEventExtends[];\n      i.judgeLineMoveEvents = normalizeLineEvent(i.judgeLineMoveEvents) as LineEventExtends[];\n      i.judgeLineRotateEvents = normalizeLineEvent(i.judgeLineRotateEvents) as LineEventExtends[];\n      i.disappearEventsIndex = 0;\n      i.moveEventsIndex = 0;\n      i.rotateEventsIndex = 0;\n      i.speedEventsIndex = 0;\n      addSeconds(i.speedEvents, i.bpm);\n      addSeconds(i.judgeLineDisappearEvents, i.bpm);\n      addSeconds(i.judgeLineMoveEvents, i.bpm);\n      addSeconds(i.judgeLineRotateEvents, i.bpm);\n      this.lines.push(i); // TODO: 可以定义新类避免函数在循环里定义\n      i.notesAbove.forEach((j, noteId) => addNote(j, 1.875 / i.bpm, i, noteId, true));\n      i.notesBelow.forEach((j, noteId) => addNote(j, 1.875 / i.bpm, i, noteId, false));\n    }\n    this.notes.sort(sortNote);\n    this.taps.sort(sortNote);\n    this.drags.sort(sortNote);\n    this.holds.sort(sortNote);\n    this.flicks.sort(sortNote);\n    this.notesReversed = this.notes.slice(0).reverse();\n    this.tapsReversed = this.taps.slice(0).reverse();\n    this.dragsReversed = this.drags.slice(0).reverse();\n    this.holdsReversed = this.holds.slice(0).reverse();\n    this.flicksReversed = this.flicks.slice(0).reverse();\n    this.linesReversed = this.lines.slice(0).reverse();\n    this.tapholds.sort(sortNote);\n    // 多押标记\n    const timeOfMulti: Record<string, number> = {};\n    for (const i of this.notes) timeOfMulti[i.seconds.toFixed(6)] = timeOfMulti[i.seconds.toFixed(6)] ? 2 : 1;\n    for (const i of this.notes) i.isMulti = timeOfMulti[i.seconds.toFixed(6)] === 2;\n    // 分析邻近Note(0.01s内标记，用于预处理Flick,TapHold重叠判定)\n    for (let i = 0; i < this.flicks.length; i++) {\n      const note = this.flicks[i];\n      note.nearNotes = [];\n      for (let j = i + 1; j < this.flicks.length; j++) {\n        const note2 = this.flicks[j];\n        if (Math.fround(note2.seconds - note.seconds) > 0.01) break;\n        note.nearNotes.push(note2);\n      }\n    }\n    for (let i = 0; i < this.tapholds.length; i++) {\n      const note = this.tapholds[i];\n      note.nearNotes = [];\n      for (let j = i + 1; j < this.tapholds.length; j++) {\n        const note2 = this.tapholds[j];\n        if (Math.fround(note2.seconds - note.seconds) > 0.01) break;\n        note.nearNotes.push(note2);\n      }\n    }\n    this.chart = chartNew;\n    this.chart.maxSeconds = ss.aniEnd;\n    console.table(ss);\n  }\n  /** 从0开始，将事件index定位到正确位置 */\n  public seekLineEventIndex(time?: number): void {\n    if (!this.initialized) throw new Error('Not initialized');\n    for (const line of this.lines) {\n      line.speedEventsIndex = 0;\n      line.disappearEventsIndex = 0;\n      line.moveEventsIndex = 0;\n      line.rotateEventsIndex = 0;\n      if (time == null) continue;\n      while (line.speedEventsIndex < line.speedEvents.length && line.speedEvents[line.speedEventsIndex].startSeconds < time) line.speedEventsIndex++;\n      while (line.disappearEventsIndex < line.judgeLineDisappearEvents.length && line.judgeLineDisappearEvents[line.disappearEventsIndex].startSeconds < time) line.disappearEventsIndex++;\n      while (line.moveEventsIndex < line.judgeLineMoveEvents.length && line.judgeLineMoveEvents[line.moveEventsIndex].startSeconds < time) line.moveEventsIndex++;\n      while (line.rotateEventsIndex < line.judgeLineRotateEvents.length && line.judgeLineRotateEvents[line.rotateEventsIndex].startSeconds < time) line.rotateEventsIndex++;\n    }\n  }\n  public updateByTime(time: number): void {\n    if (!this.initialized) throw new Error('Not initialized');\n    for (const line of this.lines) {\n      for (let i = line.disappearEventsIndex, len = line.judgeLineDisappearEvents.length; i < len; i++) {\n        const evt = line.judgeLineDisappearEvents[i];\n        if (time > evt.endSeconds) continue;\n        const dt = (time - evt.startSeconds) / (evt.endSeconds - evt.startSeconds);\n        line.alpha = evt.start + (evt.end - evt.start) * dt;\n        if (line.alpha > 1) line.alpha = 1;\n        line.disappearEventsIndex = i;\n        break;\n      }\n      for (let i = line.moveEventsIndex, len = line.judgeLineMoveEvents.length; i < len; i++) {\n        const evt = line.judgeLineMoveEvents[i];\n        if (time > evt.endSeconds) continue;\n        const dt = (time - evt.startSeconds) / (evt.endSeconds - evt.startSeconds);\n        line.offsetX = this.matX(evt.start + (evt.end - evt.start) * dt);\n        line.offsetY = this.matY(evt.start2 + (evt.end2 - evt.start2) * dt);\n        line.moveEventsIndex = i;\n        break;\n      }\n      for (let i = line.rotateEventsIndex, len = line.judgeLineRotateEvents.length; i < len; i++) {\n        const evt = line.judgeLineRotateEvents[i];\n        if (time > evt.endSeconds) continue;\n        const dt = (time - evt.startSeconds) / (evt.endSeconds - evt.startSeconds);\n        line.rotation = this.matR(evt.start + (evt.end - evt.start) * dt);\n        line.cosr = Math.cos(line.rotation);\n        line.sinr = Math.sin(line.rotation);\n        line.rotateEventsIndex = i;\n        break;\n      }\n      for (let i = line.speedEventsIndex, len = line.speedEvents.length; i < len; i++) {\n        const evt = line.speedEvents[i];\n        if (time > evt.endSeconds) continue;\n        line.positionY = (time - evt.startSeconds) * this.speed * evt.value + (this.enableFR ? evt.floorPosition2 : evt.floorPosition);\n        line.positionY2 = (time - evt.startSeconds) * this.speed * evt.value + evt.floorPosition2;\n        line.speedEventsIndex = i;\n        break;\n      }\n      const getGoodY = (i: NoteExtends) => {\n        if (i.type !== 3) return (i.floorPosition - line.positionY) * i.speed;\n        if (i.seconds < time) return (i.seconds - time) * this.speed * i.speed;\n        return i.floorPosition - line.positionY;\n      };\n      const getBadY = (i: NoteExtends) => {\n        if (i.badTime == null) return getGoodY(i);\n        if (performance.now() - i.badTime > 500) delete i.badTime;\n        if (i.badY == null) i.badY = getGoodY(i);\n        return i.badY;\n      };\n      const setAlpha = (i: NoteExtends, dx: number, dy: number) => {\n        i.projectX = line.offsetX + dx * i.cosr;\n        i.offsetX = i.projectX + dy * i.sinr;\n        i.projectY = line.offsetY + dx * i.sinr;\n        i.offsetY = i.projectY - dy * i.cosr;\n        i.visible = (i.offsetX - this.wlen) ** 2 + (i.offsetY - this.hlen) ** 2 < (this.wlen * 1.23625 + this.hlen + this.scaleY * i.holdSeconds * this.speed * i.speed) ** 2; // Math.hypot实测性能较低\n        i.showPoint = false;\n        if (i.badTime != null) {\n          // Not bad\n        } else if (i.seconds > time) {\n          i.showPoint = true;\n          const isHidden = i.maxVisiblePos < line.positionY2;\n          i.alpha = isHidden || this.enableVP && getGoodY(i) * 0.6 > 2 ? 0 : i.type === 3 && i.speed === 0 ? 0 : 1;\n        } else {\n          i.frameCount = i.frameCount == null ? 0 : i.frameCount + 1;\n          if (i.type === 3) {\n            i.showPoint = true;\n            i.alpha = i.speed === 0 ? 0 : i.status % 4 === 2 ? 0.45 : 1;\n          } else i.alpha = Math.max(1 - (time - i.seconds) / 0.16, 0); // 过线后0.16s消失\n        }\n      };\n      for (const i of line.notesAbove) {\n        i.cosr = line.cosr;\n        i.sinr = line.sinr;\n        setAlpha(i, this.scaleX * i.positionX, this.scaleY * getBadY(i));\n      }\n      for (const i of line.notesBelow) {\n        i.cosr = -line.cosr;\n        i.sinr = -line.sinr;\n        setAlpha(i, -this.scaleX * i.positionX, this.scaleY * getBadY(i));\n      }\n    }\n  }\n  private _setLowResFactor(num = 1) {\n    this.lowResFactor = num * self.devicePixelRatio;\n  }\n  private _resizeCanvas() {\n    const { canvas, canvasfg, width, height } = this;\n    const widthLowRes = width * this.lowResFactor;\n    const heightLowRes = height * this.lowResFactor;\n    canvas.width = widthLowRes;\n    canvas.height = heightLowRes;\n    canvasfg.width = Math.min(widthLowRes, heightLowRes * 16 / 9);\n    canvasfg.height = heightLowRes;\n    this.wlen = canvasfg.width / 2;\n    this.hlen = canvasfg.height / 2;\n    this.mirrorView();\n    this.setNoteScale(this.noteScale);\n    this.lineScale = canvasfg.width > canvasfg.height * 0.75 ? canvasfg.height / 18.75 : canvasfg.width / 14.0625; // 判定线、文字缩放\n  }\n}\n// 规范判定线事件\nfunction normalizeLineEvent(events: LineEvent[]) {\n  const oldEvents = events.map(i => new LineEvent(i as unknown as Record<string, unknown>)); // 深拷贝\n  if (!oldEvents.length) return [new LineEvent({ startTime: -999999, endTime: 1e9 })]; // 如果没有事件，添加一个默认事件(以后添加warning)\n  const newEvents = [\n    new LineEvent({\n      startTime: -999999,\n      endTime: 0,\n      start: oldEvents[0].start,\n      end: oldEvents[0].start,\n      start2: oldEvents[0].start2,\n      end2: oldEvents[0].start2\n    })\n  ]; // 以1-1e6开头\n  oldEvents.push(new LineEvent({\n    startTime: oldEvents[oldEvents.length - 1].endTime,\n    endTime: 1e9,\n    start: oldEvents[oldEvents.length - 1].end,\n    end: oldEvents[oldEvents.length - 1].end,\n    start2: oldEvents[oldEvents.length - 1].end2,\n    end2: oldEvents[oldEvents.length - 1].end2\n  })); // 以1e9结尾\n  for (const i2 of oldEvents) {\n    // 保证时间连续性\n    if (i2.startTime > i2.endTime) continue;\n    const i1 = newEvents[newEvents.length - 1];\n    if (i1.endTime > i2.endTime) {\n      // 忽略\n    } else if (i1.endTime === i2.startTime) newEvents.push(i2);\n    else if (i1.endTime < i2.startTime) {\n      newEvents.push(new LineEvent({\n        startTime: i1.endTime,\n        endTime: i2.startTime,\n        start: i1.end,\n        end: i1.end,\n        start2: i1.end2,\n        end2: i1.end2\n      }), i2);\n    } else if (i1.endTime > i2.startTime) {\n      newEvents.push(new LineEvent({\n        startTime: i1.endTime,\n        endTime: i2.endTime,\n        start: (i2.start * (i2.endTime - i1.endTime) + i2.end * (i1.endTime - i2.startTime)) / (i2.endTime - i2.startTime),\n        end: i1.end,\n        start2: (i2.start2 * (i2.endTime - i1.endTime) + i2.end2 * (i1.endTime - i2.startTime)) / (i2.endTime - i2.startTime),\n        end2: i1.end2\n      }));\n    }\n  }\n  // 合并相同变化率事件\n  const newEvents2 = [newEvents.shift()!];\n  for (const i2 of newEvents) {\n    const i1 = newEvents2[newEvents2.length - 1];\n    const d1 = i1.endTime - i1.startTime;\n    const d2 = i2.endTime - i2.startTime;\n    if (i2.startTime === i2.endTime) {\n      // 忽略\n    } else if (i1.end === i2.start && i1.end2 === i2.start2 && (i1.end - i1.start) * d2 === (i2.end - i2.start) * d1 && (i1.end2 - i1.start2) * d2 === (i2.end2 - i2.start2) * d1) {\n      i1.endTime = i2.endTime;\n      i1.end = i2.end;\n      i1.end2 = i2.end2;\n    } else newEvents2.push(i2);\n  }\n  return newEvents2;\n}\n// 规范speedEvents\nfunction normalizeSpeedEvent(events: SpeedEvent[]) {\n  const newEvents = [];\n  for (const i2 of events) {\n    const i1 = newEvents[newEvents.length - 1];\n    if (i1?.value === i2.value) i1.endTime = i2.endTime;\n    else newEvents.push(i2);\n  }\n  return newEvents;\n}\n","type HitType = 'keyboard' | 'mouse' | 'touch';\nclass HitEvent {\n  public type: HitType;\n  public id: number | string;\n  public offsetX: number;\n  public offsetY: number;\n  public isActive: boolean;\n  public isTapped: boolean;\n  public isMoving: boolean;\n  public lastDeltaX: number;\n  public lastDeltaY: number;\n  public nowDeltaX: number;\n  public nowDeltaY: number;\n  public deltaTime: number;\n  public currentTime: number;\n  public flicking: boolean;\n  public flicked: boolean;\n  public constructor(type: HitType, id: number | string, offsetX: number, offsetY: number) {\n    this.type = type;\n    this.id = id;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    this.isActive = true; // 是否标记为按下，若false则可以移除\n    this.isTapped = false; // 是否触发过Tap判定\n    this.isMoving = false; // 是否正在移动\n    // flick(speed)\n    this.lastDeltaX = 0;\n    this.lastDeltaY = 0;\n    this.nowDeltaX = 0;\n    this.nowDeltaY = 0;\n    this.deltaTime = 0; // 按下时间差\n    this.currentTime = performance.now(); // 按下时间\n    this.flicking = false; // 是否触发Flick判定\n    this.flicked = false; // 是否触发过Flick判定\n  }\n  public move(offsetX: number, offsetY: number): void {\n    this.lastDeltaX = this.nowDeltaX;\n    this.lastDeltaY = this.nowDeltaY;\n    this.nowDeltaX = offsetX - this.offsetX;\n    this.nowDeltaY = offsetY - this.offsetY;\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    const time = performance.now();\n    this.deltaTime = time - this.currentTime;\n    this.currentTime = time;\n    this.isMoving = true;\n    const flickSpeed = (this.nowDeltaX * this.lastDeltaX + this.nowDeltaY * this.lastDeltaY) / Math.sqrt(this.lastDeltaX ** 2 + this.lastDeltaY ** 2) / this.deltaTime;\n    if (this.flicking && flickSpeed < 0.5) {\n      this.flicking = false;\n      this.flicked = false;\n    } else if (!this.flicking && flickSpeed > 1.0) this.flicking = true;\n  }\n}\nexport class HitManager {\n  public list: HitEvent[];\n  public constructor() {\n    this.list = [];\n  }\n  public activate(type: HitType, id: number | string, offsetX: number, offsetY: number): void {\n    const { list } = this;\n    const idx = list.findIndex(hit => hit.type === type && hit.id === id);\n    if (idx !== -1) list.splice(idx, 1);\n    list.push(new HitEvent(type, id, offsetX, offsetY));\n  }\n  public moving(type: HitType, id: number | string, offsetX: number, offsetY: number): void {\n    const hitEl = this.list.find(hit => hit.type === type && hit.id === id);\n    if (hitEl) hitEl.move(offsetX, offsetY);\n  }\n  public deactivate(type: HitType, id: number | string): void {\n    const hitEl = this.list.find(hit => hit.type === type && hit.id === id);\n    if (hitEl) hitEl.isActive = false;\n  }\n  public update(): void {\n    const { list } = this;\n    for (let i = 0; i < list.length; i++) {\n      const hitEl = list[i];\n      if (hitEl.isActive) {\n        hitEl.isTapped = true;\n        hitEl.isMoving = false;\n      } else list.splice(i--, 1);\n    }\n  }\n  public clear(type: HitType): void {\n    for (const i of this.list) if (i.type === type) this.deactivate(type, i.id);\n  }\n}\nexport class JudgeEvent {\n  public offsetX: number;\n  public offsetY: number;\n  public type: number;\n  public judged: boolean;\n  public event?: HitEvent;\n  public preventBad: boolean;\n  public constructor(offsetX: number, offsetY: number, type: number, event?: HitEvent) {\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    this.type = type | 0; // 1-Tap,2-Hold/Drag,3-Move\n    this.judged = false; // 是否被判定\n    this.event = event; // Flick专用回调\n    this.preventBad = false; // 是否阻止判定为Bad\n  }\n}\n","export class Stat {\n  public level: number;\n  public noteRank: [number, number, number, number, number, number, number, number];\n  public combos: [number, number, number, number, number];\n  public maxcombo: number;\n  public combo: number;\n  private cumDisp: number;\n  private curDisp: number;\n  private numDisp: number;\n  private numOfNotes: number;\n  private data: Record<string, string>;\n  private id: string;\n  public constructor() {\n    this.level = 0;\n    this.noteRank = [0, 0, 0, 0, 0, 0, 0, 0];\n    this.combos = [0, 0, 0, 0, 0];\n    this.cumDisp = 0;\n    this.curDisp = 0;\n    this.numDisp = 0;\n    this.maxcombo = 0;\n    this.combo = 0;\n    this.numOfNotes = 0;\n    this.data = {};\n    this.id = '';\n  }\n  public get good(): number {\n    return this.noteRank[7] + this.noteRank[3];\n  }\n  public get bad(): number {\n    return this.noteRank[6] + this.noteRank[2];\n  }\n  public get great(): number {\n    return this.noteRank[5] + this.noteRank[1];\n  }\n  public get perfect(): number {\n    return this.noteRank[4] + this.great;\n  }\n  public get all(): number {\n    return this.perfect + this.good + this.bad;\n  }\n  public get scoreNum(): number {\n    const a = 1e6 * (this.perfect * 0.9 + this.good * 0.585 + this.maxcombo * 0.1) / this.numOfNotes;\n    return isFinite(a) ? a : 0;\n  }\n  public get scoreStr(): string {\n    const a = this.scoreNum.toFixed(0);\n    return '0'.repeat(a.length < 7 ? 7 - a.length : 0) + a;\n  }\n  public get accNum(): number {\n    const a = (this.perfect + this.good * 0.65) / this.all;\n    return isFinite(a) ? a : 1;\n  }\n  public get accStr(): string {\n    return `${(100 * this.accNum).toFixed(2)}\\uff05`;\n  }\n  public get avgDispStr(): string {\n    const a = Math.trunc(this.cumDisp / this.numDisp * 1e3) || 0;\n    return `${a > 0 ? '+' : ''}${a.toFixed(0)}ms`;\n  }\n  public get curDispStr(): string {\n    const a = Math.trunc(this.curDisp * 1e3);\n    return `${a > 0 ? '+' : ''}${a.toFixed(0)}ms`;\n  }\n  public get lineStatus(): 0 | 1 | 3 {\n    if (this.bad) return 0;\n    if (this.good) return 3;\n    return 1;\n  }\n  public get rankStatus(): 0 | 1 | 2 | 3 | 4 | 5 | 6 {\n    const a = Math.round(this.scoreNum);\n    if (a >= 1e6) return 0;\n    if (a >= 9.6e5) return 1;\n    if (a >= 9.2e5) return 2;\n    if (a >= 8.8e5) return 3;\n    if (a >= 8.2e5) return 4;\n    if (a >= 7e5) return 5;\n    return 6;\n  }\n  public get localData(): string {\n    const l1 = Math.round(this.accNum * 1e4 + 566).toString(22).slice(-3);\n    const l2 = Math.round(this.scoreNum + 40672).toString(32).slice(-4);\n    const l3 = this.level.toString(36).slice(-1);\n    return l1 + l2 + l3;\n  }\n  public static removeLegacy(key: string): void {\n    const item = localStorage.getItem('phi');\n    if (item == null) return;\n    localStorage.setItem(key, item);\n    localStorage.removeItem('phi');\n  }\n  public getData(isAuto: boolean, speed = ''): StatData {\n    const s1 = this.data[this.id].slice(0, 3);\n    const s2 = this.data[this.id].slice(3, 7);\n    const l1 = Math.round(this.accNum * 1e4 + 566).toString(22).slice(-3);\n    const l2 = Math.round(this.scoreNum + 40672).toString(32).slice(-4);\n    const l3 = this.level.toString(36).slice(-1);\n    const na = parseInt(s2, 32) - 40672;\n    const sa = na.toFixed(0);\n    const sb = '0'.repeat(sa.length < 7 ? 7 - sa.length : 0) + sa;\n    if (!isAuto) this.data[this.id] = (s1 > l1 ? s1 : l1) + (s2 > l2 ? s2 : l2) + l3;\n    const arr = [];\n    for (const [i, v] of Object.entries(this.data)) arr.push(i + v);\n    localStorage.setItem(`phi-${speed}`, arr.sort(() => Math.random() - 0.5).join(''));\n    const pbj = {\n      newBestColor: s2 < l2 ? '#18ffbf' : '#fff',\n      newBestStr: s2 < l2 ? 'NEW BEST' : 'BEST',\n      scoreBest: sb,\n      scoreDelta: `${s2 > l2 ? '- ' : '+ '}${Math.abs(na - Math.round(this.scoreNum))}`,\n      textAboveColor: '#65fe43',\n      textAboveStr: '  ( Speed {SPEED}x )',\n      textBelowColor: '#fe4365',\n      textBelowStr: 'AUTO PLAY'\n    };\n    if (isAuto) {\n      return Object.assign(pbj, {\n        newBestColor: '#fff',\n        newBestStr: 'BEST',\n        scoreDelta: ''\n      });\n    }\n    if (this.lineStatus === 1) {\n      return Object.assign(pbj, {\n        textBelowStr: 'ALL  PERFECT',\n        textBelowColor: '#ffc500'\n      });\n    }\n    if (this.lineStatus === 3) {\n      return Object.assign(pbj, {\n        textBelowStr: 'FULL  COMBO',\n        textBelowColor: '#00bef1'\n      });\n    }\n    return Object.assign(pbj, { textBelowStr: '' });\n  }\n  public reset(numOfNotes: number, id: string, speed = ''): void {\n    const key = `phi-${speed}`;\n    this.numOfNotes = numOfNotes | 0;\n    this.combo = 0;\n    this.maxcombo = 0;\n    this.noteRank = [0, 0, 0, 0, 0, 0, 0, 0]; // 4:PM,5:PE,1:PL,7:GE,3:GL,6:BE,2:BL\n    this.combos = [0, 0, 0, 0, 0]; // 不同种类note实时连击次数\n    this.cumDisp = 0;\n    this.curDisp = 0;\n    this.numDisp = 0;\n    if (speed === '') Stat.removeLegacy(key);\n    const str = localStorage.getItem(key) ?? (localStorage.setItem(key, ''), ''); // 初始化存储\n    for (let i = 0; i < Math.floor(str.length / 40); i++) {\n      const data = str.slice(i * 40, i * 40 + 40);\n      this.data[data.slice(0, 32)] = data.slice(-8);\n    }\n    if (id) {\n      if (!this.data[id]) this.data[id] = this.localData;\n      this.id = id;\n    }\n  }\n  public addCombo(status: number, type: number): void {\n    this.noteRank[status]++;\n    this.combo = status % 4 === 2 ? 0 : this.combo + 1;\n    if (this.combo > this.maxcombo) this.maxcombo = this.combo;\n    this.combos[0]++;\n    this.combos[type]++;\n  }\n  public addDisp(disp: number): void {\n    this.curDisp = disp;\n    this.cumDisp += disp;\n    this.numDisp++;\n  }\n}\n","export default function(\n  width: number, height: number,\n  options?: CanvasRenderingContext2DSettings\n): CanvasRenderingContext2D {\n  const canvas = document.createElement('canvas');\n  Object.assign(canvas, { width, height });\n  const ctx = canvas.getContext('2d', options);\n  if (!ctx) throw new TypeError('Failed to create canvas context');\n  return ctx;\n}\n","import createCtx from './createCtx';\nexport function decode(img: ImageBitmap, border = 0): ArrayBuffer {\n  const ctx1 = createCtx(img.width - border * 2, img.height - border * 2);\n  ctx1.drawImage(img, -border, -border);\n  const id = ctx1.getImageData(0, 0, ctx1.canvas.width, ctx1.canvas.width);\n  const ab = new Uint8Array(id.data.length / 4 * 3);\n  for (let i = 0; i < ab.length; i++) ab[i] = id.data[(i / 3 | 0) * 4 + i % 3] ^ i * 3473;\n  const size = new DataView(ab.buffer, 0, 4).getUint32(0);\n  return ab.buffer.slice(4, size + 4);\n}\nexport function decodeAlt(img: ImageBitmap): ArrayBuffer {\n  const ctx = createCtx(img.width, img.height);\n  ctx.drawImage(img, 0, 0);\n  const id = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\n  const ab = new Uint8Array(id.data.length / 4 * 3);\n  const mask = (v = 0, i = 0) => v ^ i ** 2 * 3473 & 255;\n  for (let i = 0; i < ab.length; i++) ab[i] = id.data[(i / 3 | 0) * 4 + i % 3];\n  const combined = new Uint8Array(ab.length / 2);\n  for (let i = 0; i < ab.length / 2; i++) combined[i] = mask((ab[i * 2] + 8) / 17 << 4 | (ab[i * 2 + 1] + 8) / 17, i);\n  const size = new DataView(combined.buffer, 0, 4).getUint32(0);\n  return combined.buffer.slice(4, size + 4);\n}\n","export class Checkbox {\n  public container: HTMLDivElement;\n  public checkbox: HTMLInputElement;\n  public label: HTMLLabelElement;\n  public constructor(text: string, checked = false) {\n    this.container = document.createElement('div');\n    this.checkbox = document.createElement('input');\n    this.checkbox.type = 'checkbox';\n    this.checkbox.id = Utils.randomUUID();\n    this.checkbox.checked = checked;\n    this.label = document.createElement('label');\n    this.label.htmlFor = this.checkbox.id;\n    this.label.textContent = text;\n    this.container.appendChild(this.checkbox);\n    this.container.appendChild(this.label);\n  }\n  public get checked(): boolean {\n    return this.checkbox.checked;\n  }\n  public set checked(value: boolean) {\n    this.checkbox.checked = value;\n    this.checkbox.dispatchEvent(new Event('change'));\n  }\n  public appendTo(container: HTMLElement): this {\n    container.appendChild(this.container);\n    return this;\n  }\n  public appendBefore(node: HTMLElement): this {\n    if (node.parentNode == null) { throw new Error('Node must have a parent node') }\n    node.parentNode.insertBefore(this.container, node);\n    return this;\n  }\n  public toggle(): void {\n    this.checked = !this.checkbox.checked;\n  }\n  public hook(callback = (_arg0: HTMLInputElement, _arg1: HTMLDivElement) => {}): this {\n    callback(this.checkbox, this.container);\n    return this;\n  }\n}\n","export class HitEvents extends Array {\n  public update: () => void;\n  public animate: () => void;\n  public constructor({\n    updateCallback = (..._arg: any[]): boolean => false,\n    iterateCallback = (..._arg: any[]) => {}\n  } = {}) {\n    super();\n    this.update = this.defilter.bind(this, updateCallback);\n    this.animate = this.iterate.bind(this, iterateCallback);\n  }\n  private defilter(predicate: (arg0: unknown) => boolean): this {\n    let i = this.length;\n    while (i--) if (predicate(this[i])) this.splice(i, 1);\n    return this;\n  }\n  private iterate(callback: (arg0: unknown) => void): void {\n    for (const i of this) callback(i);\n  }\n  public add(value: unknown): void {\n    this[this.length] = value;\n  }\n  public clear(): void {\n    this.length = 0;\n  }\n}\n","export class HitFeedback {\n  public offsetX: number;\n  public offsetY: number;\n  public color: string;\n  public text: string;\n  public time: number;\n  public constructor(offsetX: number, offsetY: number, n1: string, n2: string) {\n    this.offsetX = offsetX;\n    this.offsetY = offsetY;\n    this.color = n1;\n    this.text = n2;\n    this.time = 0;\n  }\n  public static tap(offsetX: number, offsetY: number): HitFeedback {\n    // console.log('Tap', offsetX, offsetY);\n    return new HitFeedback(offsetX, offsetY, 'cyan', '');\n  }\n  public static hold(offsetX: number, offsetY: number): HitFeedback {\n    // console.log('Hold', offsetX, offsetY);\n    return new HitFeedback(offsetX, offsetY, 'lime', '');\n  }\n  public static move(offsetX: number, offsetY: number): HitFeedback {\n    // console.log('Move', offsetX, offsetY);\n    return new HitFeedback(offsetX, offsetY, 'violet', '');\n  }\n}\n","import type { NoteExtends } from 'src/core';\nimport { noteRender } from '../index';\nimport type { ScaledNote } from './ScaledNote';\nexport class HitImage {\n  public offsetX: number;\n  public offsetY: number;\n  public time: number;\n  public duration: number;\n  public effects: ScaledNote[];\n  public direction: number[][];\n  public color: string;\n  public constructor(offsetX: number, offsetY: number, n1: string, n3: string) {\n    const packs = noteRender.hitFX[n1];\n    this.offsetX = offsetX || 0;\n    this.offsetY = offsetY || 0;\n    this.time = performance.now();\n    this.duration = packs.duration;\n    this.effects = packs.effects;\n    this.direction = Array(packs.numOfParts || 0).fill(0).map(() => [Math.random() * 80 + 185, Math.random() * 2 * Math.PI]);\n    this.color = n3;\n  }\n  public static perfect(offsetX: number, offsetY: number, _note: NoteExtends): HitImage {\n    // console.log(note);\n    return new HitImage(offsetX, offsetY, 'Perfect', '#ffeca0');\n  }\n  public static good(offsetX: number, offsetY: number, _note: NoteExtends): HitImage {\n    // console.log(note);\n    return new HitImage(offsetX, offsetY, 'Good', '#b4e1ff');\n  }\n}\n","export class HitWord {\n  public offsetX: number;\n  public offsetY: number;\n  public time: number;\n  public duration: number;\n  public color: string;\n  public text: string;\n  public constructor(offsetX: number, offsetY: number, n1: string, n2: string) {\n    this.offsetX = offsetX || 0;\n    this.offsetY = offsetY || 0;\n    this.time = performance.now();\n    this.duration = 250;\n    this.color = n1;\n    this.text = n2;\n  }\n  public static early(offsetX: number, offsetY: number): HitWord {\n    // console.log('Tap', offsetX, offsetY);\n    return new HitWord(offsetX, offsetY, '#03aaf9', 'Early');\n  }\n  public static late(offsetX: number, offsetY: number): HitWord {\n    // console.log('Hold', offsetX, offsetY);\n    return new HitWord(offsetX, offsetY, '#ff4612', 'Late');\n  }\n}\n","export class ScaledNote {\n  public full: (ctx: CanvasRenderingContext2D) => void;\n  public head: (ctx: CanvasRenderingContext2D) => void;\n  public body: (ctx: CanvasRenderingContext2D, offset: number, length: number) => void;\n  public tail: (ctx: CanvasRenderingContext2D, offset: number) => void;\n  // private readonly img: ImageBitmap;\n  // private readonly scale: number;\n  public constructor(img: ImageBitmap, scale: number, compacted = false) {\n    // this.img = img;\n    // this.scale = scale;\n    const dx = -img.width / 2 * scale;\n    const dy = -img.height / 2 * scale;\n    const dw = img.width * scale;\n    const dh = img.height * scale;\n    this.full = ctx => ctx.drawImage(img, dx, dy, dw, dh);\n    this.head = ctx => ctx.drawImage(img, dx, 0, dw, dh);\n    this.body = (ctx, offset, length) => ctx.drawImage(img, dx, offset, dw, length);\n    this.tail = (ctx, offset) => ctx.drawImage(img, dx, offset - dh, dw, dh);\n    if (compacted) {\n      this.head = ctx => ctx.drawImage(img, dx, dy, dw, dh);\n      this.tail = (ctx, offset) => ctx.drawImage(img, dx, offset - dh - dy, dw, dh);\n    }\n  }\n}\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\n/* eslint-disable no-bitwise -- used for calculations */\n\n/* eslint-disable unicorn/prefer-query-selector -- aiming at\n  backward-compatibility */\n\n/**\n* StackBlur - a fast almost Gaussian Blur For Canvas\n*\n* In case you find this class useful - especially in commercial projects -\n* I am not totally unhappy for a small donation to my PayPal account\n* mario@quasimondo.de\n*\n* Or support me on flattr:\n* {@link https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript}.\n*\n* @module StackBlur\n* @author Mario Klingemann\n* Contact: mario@quasimondo.com\n* Website: {@link http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html}\n* Twitter: @quasimondo\n*\n* @copyright (c) 2010 Mario Klingemann\n*\n* Permission is hereby granted, free of charge, to any person\n* obtaining a copy of this software and associated documentation\n* files (the \"Software\"), to deal in the Software without\n* restriction, including without limitation the rights to use,\n* copy, modify, merge, publish, distribute, sublicense, and/or sell\n* copies of the Software, and to permit persons to whom the\n* Software is furnished to do so, subject to the following\n* conditions:\n*\n* The above copyright notice and this permission notice shall be\n* included in all copies or substantial portions of the Software.\n*\n* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n* OTHER DEALINGS IN THE SOFTWARE.\n*/\nvar mulTable = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];\nvar shgTable = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];\n/**\n * @param {string|HTMLImageElement} img\n * @param {string|HTMLCanvasElement} canvas\n * @param {Float} radius\n * @param {boolean} blurAlphaChannel\n * @param {boolean} useOffset\n * @param {boolean} skipStyles\n * @returns {undefined}\n */\n\nfunction processImage(img, canvas, radius, blurAlphaChannel, useOffset, skipStyles) {\n  if (typeof img === 'string') {\n    img = document.getElementById(img);\n  }\n\n  if (!img || !('naturalWidth' in img)) {\n    return;\n  }\n\n  var dimensionType = useOffset ? 'offset' : 'natural';\n  var w = img[dimensionType + 'Width'];\n  var h = img[dimensionType + 'Height'];\n\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas || !('getContext' in canvas)) {\n    return;\n  }\n\n  if (!skipStyles) {\n    canvas.style.width = w + 'px';\n    canvas.style.height = h + 'px';\n  }\n\n  canvas.width = w;\n  canvas.height = h;\n  var context = canvas.getContext('2d');\n  context.clearRect(0, 0, w, h);\n  context.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight, 0, 0, w, h);\n\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  if (blurAlphaChannel) {\n    processCanvasRGBA(canvas, 0, 0, w, h, radius);\n  } else {\n    processCanvasRGB(canvas, 0, 0, w, h, radius);\n  }\n}\n/**\n * @param {string|HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @throws {Error|TypeError}\n * @returns {ImageData} See {@link https://html.spec.whatwg.org/multipage/canvas.html#imagedata}\n */\n\n\nfunction getImageDataFromCanvas(canvas, topX, topY, width, height) {\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas || _typeof(canvas) !== 'object' || !('getContext' in canvas)) {\n    throw new TypeError('Expecting canvas with `getContext` method ' + 'in processCanvasRGB(A) calls!');\n  }\n\n  var context = canvas.getContext('2d');\n\n  try {\n    return context.getImageData(topX, topY, width, height);\n  } catch (e) {\n    throw new Error('unable to access image data: ' + e);\n  }\n}\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {undefined}\n */\n\n\nfunction processCanvasRGBA(canvas, topX, topY, width, height, radius) {\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  radius |= 0;\n  var imageData = getImageDataFromCanvas(canvas, topX, topY, width, height);\n  imageData = processImageDataRGBA(imageData, topX, topY, width, height, radius);\n  canvas.getContext('2d').putImageData(imageData, topX, topY);\n}\n/**\n * @param {ImageData} imageData\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {ImageData}\n */\n\n\nfunction processImageDataRGBA(imageData, topX, topY, width, height, radius) {\n  var pixels = imageData.data;\n  var div = 2 * radius + 1; // const w4 = width << 2;\n\n  var widthMinus1 = width - 1;\n  var heightMinus1 = height - 1;\n  var radiusPlus1 = radius + 1;\n  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n  var stackStart = new BlurStack();\n  var stack = stackStart;\n  var stackEnd;\n\n  for (var i = 1; i < div; i++) {\n    stack = stack.next = new BlurStack();\n\n    if (i === radiusPlus1) {\n      stackEnd = stack;\n    }\n  }\n\n  stack.next = stackStart;\n  var stackIn = null,\n      stackOut = null,\n      yw = 0,\n      yi = 0;\n  var mulSum = mulTable[radius];\n  var shgSum = shgTable[radius];\n\n  for (var y = 0; y < height; y++) {\n    stack = stackStart;\n    var pr = pixels[yi],\n        pg = pixels[yi + 1],\n        pb = pixels[yi + 2],\n        pa = pixels[yi + 3];\n\n    for (var _i = 0; _i < radiusPlus1; _i++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack.a = pa;\n      stack = stack.next;\n    }\n\n    var rInSum = 0,\n        gInSum = 0,\n        bInSum = 0,\n        aInSum = 0,\n        rOutSum = radiusPlus1 * pr,\n        gOutSum = radiusPlus1 * pg,\n        bOutSum = radiusPlus1 * pb,\n        aOutSum = radiusPlus1 * pa,\n        rSum = sumFactor * pr,\n        gSum = sumFactor * pg,\n        bSum = sumFactor * pb,\n        aSum = sumFactor * pa;\n\n    for (var _i2 = 1; _i2 < radiusPlus1; _i2++) {\n      var p = yi + ((widthMinus1 < _i2 ? widthMinus1 : _i2) << 2);\n      var r = pixels[p],\n          g = pixels[p + 1],\n          b = pixels[p + 2],\n          a = pixels[p + 3];\n      var rbs = radiusPlus1 - _i2;\n      rSum += (stack.r = r) * rbs;\n      gSum += (stack.g = g) * rbs;\n      bSum += (stack.b = b) * rbs;\n      aSum += (stack.a = a) * rbs;\n      rInSum += r;\n      gInSum += g;\n      bInSum += b;\n      aInSum += a;\n      stack = stack.next;\n    }\n\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var x = 0; x < width; x++) {\n      var paInitial = aSum * mulSum >> shgSum;\n      pixels[yi + 3] = paInitial;\n\n      if (paInitial !== 0) {\n        var _a2 = 255 / paInitial;\n\n        pixels[yi] = (rSum * mulSum >> shgSum) * _a2;\n        pixels[yi + 1] = (gSum * mulSum >> shgSum) * _a2;\n        pixels[yi + 2] = (bSum * mulSum >> shgSum) * _a2;\n      } else {\n        pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;\n      }\n\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      aSum -= aOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      aOutSum -= stackIn.a;\n\n      var _p = x + radius + 1;\n\n      _p = yw + (_p < widthMinus1 ? _p : widthMinus1) << 2;\n      rInSum += stackIn.r = pixels[_p];\n      gInSum += stackIn.g = pixels[_p + 1];\n      bInSum += stackIn.b = pixels[_p + 2];\n      aInSum += stackIn.a = pixels[_p + 3];\n      rSum += rInSum;\n      gSum += gInSum;\n      bSum += bInSum;\n      aSum += aInSum;\n      stackIn = stackIn.next;\n      var _stackOut = stackOut,\n          _r = _stackOut.r,\n          _g = _stackOut.g,\n          _b = _stackOut.b,\n          _a = _stackOut.a;\n      rOutSum += _r;\n      gOutSum += _g;\n      bOutSum += _b;\n      aOutSum += _a;\n      rInSum -= _r;\n      gInSum -= _g;\n      bInSum -= _b;\n      aInSum -= _a;\n      stackOut = stackOut.next;\n      yi += 4;\n    }\n\n    yw += width;\n  }\n\n  for (var _x = 0; _x < width; _x++) {\n    yi = _x << 2;\n\n    var _pr = pixels[yi],\n        _pg = pixels[yi + 1],\n        _pb = pixels[yi + 2],\n        _pa = pixels[yi + 3],\n        _rOutSum = radiusPlus1 * _pr,\n        _gOutSum = radiusPlus1 * _pg,\n        _bOutSum = radiusPlus1 * _pb,\n        _aOutSum = radiusPlus1 * _pa,\n        _rSum = sumFactor * _pr,\n        _gSum = sumFactor * _pg,\n        _bSum = sumFactor * _pb,\n        _aSum = sumFactor * _pa;\n\n    stack = stackStart;\n\n    for (var _i3 = 0; _i3 < radiusPlus1; _i3++) {\n      stack.r = _pr;\n      stack.g = _pg;\n      stack.b = _pb;\n      stack.a = _pa;\n      stack = stack.next;\n    }\n\n    var yp = width;\n    var _gInSum = 0,\n        _bInSum = 0,\n        _aInSum = 0,\n        _rInSum = 0;\n\n    for (var _i4 = 1; _i4 <= radius; _i4++) {\n      yi = yp + _x << 2;\n\n      var _rbs = radiusPlus1 - _i4;\n\n      _rSum += (stack.r = _pr = pixels[yi]) * _rbs;\n      _gSum += (stack.g = _pg = pixels[yi + 1]) * _rbs;\n      _bSum += (stack.b = _pb = pixels[yi + 2]) * _rbs;\n      _aSum += (stack.a = _pa = pixels[yi + 3]) * _rbs;\n      _rInSum += _pr;\n      _gInSum += _pg;\n      _bInSum += _pb;\n      _aInSum += _pa;\n      stack = stack.next;\n\n      if (_i4 < heightMinus1) {\n        yp += width;\n      }\n    }\n\n    yi = _x;\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var _y = 0; _y < height; _y++) {\n      var _p2 = yi << 2;\n\n      pixels[_p2 + 3] = _pa = _aSum * mulSum >> shgSum;\n\n      if (_pa > 0) {\n        _pa = 255 / _pa;\n        pixels[_p2] = (_rSum * mulSum >> shgSum) * _pa;\n        pixels[_p2 + 1] = (_gSum * mulSum >> shgSum) * _pa;\n        pixels[_p2 + 2] = (_bSum * mulSum >> shgSum) * _pa;\n      } else {\n        pixels[_p2] = pixels[_p2 + 1] = pixels[_p2 + 2] = 0;\n      }\n\n      _rSum -= _rOutSum;\n      _gSum -= _gOutSum;\n      _bSum -= _bOutSum;\n      _aSum -= _aOutSum;\n      _rOutSum -= stackIn.r;\n      _gOutSum -= stackIn.g;\n      _bOutSum -= stackIn.b;\n      _aOutSum -= stackIn.a;\n      _p2 = _x + ((_p2 = _y + radiusPlus1) < heightMinus1 ? _p2 : heightMinus1) * width << 2;\n      _rSum += _rInSum += stackIn.r = pixels[_p2];\n      _gSum += _gInSum += stackIn.g = pixels[_p2 + 1];\n      _bSum += _bInSum += stackIn.b = pixels[_p2 + 2];\n      _aSum += _aInSum += stackIn.a = pixels[_p2 + 3];\n      stackIn = stackIn.next;\n      _rOutSum += _pr = stackOut.r;\n      _gOutSum += _pg = stackOut.g;\n      _bOutSum += _pb = stackOut.b;\n      _aOutSum += _pa = stackOut.a;\n      _rInSum -= _pr;\n      _gInSum -= _pg;\n      _bInSum -= _pb;\n      _aInSum -= _pa;\n      stackOut = stackOut.next;\n      yi += width;\n    }\n  }\n\n  return imageData;\n}\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {undefined}\n */\n\n\nfunction processCanvasRGB(canvas, topX, topY, width, height, radius) {\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  radius |= 0;\n  var imageData = getImageDataFromCanvas(canvas, topX, topY, width, height);\n  imageData = processImageDataRGB(imageData, topX, topY, width, height, radius);\n  canvas.getContext('2d').putImageData(imageData, topX, topY);\n}\n/**\n * @param {ImageData} imageData\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {ImageData}\n */\n\n\nfunction processImageDataRGB(imageData, topX, topY, width, height, radius) {\n  var pixels = imageData.data;\n  var div = 2 * radius + 1; // const w4 = width << 2;\n\n  var widthMinus1 = width - 1;\n  var heightMinus1 = height - 1;\n  var radiusPlus1 = radius + 1;\n  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n  var stackStart = new BlurStack();\n  var stack = stackStart;\n  var stackEnd;\n\n  for (var i = 1; i < div; i++) {\n    stack = stack.next = new BlurStack();\n\n    if (i === radiusPlus1) {\n      stackEnd = stack;\n    }\n  }\n\n  stack.next = stackStart;\n  var stackIn = null;\n  var stackOut = null;\n  var mulSum = mulTable[radius];\n  var shgSum = shgTable[radius];\n  var p, rbs;\n  var yw = 0,\n      yi = 0;\n\n  for (var y = 0; y < height; y++) {\n    var pr = pixels[yi],\n        pg = pixels[yi + 1],\n        pb = pixels[yi + 2],\n        rOutSum = radiusPlus1 * pr,\n        gOutSum = radiusPlus1 * pg,\n        bOutSum = radiusPlus1 * pb,\n        rSum = sumFactor * pr,\n        gSum = sumFactor * pg,\n        bSum = sumFactor * pb;\n    stack = stackStart;\n\n    for (var _i5 = 0; _i5 < radiusPlus1; _i5++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack = stack.next;\n    }\n\n    var rInSum = 0,\n        gInSum = 0,\n        bInSum = 0;\n\n    for (var _i6 = 1; _i6 < radiusPlus1; _i6++) {\n      p = yi + ((widthMinus1 < _i6 ? widthMinus1 : _i6) << 2);\n      rSum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - _i6);\n      gSum += (stack.g = pg = pixels[p + 1]) * rbs;\n      bSum += (stack.b = pb = pixels[p + 2]) * rbs;\n      rInSum += pr;\n      gInSum += pg;\n      bInSum += pb;\n      stack = stack.next;\n    }\n\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var x = 0; x < width; x++) {\n      pixels[yi] = rSum * mulSum >> shgSum;\n      pixels[yi + 1] = gSum * mulSum >> shgSum;\n      pixels[yi + 2] = bSum * mulSum >> shgSum;\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      p = yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1) << 2;\n      rInSum += stackIn.r = pixels[p];\n      gInSum += stackIn.g = pixels[p + 1];\n      bInSum += stackIn.b = pixels[p + 2];\n      rSum += rInSum;\n      gSum += gInSum;\n      bSum += bInSum;\n      stackIn = stackIn.next;\n      rOutSum += pr = stackOut.r;\n      gOutSum += pg = stackOut.g;\n      bOutSum += pb = stackOut.b;\n      rInSum -= pr;\n      gInSum -= pg;\n      bInSum -= pb;\n      stackOut = stackOut.next;\n      yi += 4;\n    }\n\n    yw += width;\n  }\n\n  for (var _x2 = 0; _x2 < width; _x2++) {\n    yi = _x2 << 2;\n\n    var _pr2 = pixels[yi],\n        _pg2 = pixels[yi + 1],\n        _pb2 = pixels[yi + 2],\n        _rOutSum2 = radiusPlus1 * _pr2,\n        _gOutSum2 = radiusPlus1 * _pg2,\n        _bOutSum2 = radiusPlus1 * _pb2,\n        _rSum2 = sumFactor * _pr2,\n        _gSum2 = sumFactor * _pg2,\n        _bSum2 = sumFactor * _pb2;\n\n    stack = stackStart;\n\n    for (var _i7 = 0; _i7 < radiusPlus1; _i7++) {\n      stack.r = _pr2;\n      stack.g = _pg2;\n      stack.b = _pb2;\n      stack = stack.next;\n    }\n\n    var _rInSum2 = 0,\n        _gInSum2 = 0,\n        _bInSum2 = 0;\n\n    for (var _i8 = 1, yp = width; _i8 <= radius; _i8++) {\n      yi = yp + _x2 << 2;\n      _rSum2 += (stack.r = _pr2 = pixels[yi]) * (rbs = radiusPlus1 - _i8);\n      _gSum2 += (stack.g = _pg2 = pixels[yi + 1]) * rbs;\n      _bSum2 += (stack.b = _pb2 = pixels[yi + 2]) * rbs;\n      _rInSum2 += _pr2;\n      _gInSum2 += _pg2;\n      _bInSum2 += _pb2;\n      stack = stack.next;\n\n      if (_i8 < heightMinus1) {\n        yp += width;\n      }\n    }\n\n    yi = _x2;\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (var _y2 = 0; _y2 < height; _y2++) {\n      p = yi << 2;\n      pixels[p] = _rSum2 * mulSum >> shgSum;\n      pixels[p + 1] = _gSum2 * mulSum >> shgSum;\n      pixels[p + 2] = _bSum2 * mulSum >> shgSum;\n      _rSum2 -= _rOutSum2;\n      _gSum2 -= _gOutSum2;\n      _bSum2 -= _bOutSum2;\n      _rOutSum2 -= stackIn.r;\n      _gOutSum2 -= stackIn.g;\n      _bOutSum2 -= stackIn.b;\n      p = _x2 + ((p = _y2 + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width << 2;\n      _rSum2 += _rInSum2 += stackIn.r = pixels[p];\n      _gSum2 += _gInSum2 += stackIn.g = pixels[p + 1];\n      _bSum2 += _bInSum2 += stackIn.b = pixels[p + 2];\n      stackIn = stackIn.next;\n      _rOutSum2 += _pr2 = stackOut.r;\n      _gOutSum2 += _pg2 = stackOut.g;\n      _bOutSum2 += _pb2 = stackOut.b;\n      _rInSum2 -= _pr2;\n      _gInSum2 -= _pg2;\n      _bInSum2 -= _pb2;\n      stackOut = stackOut.next;\n      yi += width;\n    }\n  }\n\n  return imageData;\n}\n/**\n *\n */\n\n\nvar BlurStack =\n/**\n * Set properties.\n */\nfunction BlurStack() {\n  _classCallCheck(this, BlurStack);\n\n  this.r = 0;\n  this.g = 0;\n  this.b = 0;\n  this.a = 0;\n  this.next = null;\n};\n\nexport { BlurStack, processCanvasRGB as canvasRGB, processCanvasRGBA as canvasRGBA, processImage as image, processImageDataRGB as imageDataRGB, processImageDataRGBA as imageDataRGBA };\n","import createCtx from './createCtx';\n// 十六进制color转rgba数组\nexport function hex2rgba(color: string): Uint8ClampedArray {\n  const ctx = createCtx(1, 1);\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.getImageData(0, 0, 1, 1).data;\n}\n","import createCtx from './createCtx';\nimport { hex2rgba } from './hex2rgba';\nexport async function imgShader(img: ImageBitmap, color: string, limit = 512): Promise<ImageBitmap> {\n  const dataRGBA = hex2rgba(color);\n  const ctx = createCtx(img.width, img.height, { willReadFrequently: true }); // warning\n  ctx.drawImage(img, 0, 0);\n  for (let dy = 0; dy < img.height; dy += limit) {\n    for (let dx = 0; dx < img.width; dx += limit) {\n      const imgData = ctx.getImageData(dx, dy, limit, limit);\n      for (let i = 0; i < imgData.data.length / 4; i++) {\n        imgData.data[i * 4] *= dataRGBA[0] / 255;\n        imgData.data[i * 4 + 1] *= dataRGBA[1] / 255;\n        imgData.data[i * 4 + 2] *= dataRGBA[2] / 255;\n        imgData.data[i * 4 + 3] *= dataRGBA[3] / 255;\n      }\n      ctx.putImageData(imgData, dx, dy);\n    }\n  }\n  return createImageBitmap(ctx.canvas);\n}\n","export async function imgSplit(img: ImageBitmap, limitX?: number, limitY?: number): Promise<ImageBitmap[]> {\n  const dx = Math.floor(limitX ?? Math.min(img.width, img.height));\n  const dy = Math.floor(limitY ?? dx);\n  const arr = [];\n  for (let sy = 0; sy < img.height; sy += dy) {\n    for (let sx = 0; sx < img.width; sx += dx) {\n      arr.push(createImageBitmap(img, sx, sy, dx, dy));\n    }\n  }\n  return Promise.all(arr);\n}\n","import { getConstructorName, isUndefined, loadJS, orientation } from '../js/common.js';\nimport { audio } from '../external';\nexport async function checkSupport({\n  messageCallback = (_msg: string) => {},\n  warnCallback = (_msg: string) => {},\n  errorCallback = (_msg: string, _html: string, _fatal?: boolean) => {},\n  mobileCallback = () => {},\n  orientNotSupportCallback = () => {}\n} = {}): Promise<number> {\n  const sysError = (error: unknown, message?: string) => {\n    const type = getConstructorName(error) as string;\n    // if (message==='Script error.') return;\n    let message2 = String(error);\n    let detail = String(error);\n    if (error instanceof Error) {\n      const stack = error.stack ?? 'Stack not available';\n      if (error.name === type) message2 = error.message;\n      else message2 = `${error.name}: ${error.message}`;\n      const idx = stack.indexOf(message2) + 1;\n      if (idx) detail = `${message2}\\n${stack.slice(idx + message2.length)}`;\n      else detail = `${message2}\\n    ${stack.split('\\n').join('\\n    ')}`; // Safari\n    }\n    if (message != null) message2 = message;\n    const errMessage = `[${type}] ${message2.split('\\n')[0]}`;\n    const errDetail = `[${type}] ${detail}`;\n    errorCallback(errMessage, Utils.escapeHTML(errDetail));\n  };\n  self.addEventListener('error', e => sysError(e.error, e.message));\n  self.addEventListener('unhandledrejection', e => sysError(e.reason));\n  const loadLib = async(name: string, urls: string[] | string, check: () => boolean) => {\n    if (!check()) return true;\n    const errmsg1 = `错误：${name}组件加载失败（点击查看详情）`;\n    const errmsg2 = `${name}组件加载失败，请检查您的网络连接然后重试：`;\n    const errmsg3 = `${name}组件加载失败，请检查浏览器兼容性`;\n    const errCatch = (e: Error) => errorCallback(errmsg1, e.message.replace(/.+/, errmsg2), true);\n    messageCallback(`加载${name}组件...`);\n    await loadJS(urls).catch(errCatch);\n    if (!check()) return true;\n    errorCallback(errmsg1, errmsg3, true);\n    return false;\n  };\n  await Utils.addFont('Titillium Web', { alt: 'Custom' });\n  // 兼容性检测\n  messageCallback('检查浏览器兼容性...');\n  const isMobile = navigator.standalone !== undefined || navigator.platform.includes('Linux') && navigator.maxTouchPoints === 5;\n  if (isMobile) mobileCallback();\n  checkMiuiVersion(warnCallback);\n  if (!await loadLib('ImageBitmap兼容', '/lib/createImageBitmap.js', () => isUndefined('createImageBitmap'))) return -1;\n  messageCallback('加载声音组件...');\n  const oggCompatible = new Audio().canPlayType('audio/ogg') !== '';\n  if (!await loadLib('ogg格式兼容', '/lib/oggmented-bundle.js', () => !oggCompatible && isUndefined('oggmented'))) return -4;\n  audio.init(oggCompatible ? self.AudioContext : self.oggmented.OggmentedAudioContext); // 兼容Safari\n  const webpCompatible = document.createElement('canvas').toDataURL('image/webp').includes('data:image/webp');\n  if (!await loadLib('webp格式兼容', '/lib/webp-bundle.js', () => !webpCompatible && isUndefined('webp'))) return -5;\n  await checkOrient(orientNotSupportCallback);\n  return 0;\n}\nfunction checkMiuiVersion(warnCallback: (_msg: string) => void) {\n  if (navigator.userAgent.includes('MiuiBrowser')) {\n    // 实测 v17.1.8 问题仍然存在，v17.4.80113 问题已修复\n    const miuiVersion = /MiuiBrowser\\/(\\d+\\.\\d+)/.exec(navigator.userAgent);\n    const text = '检测到小米浏览器且版本低于17.4，可能存在切后台声音消失的问题';\n    if (miuiVersion == null || parseFloat(miuiVersion[1]) < 17.4) warnCallback(text);\n  }\n}\nasync function checkOrient(orientNotSupportCallback: () => void) {\n  const orientSupported = await orientation.checkSupport();\n  if (!orientSupported) orientNotSupportCallback();\n}\n","interface Size {\n  width: number;\n  height: number;\n}\n// 调节画面尺寸和全屏相关(返回source播放aegleseeker会出现迷之error)\nexport function adjustSize(source: Size, dest: Size, scale: number): [number, number, number, number] {\n  const { width: sw, height: sh } = source;\n  const { width: dw, height: dh } = dest;\n  if (dw * sh > dh * sw) return [dw * (1 - scale) / 2, (dh - dw * sh / sw * scale) / 2, dw * scale, dw * sh / sw * scale];\n  return [(dw - dh * sw / sh * scale) / 2, dh * (1 - scale) / 2, dh * sw / sh * scale, dh * scale];\n}\n","import './style.css';\nimport { lastupdate, pubdate, version } from '../scripts/meta.json';\nimport { full, orientation } from './js/common.js';\nimport { FrameAnimater } from './components/FrameAnimater';\nimport { FrameTimer } from './components/FrameTimer';\nimport { Timer } from './components/Timer';\nimport { FileEmitter, ZipReader, fileReader } from './utils/reader';\nimport { type JudgeLineExtends, type NoteExtends, Renderer } from './core';\nimport { HitManager, JudgeEvent } from './components/HitManager';\nimport { Stat } from './components/Stat';\nimport { InteractProxy, audio } from './external';\nimport createCtx from './utils/createCtx';\nimport { decode, decodeAlt } from './utils/imgAny';\nimport { Checkbox, HitEvents, HitFeedback, HitImage, HitWord, ScaledNote, StatusManager } from './components';\nimport { imgBlur } from './utils/imgBlur';\nimport { imgShader } from './utils/imgShader';\nimport { imgPainter } from './utils/imgPainter';\nimport { imgSplit } from './utils/imgSplit';\nimport { Stage } from './components/Stage';\nimport { checkSupport } from './utils/checkSupport';\nimport { adjustSize } from './utils/adjustSize';\nimport { fixme } from './utils/fixme';\nself._i = ['Phixos', version.split('.'), pubdate, lastupdate];\nconst $id = (query: string): HTMLElement => document.getElementById(query) || (() => { throw new Error(`Cannot find element: ${query}`) })();\nconst $ = (query: string) => document.body.querySelector(query);\nconst $$ = (query: string) => document.body.querySelectorAll(query);\n// const viewRsmg = $id('view-rsmg') as HTMLDivElement;\nconst viewNav = $id('view-nav') as HTMLDivElement;\nconst viewCfg = $id('view-cfg') as HTMLDivElement;\nconst viewMsg = $id('view-msg') as HTMLDivElement;\nconst coverDark = $id('cover-dark') as HTMLDivElement;\nconst coverRsmg = $id('cover-rsmg') as HTMLDivElement;\nconst coverView = $id('cover-view') as HTMLDivElement;\nconst buttonRsmg = $id('btn-rsmg') as HTMLInputElement;\nconst buttonDocs = $id('btn-docs') as HTMLInputElement;\nconst buttonMore = $id('btn-more') as HTMLInputElement;\nconst anchorCfg = $id('nav-cfg') as HTMLAnchorElement;\nconst anchorMsg = $id('nav-msg') as HTMLAnchorElement;\nconst strongOut = $id('msg-out');\nconst blockUploader = $id('uploader') as HTMLDivElement;\nconst stageEl = $id('stage') as HTMLDivElement;\nconst selectNoteScale = $id('select-note-scale') as HTMLSelectElement;\nconst selectAspectRatio = $id('select-aspect-ratio') as HTMLSelectElement;\nconst selectBackgroundDim = $id('select-background-dim') as HTMLSelectElement;\nconst checkHighLight = $id('highLight') as HTMLInputElement;\nconst inputOffset = $id('input-offset') as HTMLInputElement;\nconst lineColor = $id('lineColor') as HTMLInputElement;\nconst checkAutoPlay = $id('autoplay') as HTMLInputElement;\nconst showTransition = $id('showTransition') as HTMLInputElement;\nconst checkFeedback = $id('feedback') as HTMLInputElement;\nconst checkImageBlur = $id('imageBlur') as HTMLInputElement;\nconst selectbg = $id('select-bg') as HTMLSelectElement;\nconst btnPlay = $id('btn-play') as HTMLInputElement;\nconst btnPause = $id('btn-pause') as HTMLInputElement;\nconst selectbgm = $id('select-bgm') as HTMLSelectElement;\nconst selectchart = $id('select-chart') as HTMLSelectElement;\nconst selectflip = $id('select-flip') as HTMLSelectElement;\nconst selectspeed = $id('select-speed') as HTMLSelectElement;\nconst inputName = $id('input-name') as HTMLInputElement;\nconst inputArtist = $id('input-artist') as HTMLInputElement;\nconst inputCharter = $id('input-charter') as HTMLInputElement;\nconst inputIllustrator = $id('input-illustrator') as HTMLInputElement;\nconst selectDifficulty = $id('select-difficulty') as HTMLSelectElement;\nconst selectLevel = $id('select-level') as HTMLSelectElement;\nconst selectVolume = $id('select-volume') as HTMLSelectElement;\nconst blockUploaderSelect = $id('uploader-select') as HTMLDivElement;\nconst blockUpload = $id('uploader-upload') as HTMLInputElement;\nconst blockUploadFile = $id('uploader-file') as HTMLLabelElement;\nconst blockUploadDir = $id('uploader-dir') as HTMLLabelElement;\nconst blockSelect = $id('select') as HTMLDivElement;\nconst blockMask = $id('mask') as HTMLDivElement;\nconst tween = {\n  easeInSine: (t: number) => 1 - Math.cos(t * Math.PI / 2),\n  easeOutSine: (t: number) => Math.sin(t * Math.PI / 2),\n  easeOutCubic: (t: number) => 1 + (t - 1) ** 3\n};\nconst time2Str = (time = 0) => `${Math.floor(time / 60)}:${`00${Math.floor(time % 60)}`.slice(-2)}`;\ninterface MainOptions {\n  modify: (chart: Chart) => Chart;\n  pressTime: number;\n  before: Map<string, () => Promise<void> | void>;\n  now: Map<string, (time: number) => void>;\n  after: Map<string, () => void>;\n  customDraw: ((ctx: CanvasRenderingContext2D) => void) | null;\n  filter: ((ctx: CanvasRenderingContext2D, time: number, now: number) => CanvasImageSource) | null;\n  filterOptions: Record<string, unknown>;\n  handleFile: (tag: string, total: number, promise: Promise<unknown>, oncomplete?: () => void) => Promise<unknown>;\n  uploader: typeof uploader;\n  awawa: boolean;\n  fireModal: (navHTML: string, contentHTML: string) => HTMLDivElement;\n  toast: (msg: string) => HTMLDivElement;\n  define: (arg0: ModuleConfig) => ModuleConfig;\n  use: (module: Promise<ModuleBase>) => Promise<unknown>;\n  stat: typeof stat;\n  app: typeof app;\n  res: typeof res;\n  audio: typeof audio;\n  msgHandler: typeof msgHandler;\n  frameAnimater: typeof frameAnimater;\n  timeEnd: typeof timeEnd;\n  bgms: typeof bgms;\n  inputName: typeof inputName;\n  selectbgm: typeof selectbgm;\n  selectchart: typeof selectchart;\n  chartsMD5: typeof chartsMD5;\n  noteRender: typeof noteRender;\n  fileReader: typeof fileReader;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  ZipReader: typeof ZipReader;\n  status: typeof status;\n  tmps: typeof tmps;\n  pause: unknown;\n}\nconst main = {} as MainOptions;\nmain.modify = a => a;\nmain.pressTime = 0;\nmain.before = new Map();\nmain.now = new Map();\nmain.after = new Map();\nmain.filter = null;\nmain.filterOptions = {};\ndocument.oncontextmenu = e => e.preventDefault();\nfor (const i of viewNav.children) {\n  i.addEventListener('click', function(this: HTMLElement) {\n    for (const j of viewNav.children) j.classList.toggle('active', j === this);\n    // if (!viewDoc.src) { viewDoc.src = 'docs/use.html' } // 避免阻塞页面\n    // viewDoc.classList.toggle('hide', this.id !== 'nav-use');\n    viewCfg.classList.toggle('hide', this.id !== 'nav-cfg');\n    viewMsg.classList.toggle('hide', this.id !== 'nav-msg');\n  });\n}\ncoverDark.addEventListener('click', () => {\n  coverDark.classList.add('fade');\n  coverRsmg.classList.add('fade');\n  coverView.classList.add('fade');\n});\nbuttonRsmg.addEventListener('click', () => {\n  coverDark.classList.remove('fade');\n  coverRsmg.classList.remove('fade');\n});\nbuttonDocs.addEventListener('click', () => {\n  main.fireModal('<p>提示</p>', '<p><a href=\"https://docs.lchz\\x68.net/project/sim-phi-core\" target=\"_blank\">点击此处</a>查看使用说明</p>');\n});\nbuttonMore.addEventListener('click', () => {\n  coverDark.classList.remove('fade');\n  coverView.classList.remove('fade');\n  anchorCfg.click();\n});\nstrongOut.addEventListener('click', () => {\n  coverDark.classList.remove('fade');\n  coverView.classList.remove('fade');\n  anchorMsg.click();\n});\nclass BetterMessageBox {\n  public host: string;\n  public code: number;\n  public name: string;\n  public target: string;\n  public list: BetterMessage[];\n  public updateHTML: (...args: any[]) => void;\n  public constructor(msg: BetterMessage) {\n    this.host = msg.host;\n    this.code = msg.code;\n    this.name = msg.name;\n    this.target = msg.target;\n    this.list = [msg];\n    this.updateHTML = () => {};\n  }\n  public appendMessage(msg: BetterMessage) {\n    if (this.host !== msg.host) return false;\n    if (this.code !== msg.code) return false;\n    if (this.name !== msg.name) return false;\n    if (this.target !== msg.target) return false;\n    this.list.push(msg);\n    this.updateHTML();\n    return true;\n  }\n}\nconst msgHandler = {\n  nodeText: strongOut,\n  nodeView: viewMsg,\n  lastMessage: '',\n  betterMessageBoxes: [] as BetterMessageBox[],\n  addBox(type = 'warn') {\n    const msgbox = document.createElement('div');\n    msgbox.setAttribute('type', type);\n    msgbox.classList.add('msgbox');\n    return this.nodeView.appendChild(msgbox);\n  },\n  removeBox(msgbox: HTMLElement) {\n    msgbox.remove();\n    this.updateText(this.lastMessage);\n  },\n  removeBetterMessageBox(msgbox: BetterMessageBox) {\n    const index = this.betterMessageBoxes.indexOf(msgbox);\n    if (index !== -1) this.betterMessageBoxes.splice(index, 1);\n  },\n  msgbox(msg = '', type = '', fatal = false) {\n    const msgbox = this.addBox(type);\n    msgbox.innerHTML = msg;\n    const btn = document.createElement('a');\n    btn.innerText = '忽略';\n    btn.style.float = 'right';\n    btn.onclick = () => this.removeBox(msgbox);\n    btn.classList.toggle('disabled', fatal);\n    msgbox.appendChild(btn);\n  },\n  bmsgbox(msg: BetterMessageBox) {\n    let pageNum = 1;\n    const pageSize = 5;\n    const getPages = () => Math.ceil(msg.list.length / pageSize);\n    const msgbox = this.addBox(['notice', 'warn', 'error'][msg.code]);\n    // 按钮[全部忽略]\n    const btnIgnoreAll = document.createElement('a');\n    btnIgnoreAll.innerText = '全部忽略';\n    btnIgnoreAll.classList.add('bm-rbtn');\n    btnIgnoreAll.onclick = () => {\n      this.removeBetterMessageBox(msg);\n      this.removeBox(msgbox);\n    };\n    // 输入框(页码，自适应宽度+非法值修正)\n    const pageNumNode = document.createElement('span');\n    pageNumNode.textContent = '1';\n    pageNumNode.contentEditable = 'true';\n    pageNumNode.style.cssText = ';color:red;outline:none;text-decoration:underline';\n    const updatePageNum = (num = pageNum) => {\n      if (!isNaN(num)) pageNum = Math.max(1, Math.min(num, getPages()));\n      pageNumNode.textContent = String(pageNum);\n      msg.updateHTML();\n    };\n    pageNumNode.onblur = () => updatePageNum(parseInt(pageNumNode.textContent!));\n    // 总页数\n    const pageTotalNode = document.createElement('span');\n    pageTotalNode.textContent = String(getPages());\n    // 上一页\n    const btnPrevousPage = document.createElement('a');\n    btnPrevousPage.innerText = '上一页';\n    btnPrevousPage.onclick = () => updatePageNum(pageNum - 1);\n    // 下一页\n    const btnNextPage = document.createElement('a');\n    btnNextPage.innerText = '下一页';\n    btnNextPage.onclick = () => updatePageNum(pageNum + 1);\n    // 控制栏\n    const controlNode = document.createElement('div');\n    controlNode.append(pageNumNode, ' / ', pageTotalNode, ' 页 ', btnPrevousPage, ' ', btnNextPage);\n    btnIgnoreAll.setAttribute('bm-ctrl', '');\n    controlNode.setAttribute('bm-ctrl', '');\n    controlNode.classList.add('bm-item');\n    const text = document.createTextNode('');\n    msgbox.append(text, btnIgnoreAll, controlNode);\n    let timer = 0;\n    msg.updateHTML = () => {\n      clearTimeout(timer);\n      timer = self.setTimeout(() => {\n        const pages = getPages();\n        if (pageNum > pages) pageNum = pages;\n        const start = (pageNum - 1) * pageSize;\n        text.textContent = `${msg.code ? `${msg.host}: 检测到${msg.list.length}个${msg.name}\\n` : ''}来自${msg.target}`;\n        pageNumNode.textContent = String(pageNum);\n        pageTotalNode.textContent = String(pages);\n        for (const i of msgbox.querySelectorAll('[bm-ctrl]')) (i as HTMLElement).classList.toggle('hide', pages <= 1);\n        for (const i of msgbox.querySelectorAll('[bm-cell]')) i.remove();\n        for (const i of msg.list.slice(start, start + pageSize)) {\n          const btnIgnore = document.createElement('a');\n          btnIgnore.innerText = '忽略';\n          btnIgnore.classList.add('bm-rbtn');\n          btnIgnore.onclick = () => {\n            msg.list.splice(msg.list.indexOf(i), 1);\n            msg.updateHTML();\n            if (msg.list.length === 0) {\n              this.removeBetterMessageBox(msg);\n              msgbox.remove();\n            }\n            this.updateText(this.lastMessage);\n          };\n          const div = document.createElement('div');\n          div.setAttribute('bm-cell', '');\n          div.classList.add('bm-item');\n          div.append(`${i.name}: ${i.message}`, btnIgnore);\n          msgbox.appendChild(div);\n        }\n      });\n    };\n  },\n  getBetterMessageBox(msg: BetterMessage) {\n    for (const i of this.betterMessageBoxes) {\n      if (i.appendMessage(msg)) return i;\n    }\n    const msgbox = new BetterMessageBox(msg);\n    this.betterMessageBoxes.push(msgbox);\n    this.bmsgbox(msgbox);\n    return msgbox;\n  },\n  updateText(msg = '', type = '') {\n    const num = this.nodeView.querySelectorAll('.msgbox[type=warn]').length + this.betterMessageBoxes.reduce((a, b) => a + b.list.length - 1, 0);\n    if (type === 'error') {\n      this.nodeText.className = 'error';\n      this.nodeText.innerText = msg;\n    } else {\n      this.nodeText.className = num ? 'warning' : 'accept';\n      this.nodeText.innerText = msg + (num ? `（发现${num}个问题，点击查看）` : '');\n      this.lastMessage = msg;\n    }\n  },\n  sendWarning(msg: BetterMessage | string = '', isHTML = '') {\n    if (typeof msg === 'string') {\n      const msgText = isHTML ? msg : Utils.escapeHTML(msg);\n      this.msgbox(msgText, 'warn');\n    } else {\n      const msgbox = this.getBetterMessageBox(msg);\n      msgbox.updateHTML();\n    }\n    this.updateText(this.lastMessage);\n  },\n  sendError(msg = '', html = '', fatal = false) {\n    if (html) {\n      const exp = /([A-Za-z][A-Za-z+-.]{2,}:\\/\\/|www\\.)[^\\s\\x00-\\x20\\x7f-\\x9f\"]{2,}[^\\s\\x00-\\x20\\x7f-\\x9f\"!'),.:;?\\]}]/g;\n      const ahtml = html.replace(exp, (match = '') => {\n        const url = match.startsWith('www.') ? `//${match}` : match;\n        const rpath = match.replace(`${location.origin}/`, '');\n        if (match.includes(location.origin)) return `<a href=\"#\"style=\"color:#023b8f;text-decoration:underline;\">${rpath}</a>`;\n        return `<a href=\"${url}\"target=\"_blank\"style=\"color:#023b8f;text-decoration:underline;\">${rpath}</a>`;\n      });\n      this.msgbox(ahtml, 'error', fatal);\n    }\n    this.updateText(msg, 'error');\n  }\n};\nconst stat = new Stat();\nconst stage = new Stage(stageEl);\nconst app = new Renderer(stageEl); // test\nconst { canvas, ctx, canvasfg, ctxfg } = app;\nself.addEventListener('resize', () => stage.resize());\nclass Emitter extends EventTarget {\n  private status: string;\n  public constructor(statusInit = '') {\n    super();\n    this.status = statusInit;\n  }\n  public emit(status = '') {\n    if (this.status === status) return;\n    this.status = status;\n    this.dispatchEvent(new Event('change'));\n  }\n  public eq(status = '') {\n    return this.status === status;\n  }\n  public ne(status = '') {\n    return this.status !== status;\n  }\n}\nconst emitter = new Emitter('stop');\nconst status2 = {\n  text: '',\n  list: [] as { toString: (target: EventTarget) => void }[],\n  reg(target: EventTarget, type: string, handler: (target: EventTarget) => string) {\n    this.list[this.list.length] = { toString: () => handler(target) };\n    target.addEventListener(type, this.update.bind(this));\n  },\n  update() {\n    const arr = this.list.map(String).filter(Boolean);\n    this.text = arr.length === 0 ? '' : `(${arr.join('+')})`;\n  }\n};\nlet levelText = '';\nconst bgs = new Map() as Map<string, ImageBitmap>;\nconst bgsBlur = new Map() as Map<string, ImageBitmap>;\nconst bgms = new Map() as Map<string, { audio: AudioBuffer; video: HTMLVideoElement | null }>;\nconst charts = new Map() as Map<string, Chart>;\nconst chartsMD5 = new Map() as Map<string, string>;\nconst chartLineData: ChartLineData[] = []; // Line.csv\nconst chartInfoData: ChartInfoData[] = []; // Info.csv\nselectNoteScale.addEventListener('change', evt => { app.setNoteScale(Number((evt.target as HTMLSelectElement).value)) });\nselectAspectRatio.addEventListener('change', evt => { stage.resize(Number((evt.target as HTMLSelectElement).value)) });\nselectBackgroundDim.addEventListener('change', evt => { app.brightness = Number((evt.target as HTMLSelectElement).value) });\ncheckHighLight.addEventListener('change', evt => { app.multiHint = (evt.target as HTMLInputElement).checked });\nconst status = new StatusManager('sim-phi-status').init(data => data.resetCfg);\nstatus.reg('feedback', checkFeedback);\nstatus.reg('imageBlur', checkImageBlur);\nstatus.reg('highLight', checkHighLight);\nstatus.reg('lineColor', lineColor);\nstatus.reg('autoplay', checkAutoPlay);\nstatus.reg('showTransition', showTransition);\nconst resetCfg = new Checkbox('恢复默认设置(刷新生效)').appendTo(viewCfg).hook(status.reg.bind(status, 'resetCfg'));\nconst showCE2 = new Checkbox('Early/Late特效').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'showCE2'));\nconst showPoint = new Checkbox('显示定位点').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'showPoint'));\nconst showAcc = new Checkbox('显示Acc').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'showAcc'));\nconst showStat = new Checkbox('显示统计').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'showStat'));\nconst lowRes = new Checkbox('低分辨率').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'lowRes'));\nconst lockOri = new Checkbox('横屏锁定', true).appendBefore(resetCfg.container).hook(status.reg.bind(status, 'lockOri'));\nconst maxFrame = new Checkbox('限制帧率').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'maxFrame'));\nconst autoDelay = new Checkbox('音画实时同步(若声音卡顿则建议关闭)', true).appendBefore(resetCfg.container).hook(status.reg.bind(status, 'autoDelay'));\nconst enableVP = new Checkbox('隐藏距离较远的音符').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'enableVP'));\nenableVP.checkbox.addEventListener('change', evt => app.enableVP = (evt.target as HTMLInputElement).checked);\nenableVP.checkbox.dispatchEvent(new Event('change'));\nconst enableFR = new Checkbox('使用单精度浮点运算').appendBefore(resetCfg.container).hook(status.reg.bind(status, 'enableFR'));\nenableFR.checkbox.addEventListener('change', evt => app.enableFR = (evt.target as HTMLInputElement).checked);\nenableFR.checkbox.dispatchEvent(new Event('change'));\nselectflip.addEventListener('change', evt => { app.mirrorView(Number((evt.target as HTMLInputElement).value)) });\nstatus.reg('selectFlip', selectflip);\nselectspeed.addEventListener('change', evt => {\n  const dict = { slowest: -9, slower: -4, faster: 3, fastest: 5 } as Record<string, number | undefined>;\n  app.speed = 2 ** ((dict[(evt.target as HTMLInputElement).value.toLowerCase()] ?? 0) / 12);\n});\nstatus.reg('selectSpeed', selectspeed);\n// 自动填写歌曲信息\nfunction adjustInfo() {\n  for (const i of chartInfoData) {\n    if (selectchart.value.trim() === i.Chart) {\n      if (i.Name != null) inputName.value = i.Name;\n      if (i.Musician != null) inputArtist.value = i.Musician; // Alternative\n      if (i.Composer != null) inputArtist.value = i.Composer; // Alternative\n      if (i.Artist != null) inputArtist.value = i.Artist;\n      if (i.Level != null) {\n        levelText = i.Level;\n        const p = levelText.toLocaleUpperCase().split('LV.').map(a => a.trim());\n        if (p[0]) selectDifficulty.value = p[0];\n        if (p[1]) selectLevel.value = p[1];\n      }\n      if (i.Illustrator != null) inputIllustrator.value = i.Illustrator;\n      if (i.Designer != null) inputCharter.value = i.Designer;\n      if (i.Charter != null) inputCharter.value = i.Charter;\n      if (i.Music != null && bgms.has(i.Music)) selectbgm.value = i.Music;\n      if (i.Image != null && bgs.has(i.Image)) {\n        selectbg.value = i.Image;\n        selectbg.dispatchEvent(new Event('change'));\n      }\n      if (i.AspectRatio != null && isFinite(i.AspectRatioValue = parseFloat(i.AspectRatio))) {\n        selectAspectRatio.value = i.AspectRatio;\n        stage.resize(i.AspectRatioValue); // TODO: 期待更好的解决方案\n      }\n      if (i.ScaleRatio != null && isFinite(i.ScaleRatioValue = parseFloat(i.ScaleRatio))) { // Legacy\n        selectNoteScale.value = String(8080 / i.ScaleRatioValue);\n        app.setNoteScale(8080 / i.ScaleRatioValue);\n      }\n      if (i.NoteScale != null && isFinite(i.NoteScaleValue = parseFloat(i.NoteScale))) {\n        selectNoteScale.value = i.NoteScale;\n        app.setNoteScale(i.NoteScaleValue);\n      }\n      if (i.GlobalAlpha != null && isFinite(i.GlobalAlphaValue = parseFloat(i.GlobalAlpha))) { // Legacy\n        selectBackgroundDim.value = i.GlobalAlpha;\n        app.brightness = i.GlobalAlphaValue;\n      }\n      if (i.BackgroundDim != null && isFinite(i.BackgroundDimValue = parseFloat(i.BackgroundDim))) {\n        selectBackgroundDim.value = i.BackgroundDim;\n        app.brightness = i.BackgroundDimValue;\n      }\n      if (i.Offset != null && isFinite(i.OffsetValue = parseFloat(i.Offset))) inputOffset.value = i.Offset;\n    }\n  }\n}\n// Uploader\nconst uploader = new FileEmitter();\n(function() {\n  const dones: Record<string, number> = {};\n  const totals: Record<string, number> = {};\n  let uploaderDone = 0;\n  let uploaderTotal = 0;\n  const handleFile = async(tag: string, total: number, promise: unknown, oncomplete?: () => void) => {\n    totals[tag] = total;\n    uploaderTotal = Object.values(totals).reduce((a, b) => a + b, 0);\n    await (promise instanceof Promise ? promise : Promise.resolve(promise));\n    dones[tag] = (dones[tag] || 0) + 1;\n    uploaderDone = Object.values(dones).reduce((a, b) => a + b, 0);\n    msgHandler.updateText(`读取文件：${uploaderDone}/${uploaderTotal}`);\n    if (dones[tag] === totals[tag] && oncomplete != null) oncomplete();\n    loadComplete();\n  };\n  main.handleFile = handleFile;\n  let fileTotal = 0;\n  const options = { async createAudioBuffer(_: ArrayBuffer) { return audio.decode(_) } };\n  const zip = new ZipReader({ handler: async data => fileReader.readFile(data, options) });\n  zip.addEventListener('loadstart', () => { msgHandler.updateText('加载zip组件...') });\n  zip.addEventListener('read', evt => { handleFile('zip', zip.total, pick((evt as CustomEvent<ReaderData>).detail)) });\n  blockUpload.addEventListener('click', uploader.uploadFile.bind(uploader));\n  blockUploadFile.addEventListener('click', uploader.uploadFile.bind(uploader));\n  blockUploadDir.addEventListener('click', uploader.uploadDir.bind(uploader));\n  uploader.addEventListener('change', loadComplete);\n  uploader.addEventListener('progress', evt => { // 显示加载文件进度\n    if (!(evt as ProgressEvent).total) return;\n    const percent = Math.floor((evt as ProgressEvent).loaded / (evt as ProgressEvent).total * 100);\n    msgHandler.updateText(`加载文件：${percent}% (${bytefm((evt as ProgressEvent).loaded)}/${bytefm((evt as ProgressEvent).total)})`);\n  });\n  uploader.addEventListener('load', evt => {\n    // console.log(evt);\n    const { file: { name, webkitRelativePath: path }, buffer } = evt as ProgressEvent & { file: File; buffer: ArrayBuffer };\n    const isZip = buffer.byteLength > 4 && new DataView(buffer).getUint32(0, false) === 0x504b0304;\n    const data = { name, buffer, path: path || name };\n    const handler = async() => {\n      fileTotal++;\n      const result = await fileReader.readFile(data, options);\n      await handleFile('file', fileTotal, pick(result));\n    };\n    // 检测buffer是否为zip\n    if (isZip) zip.read(data);\n    else handler();\n  });\n  async function pick(data: ReaderData) {\n    console.log(data);\n    switch (data.type) {\n      case 'line':\n        chartLineData.push(...data.data);\n        break;\n      case 'info':\n        chartInfoData.push(...data.data);\n        break;\n      case 'media':\n      case 'audio': {\n        let basename = data.name;\n        while (bgms.has(basename)) basename += '\\n'; // TODO: abstract\n        bgms.set(basename, data.data);\n        selectbgm.appendChild(createOption(basename, data.name));\n        break;\n      }\n      case 'image': {\n        let basename = data.name;\n        while (bgs.has(basename)) basename += '\\n';\n        bgs.set(basename, data.data);\n        bgsBlur.set(basename, await imgBlur(data.data));\n        selectbg.appendChild(createOption(basename, data.name));\n        break;\n      }\n      case 'chart': {\n        if (data.msg) data.msg.forEach(v => msgHandler.sendWarning(v));\n        if (data.info) chartInfoData.push(data.info);\n        if (data.line) chartLineData.push(...data.line);\n        let basename = data.name;\n        while (charts.has(basename)) basename += '\\n';\n        charts.set(basename, data.data);\n        chartsMD5.set(basename, data.md5);\n        selectchart.appendChild(createOption(basename, data.name));\n        break;\n      }\n      default:\n        console.warn(`Unsupported file: ${data.name}`);\n        console.log(data.data);\n        msgHandler.sendWarning(`不支持的文件：${data.name}\\n${data.data as string || 'Error: Unknown File Type'}`);\n    }\n  }\n  function createOption(value: string, innerhtml: string) {\n    const option = document.createElement('option');\n    const isHidden = /(^|\\/)\\./.test(innerhtml);\n    option.innerHTML = isHidden ? '' : innerhtml;\n    option.value = value;\n    if (isHidden) option.classList.add('hide');\n    return option;\n  }\n  function loadComplete() {\n    if (uploaderDone === uploaderTotal) {\n      blockUploader.classList.remove('disabled');\n      adjustInfo();\n    } else blockUploader.classList.add('disabled');\n  }\n}());\nmain.uploader = uploader;\nimport('@/demo/index.js').then(a => a.default());\n// Hit start\nconst hitManager = new HitManager();\nconst exitFull = () => {\n  if (full.onchange) document.removeEventListener(full.onchange, exitFull);\n  hitManager.clear('keyboard'); // Esc退出全屏只有onchange事件能检测到\n  stage.setFull(full.check());\n  stage.resize();\n};\n// TODO: better way to handle this\nconst timeIn = new Timer();\nconst timeOut = new Timer();\nconst timeEnd = new Timer();\nconst specialClick = {\n  time: [0, 0, 0, 0],\n  func: [\n    async() => Promise.resolve().then(atPause),\n    async() => Promise.resolve().then(atStop).then(atStop),\n    async() => Promise.resolve().then(() => showStat.toggle()),\n    async() => {\n      const isFull = stage.getFull();\n      try {\n        await full.toggle();\n        if (!stage.setFull(full.check())) return;\n        if (full.onchange) document.addEventListener(full.onchange, exitFull);\n        if (!lockOri.checked) return;\n        await orientation.lockLandscape();\n      } catch (e) {\n        console.warn(e); // TODO: 未知错误处理\n        stage.setFull(!isFull);\n      } finally {\n        stage.resize();\n      }\n    }\n  ],\n  click(id: number) {\n    const now = performance.now();\n    if (now - this.time[id] < 300) {\n      this.func[id]().catch((err: Error) => {\n        console.warn(err);\n        main.toast(`按太多下了！(${err.message})`); // TODO: 忽略操作\n      });\n    }\n    this.time[id] = now;\n  },\n  activate(offsetX: number, offsetY: number) {\n    const { lineScale } = app;\n    if (offsetX < lineScale * 1.5 && offsetY < lineScale * 1.5) this.click(0);\n    if (offsetX > canvasfg.width - lineScale * 1.5 && offsetY < lineScale * 1.5) this.click(1);\n    if (offsetX < lineScale * 1.5 && offsetY > canvasfg.height - lineScale * 1.5) this.click(2);\n    if (offsetX > canvasfg.width - lineScale * 1.5 && offsetY > canvasfg.height - lineScale * 1.5) this.click(3);\n    if (timeEnd.second > 0) main.pressTime = main.pressTime > 0 ? -timeEnd.second : timeEnd.second;\n  }\n};\nfunction getJudgeOffset(judgeEvent: JudgeEvent, note: NoteExtends) {\n  const { offsetX, offsetY } = judgeEvent;\n  const { offsetX: x, offsetY: y, cosr, sinr } = note;\n  return Math.abs((offsetX - x) * cosr + (offsetY - y) * sinr) || 0;\n}\nfunction getJudgeDistance(judgeEvent: JudgeEvent, note: NoteExtends) {\n  const { offsetX, offsetY } = judgeEvent;\n  const { offsetX: x, offsetY: y, cosr, sinr } = note;\n  return Math.abs((offsetX - x) * cosr + (offsetY - y) * sinr) + Math.abs((offsetX - x) * sinr - (offsetY - y) * cosr) || 0;\n}\nconst res = {} as ResourceMap; // 存放资源\nlet nowTimeMS = 0; // 当前绝对时间(ms)\nlet curTime = 0; // 最近一次暂停的音乐时间(s)\nlet curTimeMS = 0; // 最近一次播放的绝对时间(ms)\nlet timeBgm = 0; // 当前音乐时间(s)\nlet timeChart = 0; // 当前谱面时间(s)\nlet duration0 = 0; // 音乐时长(s)\nlet isInEnd = false; // 开头过渡动画\nlet isOutStart = false; // 结尾过渡动画\nlet isOutEnd = false; // 临时变量\n// 必要组件\nconst frameTimer = new FrameTimer();\nconst frameAnimater = new FrameAnimater();\nframeAnimater.setCallback(mainLoop);\nconst handlerHide = () => { if (document.visibilityState === 'hidden' && emitter.eq('play')) atPause(); };\ndocument.addEventListener('visibilitychange', handlerHide);\ndocument.addEventListener('pagehide', handlerHide); // 兼容Safari\nlet isOutOver = false;\nlet tempStat = null as StatData | null;\nconst tmps = {\n  bgImage: null as unknown as ImageBitmap,\n  bgVideo: null as HTMLVideoElement | null,\n  bgMusicHack: (_: AudioBufferSourceNode): void => {},\n  progress: 0,\n  name: '',\n  artist: '',\n  illustrator: '',\n  charter: '',\n  level: '',\n  combo: '',\n  combo2: '',\n  showStat: false,\n  customForeDraw: null as ((ctx: CanvasRenderingContext2D) => void) | null,\n  customBackDraw: null as ((ctx: CanvasRenderingContext2D) => void) | null\n};\nfunction playBgm(data: AudioBuffer, offset?: number) {\n  curTimeMS = performance.now();\n  tmps.bgMusicHack = audio.play(data, {\n    offset: (offset ?? 0) || 0,\n    playbackrate: app.speed,\n    gainrate: app.musicVolume,\n    interval: autoDelay.checked ? 1 : 0\n  }) as (_: AudioBufferSourceNode) => void;\n}\nasync function playVideo(data: HTMLVideoElement, offset?: number) {\n  data.currentTime = (offset ?? 0) || 0;\n  data.playbackRate = app.speed;\n  data.muted = true;\n  await data.play();\n}\nconst hitImageList = new HitEvents({\n  // 存放点击特效\n  updateCallback: (i: HitImage) => nowTimeMS >= i.time + i.duration,\n  iterateCallback(i: HitImage) {\n    const tick = (nowTimeMS - i.time) / i.duration;\n    const { effects } = i;\n    ctxfg.globalAlpha = 1;\n    ctxfg.setTransform(app.noteScaleRatio * 6, 0, 0, app.noteScaleRatio * 6, i.offsetX, i.offsetY); // 缩放\n    // ctxfg.rotate(i.rotation);\n    (effects[Math.floor(tick * effects.length)] ?? effects[effects.length - 1]).full(ctxfg); // 停留约0.5秒\n    ctxfg.fillStyle = i.color;\n    ctxfg.globalAlpha = 1 - tick; // 不透明度\n    const r3 = 30 * (((0.2078 * tick - 1.6524) * tick + 1.6399) * tick + 0.4988); // 方块大小\n    for (const j of i.direction) {\n      const ds = j[0] * (9 * tick / (8 * tick + 1)); // 打击点距离\n      ctxfg.fillRect(ds * Math.cos(j[1]) - r3 / 2, ds * Math.sin(j[1]) - r3 / 2, r3, r3);\n    }\n  }\n});\nconst hitWordList = new HitEvents({\n  // 存放点击特效\n  updateCallback: (i: HitWord) => nowTimeMS >= i.time + i.duration,\n  iterateCallback(i: HitWord) {\n    const tick = (nowTimeMS - i.time) / i.duration;\n    ctxfg.setTransform(1, 0, 0, 1, i.offsetX, i.offsetY); // 缩放\n    ctxfg.font = `bold ${app.noteScaleRatio * (256 + 128 * (((0.2078 * tick - 1.6524) * tick + 1.6399) * tick + 0.4988))}px Custom,Noto Sans SC`;\n    ctxfg.textAlign = 'center';\n    ctxfg.fillStyle = i.color;\n    ctxfg.globalAlpha = 1 - tick; // 不透明度\n    ctxfg.fillText(i.text, 0, -app.noteScaleRatio * 128);\n  }\n});\nconst judgeManager = {\n  list: [] as JudgeEvent[],\n  addEvent(notes: NoteExtends[], seconds: number) {\n    const { list } = this;\n    list.length = 0;\n    if (app.playMode === 1) {\n      const dispTime = Math.min(frameTimer.disp, 0.04);\n      for (const i of notes) {\n        if (i.scored) continue;\n        const deltaTime = i.seconds - seconds;\n        if (i.type === 1) {\n          if (deltaTime < dispTime) list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 1);\n        } else if (i.type === 2) {\n          if (deltaTime < dispTime) list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 2);\n        } else if (i.type === 3) {\n          if (i.holdTapTime) list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 2);\n          else if (deltaTime < dispTime) list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 1);\n        } else if (i.type === 4) if (deltaTime < dispTime) list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 3);\n      }\n    } else if (emitter.eq('play')) {\n      for (const i of hitManager.list) {\n        if (!i.isTapped) list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 1);\n        if (i.isActive) list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 2);\n        if (i.type === 'keyboard') list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 3); // 以后加上Flick判断\n        if (i.flicking && !i.flicked) list[list.length] = new JudgeEvent(i.offsetX, i.offsetY, 3, i);\n      // i.flicked = true; 不能在这里判断，因为可能会判定不到\n      }\n    }\n  },\n  execute(notes: NoteExtends[], seconds: number, width: number) {\n    const { list } = this;\n    for (const note of notes) {\n      if (note.scored) continue; // 跳过已判分的Note\n      const deltaTime = note.seconds - seconds;\n      if (deltaTime > 0.2) break; // 跳过判定范围外的Note\n      if (note.type !== 1 && deltaTime > 0.16) continue;\n      if (deltaTime < -0.16 && note.frameCount > 4 && !note.holdStatus) {\n        // 超时且不为Hold拖判，判为Miss\n        // console.log('Miss', i.name);\n        note.status = 2;\n        stat.addCombo(2, note.type);\n        note.scored = true;\n      } else if (note.type === 2) {\n        // Drag音符\n        if (deltaTime > 0) {\n          for (const judgeEvent of list) {\n            if (judgeEvent.type !== 1) continue; // 跳过非Tap判定\n            if (getJudgeOffset(judgeEvent, note) > width) continue;\n            judgeEvent.preventBad = true;\n          }\n        }\n        if (note.status !== 4) {\n          for (const judgeEvent of list) {\n            if (judgeEvent.type !== 2) continue; // 跳过非Drag判定\n            if (getJudgeOffset(judgeEvent, note) > width) continue;\n            // console.log('Perfect', i.name);\n            note.status = 4;\n            break;\n          }\n        } else if (deltaTime < 0) {\n          audio.play(res.HitSong1, { gainrate: app.soundVolume });\n          hitImageList.add(HitImage.perfect(note.projectX, note.projectY, note));\n          stat.addCombo(4, 2);\n          note.scored = true;\n        }\n      } else if (note.type === 4) {\n        // Flick音符\n        if (deltaTime > 0 || note.status !== 4) {\n          for (const judgeEvent of list) {\n            if (judgeEvent.type !== 1) continue;\n            // 跳过非Tap判定\n            if (getJudgeOffset(judgeEvent, note) > width) continue;\n            judgeEvent.preventBad = true;\n          }\n        }\n        if (note.status !== 4) {\n          for (const judgeEvent of list) {\n            if (judgeEvent.type !== 3) continue;\n            // 跳过非Move判定\n            if (getJudgeOffset(judgeEvent, note) > width) continue;\n            let distance = getJudgeDistance(judgeEvent, note);\n            let noteJudge = note;\n            let nearcomp = false;\n            for (const nearNote of note.nearNotes) {\n              if (nearNote.status) continue;\n              if (nearNote.seconds - seconds > 0.16) break;\n              if (getJudgeOffset(judgeEvent, nearNote) > width) continue;\n              const nearDistance = getJudgeDistance(judgeEvent, nearNote);\n              if (nearDistance < distance) {\n                distance = nearDistance;\n                noteJudge = nearNote;\n                nearcomp = true;\n              }\n            }\n            // console.log('Perfect', i.name);\n            if (judgeEvent.event == null) {\n              noteJudge.status = 4;\n              if (!nearcomp) break;\n            } else if (!judgeEvent.event.flicked) {\n              noteJudge.status = 4;\n              judgeEvent.event.flicked = true;\n              if (!nearcomp) break;\n            }\n          }\n        } else if (deltaTime < 0) {\n          audio.play(res.HitSong2, { gainrate: app.soundVolume });\n          hitImageList.add(HitImage.perfect(note.projectX, note.projectY, note));\n          stat.addCombo(4, 4);\n          note.scored = true;\n        }\n      } else {\n        // Hold音符\n        if (note.type === 3 && note.holdTapTime) {\n          // 是否触发头判\n          if ((performance.now() - note.holdTapTime) * note.holdTime >= 1.6e4 * note.holdSeconds) {\n            // 间隔时间与bpm成反比\n            if (note.holdStatus % 4 === 0) hitImageList.add(HitImage.perfect(note.projectX, note.projectY, note));\n            else if (note.holdStatus % 4 === 1) hitImageList.add(HitImage.perfect(note.projectX, note.projectY, note));\n            else if (note.holdStatus % 4 === 3) hitImageList.add(HitImage.good(note.projectX, note.projectY, note));\n            note.holdTapTime = performance.now();\n          }\n          if (deltaTime + note.holdSeconds < 0.2) {\n            if (!note.status) stat.addCombo(note.status = note.holdStatus, 3);\n            if (deltaTime + note.holdSeconds < 0) note.scored = true;\n            continue;\n          }\n          note.holdBroken = true; // 若1帧内未按住并使其转为false，则判定为Miss\n        }\n        for (const judgeEvent of list) {\n          if (note.holdTapTime) {\n            // 头判\n            if (judgeEvent.type !== 2) continue;\n            if (getJudgeOffset(judgeEvent, note) <= width) {\n              note.holdBroken = false;\n              break;\n            }\n            continue;\n          }\n          if (judgeEvent.type !== 1) continue;\n          // 跳过非Tap判定\n          if (judgeEvent.judged) continue;\n          // 跳过已触发的判定\n          if (getJudgeOffset(judgeEvent, note) > width) continue;\n          let deltaTime2 = deltaTime;\n          let distance = getJudgeDistance(judgeEvent, note);\n          let noteJudge = note;\n          let nearcomp = false;\n          for (const nearNote of note.nearNotes) {\n            if (nearNote.status) continue;\n            if (nearNote.holdTapTime) continue;\n            const nearDeltaTime = nearNote.seconds - seconds;\n            if (nearDeltaTime > 0.2) break;\n            if (nearNote.type === 3 && nearDeltaTime > 0.16) continue;\n            if (getJudgeOffset(judgeEvent, nearNote) > width) continue;\n            const nearDistance = getJudgeDistance(judgeEvent, nearNote);\n            if (nearDistance < distance) {\n              deltaTime2 = nearDeltaTime;\n              distance = nearDistance;\n              noteJudge = nearNote;\n              nearcomp = true;\n            }\n          }\n          if (deltaTime2 > 0.16) {\n            if (judgeEvent.preventBad) continue;\n            noteJudge.status = 6; // console.log('Bad', i.name);\n            noteJudge.badTime = performance.now();\n          } else {\n            const note1 = noteJudge;\n            stat.addDisp(Math.max(deltaTime2, (-1 - note1.frameCount) * 0.04 || 0));\n            audio.play(res.HitSong0, { gainrate: app.soundVolume });\n            if (deltaTime2 > 0.08) {\n              note1.holdStatus = 7; // console.log('Good(Early)', i.name);\n              hitImageList.add(HitImage.good(note1.projectX, note1.projectY, note1));\n              hitWordList.add(HitWord.early(note1.projectX, note1.projectY));\n            } else if (deltaTime2 > 0.04) {\n              note1.holdStatus = 5; // console.log('Perfect(Early)', i.name);\n              hitImageList.add(HitImage.perfect(note1.projectX, note1.projectY, note1));\n              hitWordList.add(HitWord.early(note1.projectX, note1.projectY));\n            } else if (deltaTime2 > -0.04 || note1.frameCount < 1) {\n              note1.holdStatus = 4; // console.log('Perfect(Max)', i.name);\n              hitImageList.add(HitImage.perfect(note1.projectX, note1.projectY, note1));\n            } else if (deltaTime2 > -0.08 || note1.frameCount < 2) {\n              note1.holdStatus = 1; // console.log('Perfect(Late)', i.name);\n              hitImageList.add(HitImage.perfect(note1.projectX, note1.projectY, note1));\n              hitWordList.add(HitWord.late(note1.projectX, note1.projectY));\n            } else {\n              note1.holdStatus = 3; // console.log('Good(Late)', i.name);\n              hitImageList.add(HitImage.good(note1.projectX, note1.projectY, note1));\n              hitWordList.add(HitWord.late(note1.projectX, note1.projectY));\n            }\n            if (note1.type === 1) note1.status = note1.holdStatus;\n          }\n          if (noteJudge.status) {\n            stat.addCombo(noteJudge.status, 1);\n            noteJudge.scored = true;\n          } else {\n            noteJudge.holdTapTime = performance.now();\n            noteJudge.holdBroken = false;\n          }\n          judgeEvent.judged = true;\n          noteJudge.statOffset = deltaTime2; // TODO: (Replay)也许是统计偏移量？\n          if (!nearcomp) break;\n        }\n        if (emitter.eq('play') && note.holdTapTime && note.holdBroken) {\n          note.status = 2; // console.log('Miss', i.name);\n          stat.addCombo(2, 3);\n          note.scored = true;\n        }\n      }\n    }\n  }\n};\nconst hitFeedbackList = new HitEvents({\n  // 存放点击特效\n  updateCallback: (i: HitFeedback) => i.time++ > 0,\n  iterateCallback(i: HitFeedback) {\n    ctxfg.globalAlpha = 0.85;\n    ctxfg.setTransform(1, 0, 0, 1, i.offsetX, i.offsetY); // 缩放\n    ctxfg.fillStyle = i.color;\n    ctxfg.beginPath();\n    ctxfg.arc(0, 0, app.lineScale * 0.5, 0, 2 * Math.PI);\n    ctxfg.fill();\n  }\n});\nconst interact = new InteractProxy(canvas);\n// 兼容PC鼠标\ninteract.setMouseEvent({\n  mousedownCallback(evt: MouseEvent) {\n    const idx = evt.button;\n    const { x, y } = getPos(evt);\n    if (idx === 1) hitManager.activate('mouse', 4, x, y);\n    else if (idx === 2) hitManager.activate('mouse', 2, x, y);\n    else hitManager.activate('mouse', 1 << idx, x, y);\n    specialClick.activate(x, y);\n  },\n  mousemoveCallback(evt: MouseEvent) {\n    const idx = evt.buttons;\n    const { x, y } = getPos(evt);\n    for (let i = 1; i < 32; i <<= 1) {\n      // 同时按住多个键时，只有最后一个键的move事件会触发\n      if (idx & i) hitManager.moving('mouse', i, x, y);\n      else hitManager.deactivate('mouse', i);\n    }\n  },\n  mouseupCallback(evt: MouseEvent) {\n    const idx = evt.button;\n    if (idx === 1) hitManager.deactivate('mouse', 4);\n    else if (idx === 2) hitManager.deactivate('mouse', 2);\n    else hitManager.deactivate('mouse', 1 << idx);\n  }\n});\n// 兼容键盘(喵喵喵?)\ninteract.setKeyboardEvent({\n  keydownCallback(evt: KeyboardEvent) {\n    if (emitter.eq('stop')) return;\n    if (evt.key === 'Shift') btnPause.click();\n    else if (hitManager.list.find(i => i.type === 'keyboard' && i.id === evt.code) == null) {\n      hitManager.activate('keyboard', evt.code, NaN, NaN); // 按住一个键时，会触发多次keydown事件\n    }\n  },\n  keyupCallback(evt: KeyboardEvent) {\n    if (emitter.eq('stop')) return;\n    if (evt.key !== 'Shift') hitManager.deactivate('keyboard', evt.code);\n  }\n});\nself.addEventListener('blur', () => {\n  hitManager.clear('keyboard');\n});\n// 兼容移动设备\ninteract.setTouchEvent({\n  touchstartCallback(evt: TouchEvent) {\n    for (const i of evt.changedTouches) {\n      const { x, y } = getPos(i);\n      hitManager.activate('touch', i.identifier, x, y);\n      specialClick.activate(x, y);\n    }\n  },\n  touchmoveCallback(evt: TouchEvent) {\n    for (const i of evt.changedTouches) {\n      const { x, y } = getPos(i);\n      hitManager.moving('touch', i.identifier, x, y);\n    }\n  },\n  touchendCallback(evt: TouchEvent) {\n    for (const i of evt.changedTouches) hitManager.deactivate('touch', i.identifier);\n  },\n  touchcancelCallback(evt: TouchEvent) {\n    // if (emitter.eq('play')) atPause(); TODO: 意外暂停提醒\n    for (const i of evt.changedTouches) hitManager.deactivate('touch', i.identifier);\n  }\n});\nfunction getPos(obj: MouseEvent | Touch) {\n  const rect = canvas.getBoundingClientRect();\n  return {\n    x: (obj.clientX - rect.left) / canvas.offsetWidth * canvas.width - (canvas.width - canvasfg.width) / 2,\n    y: (obj.clientY - rect.top) / canvas.offsetHeight * canvas.height\n  };\n}\n// Hit end\nexport const noteRender = {\n  note: {} as Record<string, ScaledNote>,\n  hitFX: {} as Record<string, ScaledHitFX>,\n  async update(name: string, img: ImageBitmap, scale: number, compacted = false): Promise<void> {\n    this.note[name] = new ScaledNote(img, scale, compacted);\n    if (name === 'Tap') this.note.TapBad = new ScaledNote(await imgPainter(img, '#6c4343'), scale);\n  },\n  async updateFX(img0: ImageBitmap, scale: number, limitX?: number, limitY?: number, hideParts = false, duration?: number): Promise<void> {\n    const hitRaw = await imgSplit(img0, limitX, limitY);\n    const hitPerfect = hitRaw.map(async img => new ScaledNote(await imgShader(img, 'rgba(255,236,160,0.8823529)'), scale)); // #fce491,#ffeca0e1\n    const hitGood = hitRaw.map(async img => new ScaledNote(await imgShader(img, 'rgba(180,225,255,0.9215686)'), scale)); // #9ed5f3,#b4e1ffeb\n    img0.close();\n    this.hitFX.Perfect = {\n      effects: await Promise.all(hitPerfect),\n      numOfParts: hideParts ? 0 : 4,\n      duration: Number(duration) | 0 || 500\n    };\n    this.hitFX.Good = {\n      effects: await Promise.all(hitGood),\n      numOfParts: hideParts ? 0 : 3,\n      duration: Number(duration) | 0 || 500\n    };\n    hitRaw.forEach(img => img.close());\n  }\n};\n// 初始化(踩坑：监听DOMContentLoaded似乎会阻塞页面导致长时间白屏)\nwindow.addEventListener('load', (): void => {\n  const handler = async(): Promise<void> => {\n    canvas.classList.add('fade');\n    // let loadedNum = 0;\n    // let errorNum = 0;\n    msgHandler.updateText('初始化...');\n    if (await checkSupport({\n      messageCallback: msg => msgHandler.updateText(msg),\n      warnCallback: msg => msgHandler.sendWarning(msg),\n      errorCallback: (msg, html, fatal) => msgHandler.sendError(msg, html, fatal),\n      mobileCallback: () => blockUploaderSelect.style.display = 'none',\n      orientNotSupportCallback: () => {\n        lockOri.checked = false;\n        lockOri.container.classList.add('disabled');\n        lockOri.label.textContent += '(当前设备或浏览器不支持)';\n      }\n    })) return;\n    await import('./utils/reader-');\n    const raw = await loadResource(atob('aHR0cHM6Ly9sY2h6aC5uZXQvZGF0YS9wYWNrLmpzb24=')).catch(() => ({\n    // const raw = await loadResource('local/ptres2.json').catch(() => ({\n      image: {} as Record<string, string>,\n      audio: {} as Record<string, string>,\n      alternative: {} as Record<string, string>,\n      format: ''\n    }));\n    if (!raw) return; // 占位符\n    // shit start\n    await readResource(raw);\n    // .then(result => {\n    //   loadedNum += result.loadedNum;\n    //   errorNum += result.errorNum;\n    // })\n    // shit end\n    // if (errorNum) {\n    //   msgHandler.sendError(`错误：${errorNum}个资源加载失败（点击查看详情）`);\n    //   return;\n    // }\n    const entries = ['Tap', 'TapHL', 'Drag', 'DragHL', 'HoldHead', 'HoldHeadHL', 'Hold', 'HoldHL', 'HoldEnd', 'Flick', 'FlickHL'];\n    await fixme(raw, res);\n    await Promise.all(entries.map(async i => noteRender.update(i, res[i] as ImageBitmap, 8080 / Number(raw.image[i].split('|')[1]))));\n    // for (const i of entries) await noteRender.update(i, res[i], 8080 / raw.image[i].split('|')[1]);\n    await noteRender.updateFX(res.HitFXRaw, 8080 / Number(raw.image.HitFXRaw.split('|')[1]));\n    res.NoImageBlack = await createImageBitmap(new ImageData(new Uint8ClampedArray(4).fill(0), 1, 1));\n    res.NoImageWhite = await createImageBitmap(new ImageData(new Uint8ClampedArray(4).fill(255), 1, 1));\n    res.JudgeLineMP = await imgShader(res.JudgeLine, '#feffa9');\n    res.JudgeLineFC = await imgShader(res.JudgeLine, '#a2eeff');\n    res.Ranks = await imgSplit(res.Rank);\n    res.Rank.close();\n    res.mute = audio.mute(1);\n    if ((() => {\n      const b = createCtx(1, 1);\n      b.drawImage(res.JudgeLine, 0, 0);\n      return b.getImageData(0, 0, 1, 1).data[0];\n    })() === 0) {\n      msgHandler.sendError('检测到图片加载异常，请关闭所有应用程序然后重试');\n      return;\n    }\n    msgHandler.updateText('等待上传文件...');\n    blockUploader.classList.remove('disabled');\n    blockSelect.classList.remove('disabled');\n    emitter.dispatchEvent(new CustomEvent('change'));\n  };\n  handler();\n}, { once: true });\nasync function loadResource(url: string) {\n  const res1 = await fetch(url);\n  const text = await res1.text();\n  try {\n    return JSON.parse(text) as {\n      image: Record<string, string>;\n      audio: Record<string, string>;\n      alternative: Record<string, string>;\n    };\n  } catch (err) {\n    msgHandler.sendError('错误：解析资源时出现问题（点击查看详情）', Utils.escapeHTML(`解析资源时出现问题：\\n${(err as Error).message}\\n原始数据：\\n${text}`), true);\n    return null;\n  }\n}\nasync function readResource(raw: {\n  format?: string;\n  image: Record<string, string>;\n  audio: Record<string, string>;\n  alternative: Record<string, string>;\n}) {\n  let loadedNum = 0;\n  let errorNum = 0;\n  const res0: Record<string, string> = {};\n  Object.assign(res0, raw.image);\n  Object.assign(res0, raw.audio);\n  // 加载资源\n  const res1 = [] as Promise<void>[];\n  if (raw.format === 'raw') {\n    res1.push(...Object.entries(raw.image).map(async([name, src]) => {\n      const [url, ext] = src.split('|');\n      console.log(url, ext);\n      await fetch(url, { referrerPolicy: 'no-referrer' }).then(async a => a.blob()).then(async blob => {\n        const img = await createImageBitmap(blob);\n        res[name] = img;\n        msgHandler.updateText(`加载资源：${Math.floor(loadedNum++ / res1.length * 100)}%`);\n      }).catch(() => {\n        errorNum++;\n        msgHandler.sendWarning(`资源加载失败，请检查您的网络连接然后重试：\\n${new URL(url, location.toString()).toString()}`);\n      });\n    }));\n    res1.push(...Object.entries(raw.audio).map(async([name, src]) => {\n      await fetch(src, { referrerPolicy: 'no-referrer' }).then(async a => a.arrayBuffer()).then(async buffer => {\n        res[name] = await audio.decode(buffer);\n        msgHandler.updateText(`加载资源：${Math.floor(loadedNum++ / res1.length * 100)}%`);\n      }).catch(() => {\n        errorNum++;\n        msgHandler.sendWarning(`资源加载失败，请检查您的网络连接然后重试：\\n${new URL(src, location.toString()).toString()}`);\n      });\n    }));\n  } else {\n    res1.push(...Object.entries(res0).map(async([name, src]) => {\n      const [url, ext] = src.split('|');\n      await fetch(url, { referrerPolicy: 'no-referrer' }).then(async a => a.blob()).then(async blob => {\n        const img = await createImageBitmap(blob);\n        if (ext?.startsWith('m')) {\n          const data = decode(img, Number(ext.slice(1)));\n          img.close();\n          res[name] = await audio.decode(data).catch(async(_err: DOMException | Error) => {\n            const blob1 = await fetch(raw.alternative[name], {\n              referrerPolicy: 'no-referrer'\n            }).then(async i => i.blob());\n            return createImageBitmap(blob1).then(decodeAlt).then(async ab => audio.decode(ab)).catch((err: Error) => {\n              msgHandler.sendWarning(`音频加载存在问题，将导致以下音频无法正常播放：\\n${name}(${err.message})\\n如果多次刷新问题仍然存在，建议更换设备或浏览器。`);\n              return audio.mute(1);\n            });\n          });\n        } else res[name] = img;\n        msgHandler.updateText(`加载资源：${Math.floor(loadedNum++ / res1.length * 100)}%`);\n      }).catch(err => {\n        console.error(err);\n        msgHandler.sendError(`错误：${errorNum++}个资源加载失败（点击查看详情）`, `资源加载失败，请检查您的网络连接然后重试：\\n${new URL(url, location.toString()).toString()}`, true);\n      });\n    }));\n  }\n  await Promise.all(res1);\n  return { loadedNum, errorNum };\n}\n// 作图\nfunction mainLoop() {\n  frameTimer.addTick(); // 计算fps\n  const { lineScale } = app;\n  nowTimeMS = performance.now();\n  app.resizeCanvas();\n  // 计算时间\n  if (timeOut.second < 0.67) {\n    loopNoCanvas();\n    for (const i of main.now.values()) i(timeBgm * app.speed);\n    loopCanvas();\n  } else if (!isOutOver) {\n    isOutOver = true;\n    audio.stop();\n    btnPause.classList.add('disabled'); // TODO: 优化\n    ctxfg.globalCompositeOperation = 'source-over';\n    ctxfg.resetTransform();\n    ctxfg.globalAlpha = 1;\n    const bgImage = checkImageBlur.checked ? app.bgImageBlur : app.bgImage;\n    ctxfg.drawImage(bgImage, ...adjustSize(bgImage, canvasfg, 1));\n    ctxfg.fillStyle = '#000'; // 背景变暗\n    ctxfg.globalAlpha = app.brightness; // 背景不透明度\n    ctxfg.fillRect(0, 0, canvasfg.width, canvasfg.height);\n    self.setTimeout(() => {\n      if (!isOutOver) return; // 避免快速重开后直接结算\n      const difficulty = ['ez', 'hd', 'in', 'at'].indexOf(levelText.slice(0, 2).toLocaleLowerCase());\n      audio.play(res[`LevelOver${difficulty < 0 ? 2 : difficulty}_v1`] as AudioBuffer, { loop: true });\n      timeEnd.reset();\n      timeEnd.play();\n      stat.level = Number(/\\d+$/.exec(levelText));\n      tempStat = stat.getData(app.playMode === 1, selectspeed.value);\n    }, 1e3);\n  } // 只让它执行一次\n  if (tempStat != null) atDraw3(tempStat);\n  ctx.globalAlpha = 1;\n  const bgImage = checkImageBlur.checked ? app.bgImageBlur : app.bgImage;\n  ctx.drawImage(bgImage, ...adjustSize(bgImage, canvas, 1.1));\n  ctx.fillStyle = '#000';\n  ctx.globalAlpha = 0.4;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.globalAlpha = 1;\n  ctx.drawImage(canvasfg, (canvas.width - canvasfg.width) / 2, 0);\n  // Copyright\n  ctx.globalCompositeOperation = 'difference';\n  ctx.font = `${lineScale * 0.4}px Custom,Noto Sans SC`;\n  ctx.fillStyle = '#fff';\n  ctx.globalAlpha = 0.8;\n  ctx.textAlign = 'right';\n  ctx.fillText(`${self._i[0]} v${self._i[1].join('.')} - Code by lchz\\x683\\x3473`, (canvas.width + canvasfg.width) / 2 - lineScale * 0.1, canvas.height - lineScale * 0.1);\n  ctx.globalCompositeOperation = 'source-over';\n}\nfunction loopNoCanvas() {\n  if (app.chart == null) throw new Error('Not initialized: Chart');\n  if (!isInEnd && timeIn.second >= 3 && emitter.eq('play')) { // fixed: 修复关闭过渡动画时重开1帧内点击暂停产生显示暂停实际音乐播放的问题\n    isInEnd = true;\n    playBgm(app.bgMusic);\n    if (app.bgVideo != null) playVideo(app.bgVideo);\n  }\n  if (emitter.eq('play') && isInEnd && !isOutStart) timeBgm = curTime + (nowTimeMS - curTimeMS) / 1e3;\n  if (timeBgm < 0) timeBgm = 0; // fixed: 修复重开后时间轴不归零的问题\n  if (timeBgm >= duration0) isOutStart = true;\n  if (showTransition.checked && isOutStart && !isOutEnd) {\n    isOutEnd = true;\n    timeOut.play();\n  }\n  timeChart = Math.max(timeBgm - (app.chart.offset + Number(inputOffset.value) / 1e3 || 0) / app.speed, 0);\n  // 遍历判定线events和Note\n  app.updateByTime(timeChart);\n  // 更新打击特效和触摸点动画\n  hitFeedbackList.update();\n  hitImageList.update();\n  hitWordList.update();\n  for (const i of hitManager.list) {\n    if (i.type === 'keyboard') continue;\n    if (!i.isTapped) hitFeedbackList.add(HitFeedback.tap(i.offsetX, i.offsetY));\n    else if (i.isMoving) hitFeedbackList.add(HitFeedback.move(i.offsetX, i.offsetY));\n    else if (i.isActive) hitFeedbackList.add(HitFeedback.hold(i.offsetX, i.offsetY)); // TODO: 动态特效\n  }\n  // 触发判定和播放打击音效\n  if (isInEnd) {\n    const judgeWidth = canvasfg.width * 0.118125;\n    judgeManager.addEvent(app.notes, timeChart);\n    judgeManager.execute(app.drags, timeChart, judgeWidth);\n    judgeManager.execute(app.flicks, timeChart, judgeWidth);\n    judgeManager.execute(app.tapholds, timeChart, judgeWidth);\n  }\n  // 更新判定\n  hitManager.update();\n  // if (awawa && stat.good + stat.bad) {\n  //   stat.level = Number(levelText.match(/\\d+$/));\n  //   stat.reset();\n  //   Promise.resolve().then(atStop).then(atStop);\n  // }\n  tmps.bgImage = checkImageBlur.checked ? app.bgImageBlur : app.bgImage;\n  tmps.bgVideo = app.bgVideo;\n  tmps.progress = (main.awawa ? duration0 - timeBgm : timeBgm) / duration0;\n  tmps.name = inputName.value || inputName.placeholder;\n  tmps.artist = inputArtist.value;\n  tmps.illustrator = inputIllustrator.value || inputIllustrator.placeholder;\n  tmps.charter = inputCharter.value || inputCharter.placeholder;\n  tmps.level = levelText;\n  if (stat.combo > 2) {\n    tmps.combo = `${stat.combo}`;\n    tmps.combo2 = app.playMode === 1 ? 'Autoplay' : 'combo';\n  } else {\n    tmps.combo = '';\n    tmps.combo2 = '';\n  }\n  tmps.showStat = true;\n  tmps.customForeDraw = null;\n  tmps.customBackDraw = null;\n}\n// import { app, adjustSize, isInEnd, main, atIn, stat, drawLine, atOut, drawNotes, showPoint, timeChart, hitImageList, showCE2, hitWordList, tween, res, tmps, fillTextNode, lineColor, showAcc, nowTimeMS, checkFeedback, hitFeedbackList, time2Str, duration0, timeBgm, status2, frameTimer, showStat } from './index';\nfunction loopCanvas() {\n  const { lineScale, wlen, hlen } = app;\n  const { bgImage, bgVideo } = tmps;\n  ctxfg.clearRect(0, 0, canvasfg.width, canvasfg.height); // 重置画面\n  // 绘制背景\n  ctxfg.globalAlpha = 1;\n  ctxfg.drawImage(bgImage, ...adjustSize(bgImage, canvasfg, 1));\n  if (isInEnd && bgVideo != null && !main.awawa) {\n    const { videoWidth: width, videoHeight: height } = bgVideo;\n    ctxfg.drawImage(bgVideo, ...adjustSize({ width, height }, canvasfg, 1));\n  }\n  // if (awawa) ctxfg.filter = `hue-rotate(${stat.combo*360/7}deg)`;\n  if (timeIn.second >= 2.5 && !stat.lineStatus) drawLine(0, lineScale);\n  // 绘制判定线(背景后0)\n  // if (awawa) ctxfg.filter = 'none';\n  ctxfg.resetTransform();\n  ctxfg.fillStyle = '#000'; // 背景变暗\n  ctxfg.globalAlpha = app.brightness; // 背景不透明度\n  ctxfg.fillRect(0, 0, canvasfg.width, canvasfg.height);\n  if (timeIn.second >= 2.5 && tmps.customBackDraw != null) tmps.customBackDraw(ctxfg); // 自定义背景\n  // if (awawa) ctxfg.filter = `hue-rotate(${stat.combo*360/7}deg)`;\n  if (timeIn.second >= 2.5) drawLine(stat.lineStatus ? 2 : 1, lineScale);\n  // 绘制判定线(背景前1)\n  // if (awawa) ctxfg.filter = 'none';\n  ctxfg.resetTransform();\n  if (timeIn.second >= 3 && timeOut.second === 0) {\n    // 绘制note\n    drawNotes();\n    if (showPoint.checked) {\n      // 绘制定位点\n      ctxfg.font = `${lineScale}px Custom,Noto Sans SC`;\n      ctxfg.textAlign = 'center';\n      for (const i of app.linesReversed) {\n        ctxfg.setTransform(i.cosr, i.sinr, -i.sinr, i.cosr, i.offsetX, i.offsetY);\n        ctxfg.globalAlpha = 1;\n        ctxfg.fillStyle = 'violet';\n        ctxfg.fillRect(-lineScale * 0.2, -lineScale * 0.2, lineScale * 0.4, lineScale * 0.4);\n        ctxfg.fillStyle = 'yellow';\n        ctxfg.globalAlpha = (i.alpha + 0.5) / 1.5;\n        ctxfg.fillText(i.lineId.toString(), 0, -lineScale * 0.3);\n      }\n      for (const i of app.notesReversed) {\n        if (!i.visible) continue;\n        ctxfg.setTransform(i.cosr, i.sinr, -i.sinr, i.cosr, i.offsetX, i.offsetY);\n        ctxfg.globalAlpha = 1;\n        ctxfg.fillStyle = 'lime';\n        ctxfg.fillRect(-lineScale * 0.2, -lineScale * 0.2, lineScale * 0.4, lineScale * 0.4);\n        ctxfg.fillStyle = 'cyan';\n        ctxfg.globalAlpha = i.seconds > timeChart ? 1 : 0.5;\n        ctxfg.fillText(i.name, 0, -lineScale * 0.3);\n      }\n    }\n  }\n  // if (awawa) ctxfg.filter = `hue-rotate(${stat.combo*360/7}deg)`;\n  hitImageList.animate(); // 绘制打击特效1\n  // if (awawa) ctxfg.filter = 'none';\n  if (showCE2.checked) hitWordList.animate(); // 绘制打击特效2\n  ctxfg.globalAlpha = 1;\n  // 绘制进度条\n  ctxfg.setTransform(canvasfg.width / 1920, 0, 0, canvasfg.width / 1920, 0, lineScale * (timeIn.second < 0.67 ? tween.easeOutSine(timeIn.second * 1.5) - 1 : -tween.easeOutSine(timeOut.second * 1.5)) * 1.75);\n  ctxfg.drawImage(res.ProgressBar, tmps.progress * 1920 - 1920, 0);\n  // 绘制文字\n  ctxfg.resetTransform();\n  for (const i of main.after.values()) i();\n  ctxfg.fillStyle = '#fff';\n  // 开头过渡动画\n  if (timeIn.second < 3) {\n    if (timeIn.second < 0.67) ctxfg.globalAlpha = tween.easeOutSine(timeIn.second * 1.5);\n    else if (timeIn.second >= 2.5) ctxfg.globalAlpha = tween.easeOutSine(6 - timeIn.second * 2);\n    ctxfg.textAlign = 'center';\n    // 曲名、曲师、曲绘和谱师\n    fillTextNode(tmps.name, wlen, hlen * 0.75, lineScale * 1.1, canvasfg.width - lineScale * 1.5);\n    fillTextNode(tmps.artist, wlen, hlen * 0.75 + lineScale * 1.25, lineScale * 0.55, canvasfg.width - lineScale * 1.5);\n    fillTextNode(`Illustration designed by ${tmps.illustrator}`, wlen, hlen * 1.25 + lineScale * 0.55, lineScale * 0.55, canvasfg.width - lineScale * 1.5);\n    fillTextNode(`Level designed by ${tmps.charter}`, wlen, hlen * 1.25 + lineScale * 1.4, lineScale * 0.55, canvasfg.width - lineScale * 1.5);\n    // 判定线(装饰用)\n    ctxfg.globalAlpha = 1;\n    ctxfg.setTransform(1, 0, 0, 1, wlen, hlen);\n    const imgW = lineScale * 48 * (timeIn.second < 0.67 ? tween.easeInSine(timeIn.second * 1.5) : 1);\n    const imgH = lineScale * 0.15; // 0.1333...\n    if (timeIn.second >= 2.5) ctxfg.globalAlpha = tween.easeOutSine(6 - timeIn.second * 2);\n    ctxfg.drawImage(lineColor.checked ? res.JudgeLineMP : res.JudgeLine, -imgW / 2, -imgH / 2, imgW, imgH);\n  }\n  // 绘制分数和combo\n  ctxfg.globalAlpha = 1;\n  ctxfg.setTransform(1, 0, 0, 1, 0, lineScale * (timeIn.second < 0.67 ? tween.easeOutSine(timeIn.second * 1.5) - 1 : -tween.easeOutSine(timeOut.second * 1.5)) * 1.75);\n  if (tmps.showStat) {\n    ctxfg.font = `${lineScale * 0.95}px Custom,Noto Sans SC`;\n    ctxfg.textAlign = 'right';\n    ctxfg.fillText(stat.scoreStr, canvasfg.width - lineScale * 0.65, lineScale * 1.375);\n    if (showAcc.checked) {\n      ctxfg.font = `${lineScale * 0.66}px Custom,Noto Sans SC`;\n      ctxfg.fillText(stat.accStr, canvasfg.width - lineScale * 0.65, lineScale * 2.05);\n    }\n  }\n  ctxfg.textAlign = 'center';\n  ctxfg.font = `${lineScale * 1.32}px Custom,Noto Sans SC`;\n  ctxfg.fillText(tmps.combo, wlen, lineScale * 1.375);\n  ctxfg.globalAlpha = timeIn.second < 0.67 ? tween.easeOutSine(timeIn.second * 1.5) : 1 - tween.easeOutSine(timeOut.second * 1.5);\n  ctxfg.font = `${lineScale * 0.66}px Custom,Noto Sans SC`;\n  ctxfg.fillText(tmps.combo2, wlen, lineScale * 2.05);\n  // 绘制曲名和等级\n  ctxfg.globalAlpha = 1;\n  ctxfg.setTransform(1, 0, 0, 1, 0, lineScale * (timeIn.second < 0.67 ? 1 - tween.easeOutSine(timeIn.second * 1.5) : tween.easeOutSine(timeOut.second * 1.5)) * 1.75);\n  ctxfg.textAlign = 'right';\n  fillTextNode(tmps.level, canvasfg.width - lineScale * 0.75, canvasfg.height - lineScale * 0.66, lineScale * 0.63, wlen - lineScale);\n  ctxfg.textAlign = 'left';\n  fillTextNode(tmps.name, lineScale * 0.65, canvasfg.height - lineScale * 0.66, lineScale * 0.63, wlen - lineScale);\n  ctxfg.resetTransform();\n  // 绘制时间和帧率以及note打击数\n  ctxfg.fillStyle = '#fff';\n  if (timeIn.second < 0.67) ctxfg.globalAlpha = tween.easeOutSine(timeIn.second * 1.5);\n  else ctxfg.globalAlpha = 1 - tween.easeOutSine(timeOut.second * 1.5);\n  ctxfg.font = `${lineScale * 0.4}px Custom,Noto Sans SC`;\n  ctxfg.textAlign = 'left';\n  ctxfg.fillText(`${time2Str(main.awawa ? duration0 - timeBgm : timeBgm)}/${time2Str(duration0)}${status2.text}`, lineScale * 0.05, lineScale * 0.6);\n  ctxfg.textAlign = 'right';\n  ctxfg.fillText(frameTimer.fpsStr, canvasfg.width - lineScale * 0.05, lineScale * 0.6);\n  if (tmps.showStat && showStat.checked) {\n    ctxfg.textAlign = 'right';\n    [stat.noteRank[6], stat.noteRank[7], stat.noteRank[5], stat.noteRank[4], stat.noteRank[1], stat.noteRank[3], stat.noteRank[2]].forEach((val, idx) => {\n      const comboColor = ['#fe7b93', '#0ac3ff', 'lime', '#f0ed69', 'lime', '#0ac3ff', '#999'];\n      ctxfg.fillStyle = comboColor[idx];\n      ctxfg.fillText(val.toString(), canvasfg.width - lineScale * 0.05, canvasfg.height / 2 + lineScale * (idx - 2.8) * 0.5);\n    });\n    ctxfg.fillStyle = '#fff';\n    ctxfg.textAlign = 'left';\n    ctxfg.fillText(`DSP:  ${stat.curDispStr}`, lineScale * 0.05, canvasfg.height / 2 - lineScale * 0.15);\n    ctxfg.fillText(`AVG:  ${stat.avgDispStr}`, lineScale * 0.05, canvasfg.height / 2 + lineScale * 0.35);\n    ctxfg.textAlign = 'center';\n    stat.combos.forEach((val, idx) => {\n      const comboColor = ['#fff', '#0ac3ff', '#f0ed69', '#a0e9fd', '#fe4365'];\n      ctxfg.fillStyle = comboColor[idx];\n      ctxfg.fillText(val.toString(), lineScale * (idx + 0.55) * 1.1, canvasfg.height - lineScale * 0.1);\n    });\n  }\n  if (timeIn.second >= 2.5 && timeIn.second < 3) ctxfg.globalAlpha = 1 - tween.easeOutSine(6 - timeIn.second * 2);\n  else ctxfg.globalAlpha = 1 - tween.easeOutSine(timeOut.second * 1.5);\n  if (timeIn.second >= 2.5 && tmps.customForeDraw != null) tmps.customForeDraw(ctxfg); // 自定义前景\n  if (timeIn.second >= 2.5 && main.filter != null) main.filter(ctxfg, timeBgm, nowTimeMS / 1e3); // 滤镜处理\n  if (checkFeedback.checked) hitFeedbackList.animate(); // 绘制打击特效0\n  ctxfg.resetTransform();\n}\n// 判定线函数，undefined/0:默认,1:非,2:恒成立\nfunction drawLine(bool: number, lineScale: number) {\n  const tw = 1 - tween.easeOutSine(timeOut.second * 1.5);\n  for (const i of app.linesReversed) {\n    if (bool ^ Number(i.imageD) && timeOut.second < 0.67) {\n      ctxfg.globalAlpha = i.alpha;\n      ctxfg.setTransform(i.cosr * tw, i.sinr, -i.sinr * tw, i.cosr, app.wlen + (i.offsetX - app.wlen) * tw, i.offsetY); // Hiahiah\n      const imgS = (i.imageU ? lineScale * 18.75 : canvasfg.height) * i.imageS / 1080;\n      const imgW = imgS * i.imageW * i.imageA;\n      const imgH = imgS * i.imageH;\n      ctxfg.drawImage(i.imageL[i.imageC && lineColor.checked ? stat.lineStatus : 0], -imgW / 2, -imgH / 2, imgW, imgH);\n    }\n  }\n  ctxfg.globalAlpha = 1;\n}\nfunction fillTextNode(text: string, x: number, y: number, size: number, maxWidth: number) {\n  ctxfg.font = `${size}px Custom,Noto Sans SC`;\n  const dx = ctxfg.measureText(text).width;\n  if (dx > maxWidth) ctxfg.font = `${size / dx * maxWidth}px Custom,Noto Sans SC`;\n  ctxfg.fillText(text, x, y);\n  return dx;\n}\nfunction atDraw3(statData: StatData) {\n  ctxfg.resetTransform();\n  ctxfg.clearRect(0, 0, canvasfg.width, canvasfg.height);\n  ctxfg.globalAlpha = 1;\n  const bgImage = checkImageBlur.checked ? app.bgImageBlur : app.bgImage;\n  ctxfg.drawImage(bgImage, ...adjustSize(bgImage, canvasfg, 1));\n  ctxfg.fillStyle = '#000'; // 背景变暗\n  ctxfg.globalAlpha = app.brightness; // 背景不透明度\n  ctxfg.fillRect(0, 0, canvasfg.width, canvasfg.height);\n  ctxfg.globalCompositeOperation = 'destination-out';\n  ctxfg.globalAlpha = 1;\n  const k = 3.7320508075688776; // tan75°\n  ctxfg.setTransform(canvasfg.width - canvasfg.height / k, 0, -canvasfg.height / k, canvasfg.height, canvasfg.height / k, 0);\n  ctxfg.fillRect(0, 0, 1, tween.easeOutCubic(clip((timeEnd.second - 0.13) * 0.94)));\n  ctxfg.resetTransform();\n  ctxfg.globalCompositeOperation = 'destination-over';\n  const skew = (canvasfg.width - canvasfg.height / k) / (16 - 9 / k);\n  ctxfg.setTransform(skew / 120, 0, 0, skew / 120, app.wlen - skew * 8, app.hlen - skew * 4.5); // ?\n  ctxfg.drawImage(res.LevelOver4, 183, 42, 1184, 228);\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.27) / 0.83);\n  ctxfg.drawImage(res.LevelOver1, 102, 378);\n  ctxfg.globalCompositeOperation = 'source-over';\n  ctxfg.globalAlpha = 1;\n  ctxfg.drawImage(res.LevelOver5, 700 * tween.easeOutCubic(clip(timeEnd.second * 1.25)) - 369, 91, 20, 80);\n  // 曲名和等级\n  ctxfg.fillStyle = '#fff';\n  ctxfg.textAlign = 'left';\n  fillTextNode(inputName.value || inputName.placeholder, 700 * tween.easeOutCubic(clip(timeEnd.second * 1.25)) - 320, 160, 80, 1500);\n  const textWidth = fillTextNode(levelText, 700 * tween.easeOutCubic(clip(timeEnd.second * 1.25)) - 317, 212, 30, 750);\n  ctxfg.font = '30px Custom,Noto Sans SC';\n  // Rank图标\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.87) * 3.75);\n  const outerSize = 293 + clip((timeEnd.second - 1.87) * 3.75) * 100;\n  const innerSize = 410 - clip((timeEnd.second - 1.87) * 2.14) * 164;\n  ctxfg.drawImage(res.LevelOver3, 661 - outerSize / 2, 545 - outerSize / 2, outerSize, outerSize);\n  ctxfg.drawImage(res.Ranks[stat.rankStatus], 661 - innerSize / 2, 545 - innerSize / 2, innerSize, innerSize);\n  // 各种数据\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.87) * 2.5);\n  ctxfg.fillStyle = statData.newBestColor;\n  ctxfg.fillText(statData.newBestStr, 898, 433);\n  ctxfg.fillStyle = '#fff';\n  ctxfg.textAlign = 'center';\n  ctxfg.fillText(statData.scoreBest, 1180, 433);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.87) * 2.5);\n  ctxfg.textAlign = 'right';\n  ctxfg.fillText(statData.scoreDelta, 1414, 433);\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.95) * 1.5);\n  ctxfg.textAlign = 'left';\n  ctxfg.fillText(stat.accStr, 352, 550);\n  ctxfg.fillText(stat.maxcombo.toString(), 1528, 550);\n  ctxfg.fillStyle = statData.textAboveColor;\n  ctxfg.fillText(app.speed === 1 ? '' : statData.textAboveStr.replace('{SPEED}', app.speed.toFixed(2)), 383 + Math.min(textWidth, 750), 212);\n  ctxfg.fillStyle = statData.textBelowColor;\n  ctxfg.fillText(statData.textBelowStr, 1355, 595);\n  ctxfg.fillStyle = '#fff';\n  ctxfg.textAlign = 'center';\n  ctxfg.font = '86px Custom,Noto Sans SC';\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.12) * 2.0);\n  ctxfg.fillText(stat.scoreStr, 1075, 569);\n  ctxfg.font = '26px Custom,Noto Sans SC';\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.87) * 2.5);\n  ctxfg.fillText(stat.perfect.toString(), 891, 650);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.07) * 2.5);\n  ctxfg.fillText(stat.good.toString(), 1043, 650);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.27) * 2.5);\n  ctxfg.fillText(stat.noteRank[6].toString(), 1196, 650);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.47) * 2.5);\n  ctxfg.fillText(stat.noteRank[2].toString(), 1349, 650);\n  ctxfg.font = '22px Custom,Noto Sans SC';\n  const transition = clip((main.pressTime > 0 ? timeEnd.second - main.pressTime : 0.2 - timeEnd.second - main.pressTime) * 5.0);\n  ctxfg.globalAlpha = 0.8 * clip((timeEnd.second - 0.87) * 2.5) * transition;\n  ctxfg.fillStyle = '#696';\n  ctxfg.fill(new Path2D('M841,718s-10,0-10,10v80s0,10,10,10h100s10,0,10-10v-80s0-10-10-10h-40l-10-20-10,20h-40z'));\n  ctxfg.globalAlpha = 0.8 * clip((timeEnd.second - 1.07) * 2.5) * transition;\n  ctxfg.fillStyle = '#669';\n  ctxfg.fill(new Path2D('M993,718s-10,0-10,10v80s0,10,10,10h100s10,0,10-10v-80s0-10-10-10h-40l-10-20-10,20h-40z'));\n  ctxfg.fillStyle = '#fff';\n  ctxfg.globalAlpha = clip((timeEnd.second - 0.97) * 2.5) * transition;\n  ctxfg.fillText(`Early: ${stat.noteRank[5]}`, 891, 759);\n  ctxfg.fillText(`Late: ${stat.noteRank[1]}`, 891, 792);\n  ctxfg.globalAlpha = clip((timeEnd.second - 1.17) * 2.5) * transition;\n  ctxfg.fillText(`Early: ${stat.noteRank[7]}`, 1043, 759);\n  ctxfg.fillText(`Late: ${stat.noteRank[3]}`, 1043, 792);\n  ctxfg.resetTransform();\n  ctxfg.globalCompositeOperation = 'destination-over';\n  ctxfg.globalAlpha = 1;\n  ctxfg.fillStyle = '#000';\n  ctxfg.drawImage(app.bgImage, ...adjustSize(app.bgImage, canvasfg, 1));\n  ctxfg.fillRect(0, 0, canvasfg.width, canvasfg.height);\n  ctxfg.globalCompositeOperation = 'source-over';\n}\nfunction clip(num: number) {\n  if (num < 0) return 0;\n  if (num > 1) return 1;\n  return num;\n}\ninterface ScaledHitFX {\n  effects: ScaledNote[];\n  numOfParts: number;\n  duration: number;\n}\n// 绘制Note\nfunction drawNotes() {\n  for (const i of app.holds) drawHold(i, timeChart);\n  for (const i of app.dragsReversed) drawDrag(i);\n  for (const i of app.tapsReversed) drawTap(i);\n  for (const i of app.flicksReversed) drawFlick(i);\n}\nfunction drawTap(note: NoteExtends) {\n  const HL = note.isMulti && app.multiHint;\n  const nsr = app.noteScaleRatio;\n  if (!note.visible || note.scored && note.badTime == null) return;\n  ctxfg.setTransform(nsr * note.cosr, nsr * note.sinr, -nsr * note.sinr, nsr * note.cosr, note.offsetX, note.offsetY);\n  if (note.badTime == null) {\n    ctxfg.globalAlpha = note.alpha || (note.showPoint && showPoint.checked ? 0.45 : 0);\n    if (main.awawa) ctxfg.globalAlpha *= Math.max(1 + (timeChart - note.seconds) / 1.5, 0);\n    // 过线前1.5s出现\n    noteRender.note[HL ? 'TapHL' : 'Tap'].full(ctxfg);\n  } else {\n    ctxfg.globalAlpha = 1 - clip((performance.now() - note.badTime) / 500);\n    noteRender.note.TapBad.full(ctxfg);\n  }\n}\nfunction drawDrag(note: NoteExtends) {\n  const HL = note.isMulti && app.multiHint;\n  const nsr = app.noteScaleRatio;\n  if (!note.visible || note.scored && note.badTime == null) return;\n  ctxfg.setTransform(nsr * note.cosr, nsr * note.sinr, -nsr * note.sinr, nsr * note.cosr, note.offsetX, note.offsetY);\n  if (note.badTime == null) {\n    ctxfg.globalAlpha = note.alpha || (note.showPoint && showPoint.checked ? 0.45 : 0);\n    if (main.awawa) ctxfg.globalAlpha *= Math.max(1 + (timeChart - note.seconds) / 1.5, 0);\n    noteRender.note[HL ? 'DragHL' : 'Drag'].full(ctxfg);\n  } else {\n    // Nothing to do\n  }\n}\nfunction drawHold(note: NoteExtends, seconds: number) {\n  const HL = note.isMulti && app.multiHint;\n  const nsr = app.noteScaleRatio;\n  if (!note.visible || note.seconds + note.holdSeconds < seconds) return; // 不绘制时空超界的Hold\n  ctxfg.globalAlpha = note.alpha || (note.showPoint && showPoint.checked ? 0.45 : 0);\n  if (main.awawa) ctxfg.globalAlpha *= Math.max(1 + (timeChart - note.seconds) / 1.5, 0);\n  ctxfg.setTransform(nsr * note.cosr, nsr * note.sinr, -nsr * note.sinr, nsr * note.cosr, note.offsetX, note.offsetY);\n  const baseLength = app.scaleY / nsr * note.speed * app.speed;\n  const holdLength = baseLength * note.holdSeconds;\n  if (note.seconds > seconds) {\n    noteRender.note[HL ? 'HoldHeadHL' : 'HoldHead'].head(ctxfg);\n    noteRender.note[HL ? 'HoldHL' : 'Hold'].body(ctxfg, -holdLength, holdLength);\n  } else noteRender.note[HL ? 'HoldHL' : 'Hold'].body(ctxfg, -holdLength, holdLength - baseLength * (seconds - note.seconds));\n  noteRender.note.HoldEnd.tail(ctxfg, -holdLength);\n}\nfunction drawFlick(note: NoteExtends) {\n  const HL = note.isMulti && app.multiHint;\n  const nsr = app.noteScaleRatio;\n  if (!note.visible || note.scored && note.badTime == null) return;\n  ctxfg.setTransform(nsr * note.cosr, nsr * note.sinr, -nsr * note.sinr, nsr * note.cosr, note.offsetX, note.offsetY);\n  if (note.badTime == null) {\n    ctxfg.globalAlpha = note.alpha || (note.showPoint && showPoint.checked ? 0.45 : 0);\n    if (main.awawa) ctxfg.globalAlpha *= Math.max(1 + (timeChart - note.seconds) / 1.5, 0);\n    noteRender.note[HL ? 'FlickHL' : 'Flick'].full(ctxfg);\n  } else {\n    // Nothing to do\n  }\n}\nconst lineImages = new Map() as Map<ImageBitmap, LineImage>;\nclass LineImage {\n  public image: ImageBitmap;\n  public imageFC: ImageBitmap | null;\n  public imageAP: null; // ImageBitmap | null;\n  public imageMP: ImageBitmap | null;\n  public constructor(image: ImageBitmap) {\n    this.image = image;\n    this.imageFC = null;\n    this.imageAP = null;\n    this.imageMP = null;\n  }\n  public async getFC() {\n    if (this.imageFC == null) this.imageFC = await imgShader(this.image, '#a2eeff');\n    return this.imageFC;\n  }\n  public async getAP() {\n    if (this.imageAP == null) this.imageAP = await Promise.resolve(null); // imgShader(this.image, '#a3ffac');\n    return this.imageAP;\n  }\n  public async getMP() {\n    if (this.imageMP == null) this.imageMP = await imgShader(this.image, '#feffa9');\n    return this.imageMP;\n  }\n}\nconst updateLineImage = (image: ImageBitmap) => {\n  const lineImage = lineImages.get(image) || new LineImage(image);\n  if (!lineImages.has(image)) lineImages.set(image, lineImage);\n  return lineImage;\n};\n// rgba数组(0-1)转十六进制\n// function rgba2hex(...rgba:number[]) {\n//   return '#' + rgba.map(i => ('00' + Math.round(Number(i) * 255 || 0).toString(16)).slice(-2)).join('');\n// }\n// byte转人类可读\nfunction bytefm(byte = 0) {\n  let result = byte;\n  if (result < 1024) return `${result}B`;\n  if ((result /= 1024) < 1024) return `${result.toFixed(2)}KB`;\n  if ((result /= 1024) < 1024) return `${result.toFixed(2)}MB`;\n  if ((result /= 1024) < 1024) return `${result.toFixed(2)}GB`;\n  if ((result /= 1024) < 1024) return `${result.toFixed(2)}TB`;\n  if ((result /= 1024) < 1024) return `${result.toFixed(2)}PB`;\n  if ((result /= 1024) < 1024) return `${result.toFixed(2)}EB`;\n  if ((result /= 1024) < 1024) return `${result.toFixed(2)}ZB`;\n  if ((result /= 1024) < 1024) return `${result.toFixed(2)}YB`;\n  result /= 1024; return `${result}BB`;\n}\nconst updateLevelText = (type: number) => {\n  const table = { sp: [0, 0], ez: [1, 7], hd: [3, 12], in: [6, 15], at: [13, 16] } as Record<string, [number, number]>;\n  let diffStr = (selectDifficulty.value || 'SP').toLowerCase();\n  let levelNum = Number(selectLevel.value) | 0;\n  if (type === 0) {\n    const diff = table[diffStr];\n    if (levelNum < diff[0]) levelNum = diff[0];\n    if (levelNum > diff[1]) levelNum = diff[1];\n    selectLevel.value = levelNum.toString();\n    selectLevel.value = selectLevel.value;\n  } else if (type === 1) {\n    const keys = Object.keys(table);\n    if (table[diffStr][1] < levelNum) diffStr = keys.find(key => table[key][1] >= levelNum) ?? 'SP';\n    else if (table[diffStr][0] > levelNum) diffStr = keys.reverse().find(key => table[key][0] <= levelNum) ?? 'SP';\n    selectDifficulty.value = diffStr.toUpperCase();\n    selectDifficulty.value = selectDifficulty.value;\n  }\n  const diffString = selectDifficulty.value || 'SP';\n  const levelString = selectLevel.value || '?';\n  return [diffString, levelString].join('\\u2002Lv.');\n};\nlevelText = updateLevelText(-1);\nselectDifficulty.addEventListener('change', () => { levelText = updateLevelText(0) });\nselectLevel.addEventListener('change', () => { levelText = updateLevelText(1) });\nselectVolume.addEventListener('change', evt => {\n  const volume = Number((evt.target as HTMLInputElement).value);\n  app.musicVolume = Math.min(1, 1 / volume);\n  app.soundVolume = Math.min(1, volume);\n  Promise.resolve().then(atPause).then(atPause);\n});\nstatus.reg('selectVolume', selectVolume);\ncheckAutoPlay.addEventListener('change', evt => {\n  app.playMode = (evt.target as HTMLInputElement).checked ? 1 : 0;\n});\ncheckAutoPlay.dispatchEvent(new Event('change'));\nlowRes.checkbox.addEventListener('change', evt => {\n  app.setLowResFactor((evt.target as HTMLInputElement).checked ? 0.5 : 1);\n});\nlowRes.checkbox.dispatchEvent(new Event('change'));\nselectbg.onchange = () => { // TODO: 重构\n  app.bgImage = bgs.get(selectbg.value)!;\n  app.bgImageBlur = bgsBlur.get(selectbg.value)!;\n  stage.resize();\n};\nselectchart.addEventListener('change', adjustInfo);\n(function() {\n  const input = document.createElement('input');\n  Object.assign(input, { type: 'number', min: 25, max: 1000, value: 60 });\n  input.style.cssText += ';width:50px;margin-left:10px';\n  input.addEventListener('change', function(this: HTMLInputElement) {\n    const value = Number(this.value);\n    if (value < 25) this.value = '25';\n    if (value > 1000) this.value = '1000';\n    frameAnimater.setFrameRate(Number(this.value));\n  });\n  status.reg('maxFrameNumber', input, false);\n  maxFrame.container.appendChild(input);\n  maxFrame.checkbox.addEventListener('change', function(this: HTMLInputElement) {\n    input.classList.toggle('disabled', !this.checked);\n    if (this.checked) input.dispatchEvent(new Event('change'));\n    else frameAnimater.setFrameRate(0);\n  });\n  maxFrame.checkbox.dispatchEvent(new Event('change'));\n}());\n// Play\nemitter.addEventListener('change', function(this: Emitter) {\n  canvas.classList.toggle('fade', this.eq('stop'));\n  blockMask.classList.toggle('fade', this.ne('stop'));\n  btnPlay.value = this.eq('stop') ? '播放' : '停止';\n  btnPause.value = this.eq('pause') ? '继续' : '暂停';\n  btnPause.classList.toggle('disabled', this.eq('stop'));\n  for (const i of $$('.disabled-when-playing')) i.classList.toggle('disabled', this.ne('stop'));\n  // console.log(this);\n});\nbtnPlay.addEventListener('click', function(this: HTMLInputElement) {\n  const handler = async() => {\n    if (this.classList.contains('disabled')) return;\n    this.classList.add('disabled');\n    await atStop();\n    this.classList.remove('disabled');\n  };\n  handler();\n});\nbtnPause.addEventListener('click', function(this: HTMLInputElement) {\n  const handler = async() => {\n    if (this.classList.contains('disabled')) return;\n    this.classList.add('disabled');\n    await atPause();\n    this.classList.remove('disabled');\n  };\n  handler();\n});\ninputOffset.addEventListener('input', function(this: HTMLInputElement) {\n  const value = Number(this.value);\n  if (value < -400) this.value = '-400';\n  if (value > 600) this.value = '600';\n});\nstatus2.reg(emitter, 'change', () => main.awawa ? 'Reversed' : ''); // TODO: 重构\nstatus2.reg(selectflip, 'change', target => ['', 'FlipX', 'FlipY', 'FlipX&Y'][Number((target as HTMLSelectElement).value)]);\nstatus2.reg(selectspeed, 'change', target => (target as HTMLSelectElement).value);\nstatus2.reg(emitter, 'change', target => (target as Emitter).eq('pause') ? 'Paused' : '');\nasync function atStop(): Promise<void> {\n  if (emitter.eq('stop')) {\n    if (!selectchart.value) {\n      msgHandler.sendError('错误：未选择任何谱面');\n      return;\n    }\n    for (const i of main.before.values()) await i();\n    audio.play(res.mute, { loop: true, isOut: false }); // 播放空音频(避免音画不同步)\n    app.prerenderChart(main.modify(charts.get(selectchart.value)!) as unknown as Record<string, unknown>); // TODO: 重构\n    const md5 = chartsMD5.get(selectchart.value)!;\n    stat.level = Number(/\\d+$/.exec(levelText));\n    if (app.chart != null) stat.reset(app.chart.numOfNotes, md5, selectspeed.value);\n    await loadLineData({ onwarn: str => msgHandler.sendWarning(str) });\n    app.bgImage = bgs.get(selectbg.value) || res.NoImageWhite;\n    app.bgImageBlur = bgsBlur.get(selectbg.value) || res.NoImageWhite;\n    const bgm = bgms.get(selectbgm.value) || { audio: audio.mute(app.chart!.maxSeconds + 0.5), video: null };\n    app.bgMusic = bgm.audio;\n    app.bgVideo = bgm.video;\n    duration0 = app.bgMusic.duration / app.speed;\n    isInEnd = false;\n    isOutStart = false;\n    isOutEnd = false;\n    timeBgm = 0;\n    if (!showTransition.checked) timeIn.addTime(3e3);\n    frameAnimater.start();\n    timeIn.play();\n    interact.activate();\n    emitter.emit('play');\n  } else {\n    emitter.emit('stop');\n    interact.deactive();\n    audio.stop();\n    frameAnimater.stop();\n    // 清除原有数据\n    isOutOver = false;\n    tempStat = null;\n    hitFeedbackList.clear();\n    hitImageList.clear();\n    hitWordList.clear();\n    timeIn.reset();\n    timeOut.reset();\n    timeEnd.reset();\n    curTime = 0;\n    curTimeMS = 0;\n    duration0 = 0;\n  }\n}\nasync function loadLineData({\n  onwarn = (_: string) => {}\n} = {}) {\n  for (const i of app.lines) {\n    i.imageW = 6220.8; // 1920\n    i.imageH = 7.68; // 3\n    i.imageL = [res.JudgeLine, res.JudgeLineMP, null, res.JudgeLineFC];\n    i.imageS = 1; // 2.56\n    i.imageA = 1; // 1.5625\n    i.imageD = false;\n    i.imageC = true;\n    i.imageU = true;\n  }\n  for (const i of chartLineData) {\n    if (selectchart.value === i.Chart) {\n      if (i.LineId == null) {\n        onwarn('未指定判定线id');\n        continue;\n      }\n      const line = app.lines[Number(i.LineId)] as JudgeLineExtends | null;\n      if (line == null) {\n        onwarn(`指定id的判定线不存在：${i.LineId}`);\n        continue;\n      }\n      let image = i.Image == null ? null : bgs.get(i.Image);\n      if (!image) {\n        if (i.Image != null) onwarn(`图片不存在：${i.Image}`);\n        image = res.NoImageBlack;\n      }\n      line.imageW = image.width;\n      line.imageH = image.height;\n      const lineImage = updateLineImage(image);\n      line.imageL = await Promise.all([image, lineImage.getMP(), lineImage.getAP(), lineImage.getFC()]);\n      let temp = 0;\n      if (i.Vert != null && isFinite(temp = parseFloat(i.Vert))) { // Legacy\n        line.imageS = Math.abs(temp) * 1080 / image.height;\n        line.imageU = temp > 0;\n      }\n      if (i.Horz != null && isFinite(temp = parseFloat(i.Horz))) line.imageA = temp; // Legacy\n      if (i.IsDark != null && isFinite(temp = parseFloat(i.IsDark))) line.imageD = Boolean(temp); // Legacy\n      if (i.Scale != null && isFinite(temp = parseFloat(String(i.Scale)))) line.imageS = temp;\n      if (i.Aspect != null && isFinite(temp = parseFloat(String(i.Aspect)))) line.imageA = temp;\n      if (i.UseBackgroundDim != null && isFinite(temp = parseFloat(String(i.UseBackgroundDim)))) line.imageD = Boolean(temp);\n      if (i.UseLineColor != null && isFinite(temp = parseFloat(String(i.UseLineColor)))) line.imageC = Boolean(temp);\n      if (i.UseLineScale != null && isFinite(temp = parseFloat(String(i.UseLineScale)))) line.imageU = Boolean(temp);\n    }\n  }\n}\nasync function atPause() {\n  if (emitter.eq('stop') || isOutOver) return;\n  if (emitter.eq('play')) {\n    if (app.bgVideo != null) app.bgVideo.pause();\n    timeIn.pause();\n    if (showTransition.checked && isOutStart) timeOut.pause();\n    curTime = timeBgm;\n    audio.stop();\n    emitter.emit('pause');\n  } else {\n    if (app.bgVideo != null) await playVideo(app.bgVideo, timeBgm * app.speed);\n    timeIn.play();\n    if (showTransition.checked && isOutStart) timeOut.play();\n    if (isInEnd && !isOutStart) playBgm(app.bgMusic, timeBgm * app.speed);\n    // console.log(app.bgVideo);\n    emitter.emit('play');\n  }\n}\n// Plugins\nconst debounce = (callback: () => void, delay: number) => {\n  let timer = 0;\n  return () => {\n    clearTimeout(timer);\n    timer = self.setTimeout(callback, delay);\n  };\n};\nconst loadPlugin = (searchValue: string, callback: () => void) => {\n  inputName.addEventListener('input', debounce(() => {\n    if (inputName.value === searchValue) {\n      callback();\n      inputName.value = '';\n      inputName.dispatchEvent(new Event('input'));\n    }\n  }, 1e3));\n};\nconst appendCfg = (name: string, callback: () => void) => new Checkbox(name).appendBefore(resetCfg.container).hook(callback);\nmain.fireModal = function(navHTML = '', contentHTML = '') {\n  const cover = document.createElement('div');\n  cover.classList.add('cover-dark', 'fade');\n  const container = document.createElement('div');\n  container.classList.add('cover-view', 'fade');\n  const nav = document.createElement('div');\n  nav.classList.add('view-nav');\n  nav.innerHTML = navHTML;\n  const content = document.createElement('div');\n  content.classList.add('view-content');\n  content.innerHTML = contentHTML;\n  content.addEventListener('custom-done', () => cover.click());\n  container.append(nav, content);\n  requestAnimationFrame(() => {\n    ($('.main') as HTMLDivElement).append(cover, container);\n    requestAnimationFrame(() => {\n      cover.classList.remove('fade');\n      container.classList.remove('fade');\n    });\n  });\n  cover.addEventListener('click', () => {\n    cover.classList.add('fade');\n    cover.addEventListener('transitionend', () => {\n      cover.remove();\n    });\n    container.classList.add('fade');\n    container.addEventListener('transitionend', () => {\n      container.remove();\n    });\n  });\n  return content;\n};\nmain.toast = (msg = '') => main.fireModal('<p>提示</p>', `<p style=\"white-space:pre;text-align:left;display:inline-block;\">${msg}</p>`);\nmain.define = a => a;\nmain.use = async m => {\n  const module = await m.then(n => n.default);\n  for (const i of module.contents) {\n    if (i.type === 'command') loadPlugin(i.meta[0], i.meta[1]);\n    else if (i.type === 'script') i.meta[0]($);\n    else if (i.type === 'config') appendCfg(i.meta[0], i.meta[1]);\n    else throw new TypeError(`Unknown Plugin Type: ${i.type}`);\n  }\n  console.log(module);\n  return module;\n};\nmain.use(import('@/phizone.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/tips.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/filter.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/skin.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/export.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/gauge.js') as unknown as Promise<ModuleBase>);\nmain.use(import('@/dynamic-score.js') as unknown as Promise<ModuleBase>);\n// debug\nself.hook = main;\nexport const hook = main;\nmain.stat = stat;\nmain.app = app;\nmain.res = res;\nmain.audio = audio;\nmain.msgHandler = msgHandler;\nmain.frameAnimater = frameAnimater;\nmain.timeEnd = timeEnd;\nmain.bgms = bgms;\nmain.inputName = inputName;\nmain.selectbgm = selectbgm;\nmain.selectchart = selectchart;\nmain.chartsMD5 = chartsMD5;\nmain.noteRender = noteRender;\nmain.fileReader = fileReader;\nmain.ZipReader = ZipReader;\nmain.status = status;\nmain.tmps = tmps;\nmain.awawa = false;\nmain.pause = async() => emitter.eq('play') && atPause();\nObject.defineProperty(main, 'playing', {\n  get: () => emitter.eq('play')\n  // set: v => v ? atPause() : atPause()\n});\nObject.defineProperty(main, 'time', {\n  get: () => timeBgm,\n  set(v: number) {\n    const handler = async() => {\n      if (emitter.eq('stop') || isOutOver) return;\n      const isPlaying = emitter.eq('play');\n      if (isPlaying) await atPause();\n      timeBgm = v / app.speed;\n      curTime = timeBgm;\n      app.seekLineEventIndex();\n      // app.notes.forEach(a => { a.status = 0;\n      //   a.scored = 0;\n      //   a.holdStatus = 1; });\n      // stat.reset();\n      if (isPlaying) await atPause().catch(console.warn); // FIXME: video+gauge结算时会报错\n    };\n    handler();\n  }\n});\n/* exported hook */\n","export class Stage {\n  private aspectRatio: number;\n  private isFull: boolean;\n  private readonly stage: HTMLDivElement;\n  public constructor(stage: HTMLDivElement) {\n    this.aspectRatio = 0;\n    this.isFull = false;\n    this.stage = stage;\n    this.resize();\n  }\n  public resize(ratio = 0): void {\n    this.aspectRatio = ratio || this.aspectRatio || 16 / 9;\n    const stageWidth = Math.min(854, document.documentElement.clientWidth * 0.8);\n    const stageHeight = stageWidth / this.aspectRatio;\n    if (this.isFull) this.stage.style.cssText = ';position:fixed;top:0;left:0;bottom:0;right:0';\n    else this.stage.style.cssText = `;width:${stageWidth.toFixed()}px;height:${stageHeight.toFixed()}px`;\n  }\n  public getFull(): boolean {\n    return this.isFull;\n  }\n  public setFull(isFull: boolean): boolean {\n    return this.isFull = isFull;\n  }\n}\n","// Html交互(WIP)\nexport class StatusManager {\n  private readonly key: string;\n  private data: Record<string, string>;\n  public constructor(key: string) {\n    this.key = key;\n    this.data = {};\n  }\n  public init(resetCallback: (data: Record<string, string>) => string): this {\n    this.data = JSON.parse(localStorage.getItem(this.key) ?? '{}') as Record<string, string>;\n    if (typeof resetCallback === 'function') {\n      if (resetCallback(this.data)) this.reset();\n    }\n    return this;\n  }\n  public save(): void {\n    localStorage.setItem(this.key, JSON.stringify(this.data));\n  }\n  public reset(): void {\n    this.data = {};\n    this.save();\n  }\n  public get(key: string): string | undefined {\n    return this.data[key];\n  }\n  public set(key: string, value: string): void {\n    this.data[key] = value;\n    this.save();\n  }\n  public reg(key: string, node: HTMLElement, dispatch: unknown = true): void {\n    if (node instanceof HTMLInputElement || node instanceof HTMLSelectElement) {\n      const property = node.type === 'checkbox' ? 'checked' : 'value';\n      const value = this.get(key);\n      if (value !== undefined) { ((node as HTMLInputElement)[property] as string) = value }\n      node.addEventListener('change', () => {\n        this.set(key, (node as HTMLInputElement)[property] as string);\n      });\n      if (dispatch as boolean) { node.dispatchEvent(new Event('change')) }\n    } else if (node instanceof HTMLTextAreaElement) {\n      const value = this.get(key);\n      if (value !== undefined) { (node.value as unknown) = value }\n      node.addEventListener('change', () => {\n        this.set(key, node.value);\n      });\n      if (dispatch as boolean) { node.dispatchEvent(new Event('change')) }\n    } else { throw new Error('Node must be <input>, <select> or <textarea>') }\n  }\n}\n","import createCtx from './createCtx';\nimport { canvasRGBA } from 'stackblur-canvas';\nexport async function imgBlur(img: ImageBitmap): Promise<ImageBitmap> {\n  const ctx = createCtx(img.width, img.height);\n  const { width: w, height: h } = ctx.canvas;\n  ctx.drawImage(img, 0, 0);\n  canvasRGBA(ctx.canvas, 0, 0, w, h, Math.ceil(Math.min(w, h) * 0.0125));\n  return createImageBitmap(ctx.canvas);\n}\n","export class FrameTimer {\n  private tick: number;\n  private time: number;\n  private fps: number;\n  public constructor() {\n    this.tick = 0;\n    this.time = performance.now();\n    this.fps = 0;\n  }\n  public get fpsStr(): string {\n    const { fps } = this;\n    if (fps < 10) return fps.toPrecision(2);\n    return fps.toFixed(0);\n  }\n  public get disp(): number {\n    return 0.5 / this.fps || 0;\n  }\n  public addTick(fr = 10): number {\n    if (++this.tick >= fr) {\n      this.tick = 0;\n      this.fps = 1e3 * fr / (-this.time + (this.time = performance.now()));\n    }\n    return this.fps;\n  }\n}\n","export class FrameAnimater {\n  private callback: (arg0: number) => void;\n  private lastTime: number;\n  private interval: number;\n  private id: number | null;\n  public constructor() {\n    this.callback = (): void => {};\n    this.lastTime = 0;\n    this.interval = Number.EPSILON;\n    this.id = null;\n    this._animate = this._animate.bind(this);\n  }\n  public start(): void {\n    if (this.id !== null) return;\n    this.lastTime = performance.now();\n    this.id = requestAnimationFrame(this._animate.bind(this));\n  }\n  public stop(): void {\n    if (this.id === null) return;\n    cancelAnimationFrame(this.id);\n    this.id = null;\n  }\n  public setCallback(callback: (arg0: number) => void): void {\n    if (typeof callback !== 'function') throw new TypeError('callback is not a function');\n    this.callback = callback;\n  }\n  public setFrameRate(frameRate: number): void {\n    this.interval = Math.abs(1e3 / frameRate);\n    if (!isFinite(this.interval)) this.interval = Number.EPSILON;\n  }\n  private _animate() {\n    this.id = requestAnimationFrame(this._animate.bind(this)); // 回调更新动画\n    const nowTime = performance.now();\n    const elapsed = nowTime - this.lastTime;\n    if (elapsed > this.interval) {\n      this.lastTime = nowTime - elapsed % this.interval;\n      this.callback(nowTime);\n    }\n  }\n}\n","import createCtx from './createCtx';\nimport { hex2rgba } from './hex2rgba';\nexport async function imgPainter(img: ImageBitmap, color: string, limit = 512): Promise<ImageBitmap> {\n  const dataRGBA = hex2rgba(color);\n  const ctx = createCtx(img.width, img.height, { willReadFrequently: true }); // Warning\n  ctx.drawImage(img, 0, 0);\n  for (let dy = 0; dy < img.height; dy += limit) {\n    for (let dx = 0; dx < img.width; dx += limit) {\n      const imgData = ctx.getImageData(dx, dy, limit, limit);\n      for (let i = 0; i < imgData.data.length / 4; i++) {\n        imgData.data[i * 4] = dataRGBA[0];\n        imgData.data[i * 4 + 1] = dataRGBA[1];\n        imgData.data[i * 4 + 2] = dataRGBA[2];\n        imgData.data[i * 4 + 3] *= dataRGBA[3] / 255;\n      }\n      ctx.putImageData(imgData, dx, dy);\n    }\n  }\n  return createImageBitmap(ctx.canvas);\n}\n","import createCtx from './createCtx';\nimport { audio } from '../external';\nexport async function fixme(raw: Record<string, unknown>, res: Record<string, unknown>): Promise<void> {\n  const entries = ['Tap', 'TapHL', 'Drag', 'DragHL', 'HoldHead', 'HoldHeadHL', 'Hold', 'HoldHL', 'HoldEnd', 'Flick', 'FlickHL', 'HitFXRaw'];\n  if (raw.image == null) raw.image = {};\n  const { image } = raw as { image: Record<string, string> };\n  for (const entry of entries) {\n    if (image[entry] == null) image[entry] = '|8080';\n  }\n  if (res.Tap == null) {\n    const ctx = createCtx(1089, 200);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 200 L 0 200 Z'));\n    ctx.strokeStyle = '#0ac3e1';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 150 L 50 150 Z'));\n    res.Tap = await createImageBitmap(ctx.canvas);\n  }\n  if (res.TapHL == null) {\n    const ctx = createCtx(1089, 200);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 200 L 0 200 Z'));\n    ctx.strokeStyle = '#0ac3e1';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 150 L 50 150 Z'));\n    res.TapHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.Drag == null) {\n    const ctx = createCtx(1089, 160);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 160 L 0 160 Z'));\n    ctx.strokeStyle = '#f0ed69';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 110 L 50 110 Z'));\n    res.Drag = await createImageBitmap(ctx.canvas);\n  }\n  if (res.DragHL == null) {\n    const ctx = createCtx(1089, 160);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 160 L 0 160 Z'));\n    ctx.strokeStyle = '#f0ed69';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 110 L 50 110 Z'));\n    res.DragHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HoldHead == null) {\n    const ctx = createCtx(1089, 100);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 0 100 L 1089 100 L 1089 0'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 0 L 50 50 L 1039 50 L 1039 0'));\n    res.HoldHead = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HoldHeadHL == null) {\n    const ctx = createCtx(1089, 100);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 0 100 L 1089 100 L 1089 0'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 0 L 50 50 L 1039 50 L 1039 0'));\n    res.HoldHeadHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.Hold == null) {\n    const ctx = createCtx(1089, 1900);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 0 1900 M 1089 0 L 1089 1900'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 0 L 50 1900 M 1039 0 L 1039 1900'));\n    res.Hold = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HoldHL == null) {\n    const ctx = createCtx(1089, 1900);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 0 1900 M 1089 0 L 1089 1900'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 0 L 50 1900 M 1039 0 L 1039 1900'));\n    res.HoldHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HoldEnd == null) {\n    const ctx = createCtx(1089, 100);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 100 L 0 0 L 1089 0 L 1089 100'));\n    ctx.strokeStyle = '#96ebfc';\n    ctx.stroke(new Path2D('M 50 100 L 50 50 L 1039 50 L 1039 100'));\n    res.HoldEnd = await createImageBitmap(ctx.canvas);\n  }\n  if (res.Flick == null) {\n    const ctx = createCtx(1089, 300);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 300 L 0 300 Z'));\n    ctx.strokeStyle = '#fe4365';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 250 L 50 250 Z'));\n    res.Flick = await createImageBitmap(ctx.canvas);\n  }\n  if (res.FlickHL == null) {\n    const ctx = createCtx(1089, 300);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fdfd66';\n    ctx.stroke(new Path2D('M 0 0 L 1089 0 L 1089 300 L 0 300 Z'));\n    ctx.strokeStyle = '#fe4365';\n    ctx.stroke(new Path2D('M 50 50 L 1039 50 L 1039 250 L 50 250 Z'));\n    res.FlickHL = await createImageBitmap(ctx.canvas);\n  }\n  if (res.Rank == null) {\n    const ctx = createCtx(256, 1792);\n    ctx.lineWidth = 32;\n    ctx.strokeStyle = '#fff000';\n    ctx.strokeRect(58, 58, 140, 140);\n    ctx.strokeStyle = '#6f6bf1';\n    ctx.strokeRect(58, 58 + 256, 140, 140);\n    ctx.strokeStyle = '#ea4cd6';\n    ctx.strokeRect(58, 58 + 256 * 2, 140, 140);\n    ctx.strokeStyle = '#ff7f2a';\n    ctx.strokeRect(58, 58 + 256 * 3, 140, 140);\n    ctx.strokeStyle = '#00d448';\n    ctx.strokeRect(58, 58 + 256 * 4, 140, 140);\n    ctx.strokeStyle = '#00eafb';\n    ctx.strokeRect(58, 58 + 256 * 5, 140, 140);\n    ctx.strokeStyle = '#ffffff';\n    ctx.strokeRect(58, 58 + 256 * 6, 140, 140);\n    res.Rank = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HitFXRaw == null) {\n    const ctx = createCtx(256, 256 * 30);\n    ctx.strokeStyle = '#fff';\n    for (let i = 0; i < 30; i++) {\n      const tick = i / 30;\n      ctx.lineWidth = (1 - tick) ** 2 * 25;\n      ctx.globalAlpha = 1 - tick;\n      const width = tick ** 0.2 * 224;\n      ctx.strokeRect(128 - width / 2, i * 256 + 128 - width / 2, width, width);\n    }\n    res.HitFXRaw = await createImageBitmap(ctx.canvas);\n  }\n  if (res.LevelOver1 == null) {\n    const ctx = createCtx(1716, 325);\n    ctx.fillStyle = '#333';\n    ctx.globalAlpha = 0.8;\n    ctx.fillRect(0, 0, 1716, 325);\n    res.LevelOver1 = await createImageBitmap(ctx.canvas);\n  }\n  if (res.LevelOver4 == null) {\n    const ctx = createCtx(633, 122);\n    ctx.fillStyle = '#333';\n    ctx.globalAlpha = 0.9;\n    ctx.fillRect(0, 0, 633, 122);\n    res.LevelOver4 = await createImageBitmap(ctx.canvas);\n  }\n  if (res.LevelOver5 == null) {\n    const ctx = createCtx(11, 43);\n    ctx.fillStyle = '#fff';\n    ctx.fillRect(0, 0, 11, 43);\n    res.LevelOver5 = await createImageBitmap(ctx.canvas);\n  }\n  const entries2 = ['HitFXRaw', 'Rank', 'LevelOver1', 'LevelOver3', 'LevelOver4', 'LevelOver5'];\n  for (const entry of entries2) {\n    if (res[entry] == null) {\n      res[entry] = await createImageBitmap(createCtx(1, 1).canvas);\n    }\n  }\n  if (res.JudgeLine == null) {\n    const ctx = createCtx(1920, 3);\n    ctx.fillStyle = '#fff';\n    ctx.fillRect(0, 0, 1920, 3);\n    res.JudgeLine = await createImageBitmap(ctx.canvas);\n  }\n  if (res.ProgressBar == null) {\n    const ctx = createCtx(1919, 11);\n    ctx.fillStyle = '#919191';\n    ctx.fillRect(0, 0, 1916, 11);\n    ctx.fillStyle = '#fff';\n    ctx.fillRect(1916, 0, 3, 11);\n    res.ProgressBar = await createImageBitmap(ctx.canvas);\n  }\n  if (res.HitSong0 == null) res.HitSong0 = audio.triangle(0.075, 880, 0.5); // 0.1\n  if (res.HitSong1 == null) res.HitSong1 = audio.triangle(0.05, 1318, 0.5); // 0.44\n  if (res.HitSong2 == null) res.HitSong2 = audio.triangle(0.075, 1760, 0.5); // 0.39\n  if (res.LevelOver0_v1 == null) res.LevelOver0_v1 = audio.noise(27.83);\n  if (res.LevelOver1_v1 == null) res.LevelOver1_v1 = audio.noise(27.83);\n  if (res.LevelOver2_v1 == null) res.LevelOver2_v1 = audio.noise(27.83);\n  if (res.LevelOver3_v1 == null) res.LevelOver3_v1 = audio.noise(27.83);\n}\n"],"names":["full","toggle","elem","this","enabled","Promise","reject","Error","onFullscreen","t","resolve","document","addEventListener","onchange","once","onerror","element","handler","exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","call","HTMLElement","body","requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","check","onfullscreenchange","onwebkitfullscreenchange","onmozfullscreenchange","onfullscreenerror","onwebkitfullscreenerror","onmozfullscreenerror","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","orientation","checkSupport","s","screen","lock","type","unlock","hook","toast","e","name","message","lockLandscape","lockPortrait","isUndefined","self","Reflect","construct","EventTarget","listeners","prototype","constructor","callback","push","removeEventListener","stack","i","l","length","splice","dispatchEvent","event","defaultPrevented","error","cause","Object","defineProperty","value","DOMException","super","captureStackTrace","replace","AudioContext","webkitAudioContext","hasOwn","obj","prop","hasOwnProperty","Timer","__publicField","t0","t1","isPaused","time","performance","now","second","play","pause","reset","addTime","num","csv2array","data","isObject","strarr","split","col","rowstr","isQuot","beforeQuot","row","j","SyntaxError","arr","stringify","bfs","labels","label","decoder","TextDecoder","fatal","decode","base64map","crypt","rotl","n","b","rotr","endian","Number","randomBytes","bytes","Math","floor","random","bytesToWords","words","wordsToBytes","bytesToHex","hex","toString","join","hexToBytes","c","parseInt","substr","bytesToBase64","base64","triplet","charAt","base64ToBytes","imod4","indexOf","pow","cryptModule","exports","charenc","utf8","stringToBytes","str","bin","unescape","encodeURIComponent","bytesToString","decodeURIComponent","escape","charCodeAt","String","fromCharCode","charenc_1","isBuffer_1","isBuffer","readFloatLE","slice","isSlowBuffer","_isBuffer","require$$0","require$$1","require$$2","md5","options","encoding","Array","isArray","Uint8Array","m","a","d","FF","_ff","GG","_gg","HH","_hh","II","_ii","aa","bb","cc","dd","x","_blocksize","_digestsize","md5Module","digestbytes","asBytes","asString","FileEmitter","input","assign","createElement","accept","multiple","fireChange","files","reader","FileReader","readAsArrayBuffer","onprogress","evt","fireProgress","loaded","total","onload","target","result","ArrayBuffer","fireLoad","uploadFile","webkitdirectory","click","uploadDir","Event","ProgressEvent","lengthComputable","file","buffer","ZipReader","async","worker","read","result0","CustomEvent","Zip","msg","detail","catch","err","postMessage","terminate","defineReader","readerInit","pattern","mustMatch","weight","path","isText","text","isJSON","JSON","parse","readers","_path","createAudioBuffer","videoElement","src","URL","createObjectURL","Blob","preload","onloadedmetadata","videoWidth","width","videoHeight","height","audio","video","readMediaData","arraybuffer","actx","close","decodeAudioData","then","defaultDecode","jsonData","chart123","_","fround","imageData","createImageBitmap","joinPathInfo","fileReader","readFile","lastIndexOf","splitPath","readers0","filter","test","sort","errors","errorHandler","o","use","info","Chart","Music","Image","reviver","chart","formatVersion","judgeLineList","judgeLineMoveEvents","start2","start","end2","end","y","y2","speedEvents","startTime","floorPosition","floorPosition2","endTime","bpm","numOfNotes","notesAbove","notesBelow","To","int","float","bool","map","SpeedEvent","Note","note","positionX","holdTime","speed","LineEvent","JudgeLine","line","numOfNotesAbove","numOfNotesBelow","judgeLineDisappearEvents","judgeLineRotateEvents","offset","normalizeLineEvent","events","oldEvents","newEvents","i2","i1","newEvents2","shift","d1","d2","normalizeSpeedEvent","HitEvent","id","offsetX","offsetY","isActive","isTapped","isMoving","lastDeltaX","lastDeltaY","nowDeltaX","nowDeltaY","deltaTime","currentTime","flicking","flicked","move","flickSpeed","sqrt","JudgeEvent","judged","preventBad","Stat","level","noteRank","combos","cumDisp","curDisp","numDisp","maxcombo","combo","good","bad","great","perfect","all","scoreNum","isFinite","scoreStr","toFixed","repeat","accNum","accStr","avgDispStr","trunc","curDispStr","lineStatus","rankStatus","round","localData","removeLegacy","key","item","localStorage","getItem","setItem","removeItem","getData","isAuto","s1","s2","l1","l2","l3","na","sa","sb","v","entries","pbj","newBestColor","newBestStr","scoreBest","scoreDelta","abs","textAboveColor","textAboveStr","textBelowColor","textBelowStr","_localStorage$getItem","addCombo","status","addDisp","disp","createCtx","canvas","ctx","getContext","TypeError","decodeAlt","img","drawImage","getImageData","ab","mask","combined","size","DataView","getUint32","Checkbox","checked","container","checkbox","Utils","randomUUID","htmlFor","textContent","appendChild","appendTo","appendBefore","node","parentNode","insertBefore","_arg0","_arg1","HitEvents","updateCallback","_arg","iterateCallback","update","defilter","bind","animate","iterate","predicate","add","clear","HitFeedback","n1","n2","color","tap","hold","HitImage","n3","packs","noteRender","hitFX","duration","effects","direction","numOfParts","fill","PI","_note","HitWord","early","late","ScaledNote","scale","compacted","dx","dy","dw","dh","head","tail","_typeof","Symbol","iterator","mulTable","shgTable","processCanvasRGBA","topX","topY","radius","getElementById","context","getImageDataFromCanvas","stackEnd","pixels","div","widthMinus1","heightMinus1","radiusPlus1","sumFactor","stackStart","BlurStack","next","stackIn","stackOut","yw","yi","mulSum","shgSum","pr","pg","pb","pa","_i","r","g","rInSum","gInSum","bInSum","aInSum","rOutSum","gOutSum","bOutSum","aOutSum","rSum","gSum","bSum","aSum","_i2","p","rbs","paInitial","_a2","_p","_stackOut","_r","_g","_b","_a","_x","_pr","_pg","_pb","_pa","_rOutSum","_gOutSum","_bOutSum","_aOutSum","_rSum","_gSum","_bSum","_aSum","_i3","yp","_gInSum","_bInSum","_aInSum","_rInSum","_i4","_rbs","_y","_p2","processImageDataRGBA","putImageData","instance","Constructor","_classCallCheck","hex2rgba","fillStyle","fillRect","imgShader","limit","dataRGBA","willReadFrequently","imgData","imgSplit","limitX","limitY","min","sy","sx","messageCallback","_msg","warnCallback","errorCallback","_html","_fatal","mobileCallback","orientNotSupportCallback","sysError","getConstructorName","message2","_h$stack","idx","errMessage","errDetail","escapeHTML","reason","loadLib","urls","errmsg1","errmsg2","errmsg3","args","from","location","href","args0","arg","load","url","script","port","crossOrigin","loadJS","addFont","alt","navigator","standalone","platform","includes","maxTouchPoints","userAgent","miuiVersion","exec","parseFloat","checkMiuiVersion","oggCompatible","Audio","canPlayType","init","oggmented","OggmentedAudioContext","webpCompatible","toDataURL","checkOrient","adjustSize","source","dest","sw","sh","$id","query","$","querySelector","viewNav","viewCfg","viewMsg","coverDark","coverRsmg","coverView","buttonRsmg","buttonDocs","buttonMore","anchorCfg","anchorMsg","strongOut","blockUploader","stageEl","selectNoteScale","selectAspectRatio","selectBackgroundDim","checkHighLight","inputOffset","lineColor","checkAutoPlay","showTransition","checkFeedback","checkImageBlur","selectbg","btnPlay","btnPause","selectbgm","selectchart","selectflip","selectspeed","inputName","inputArtist","inputCharter","inputIllustrator","selectDifficulty","selectLevel","selectVolume","blockUploaderSelect","blockUpload","blockUploadFile","blockUploadDir","blockSelect","blockMask","tween","easeInSine","cos","easeOutSine","sin","easeOutCubic","time2Str","Fs","main","before","Map","after","filterOptions","oncontextmenu","preventDefault","children","classList","remove","fireModal","BetterMessageBox","host","code","list","updateHTML","appendMessage","msgHandler","nodeText","nodeView","lastMessage","betterMessageBoxes","addBox","msgbox","setAttribute","removeBox","updateText","removeBetterMessageBox","index","innerHTML","btn","innerText","style","onclick","bmsgbox","pageNum","pageSize","getPages","ceil","btnIgnoreAll","pageNumNode","contentEditable","cssText","updatePageNum","isNaN","max","onblur","pageTotalNode","btnPrevousPage","btnNextPage","controlNode","append","createTextNode","timer","clearTimeout","setTimeout","pages","querySelectorAll","btnIgnore","getBetterMessageBox","reduce","className","sendWarning","isHTML","msgText","sendError","html","exp","ahtml","match","startsWith","rpath","origin","stat","stage","aspectRatio","isFull","resize","ratio","stageWidth","documentElement","clientWidth","stageHeight","getFull","setFull","app","HTMLDivElement","fail","alpha","canvasfg","ctxfg","console","log","lineScale","noteScale","noteScaleRatio","brightness","multiHint","playMode","musicVolume","soundVolume","_mirrorType","enableFR","enableVP","bgImage","bgImageBlur","bgMusic","bgVideo","lines","notes","taps","drags","flicks","holds","linesReversed","notesReversed","tapsReversed","dragsReversed","flicksReversed","holdsReversed","tapholds","lowResFactor","wlen","hlen","scaleX","scaleY","matX","matY","matR","initialized","_setLowResFactor","resizeCanvas","setNoteScale","setLowResFactor","_resizeCanvas","clientHeight","mirrorView","transformView","xa","xb","ya","yb","ra","sign","rb","tx","ty","prerenderChart","chartNew","ss","aniStart","aniEnd","hitStart","hitEnd","aniUpdate","seconds","hitUpdate","addSeconds","startSeconds","endSeconds","addNote","beat32","noteId","isAbove","holdSeconds","maxVisiblePos","magic","prime","log2","a_","Float32Array","Uint32Array","getMaxVisiblePos","lineId","sortNote","f","forEach","rotation","positionY","positionY2","disappearEventsIndex","moveEventsIndex","rotateEventsIndex","speedEventsIndex","reverse","timeOfMulti","isMulti","nearNotes","note2","maxSeconds","table","seekLineEventIndex","updateByTime","len","dt","cosr","sinr","getGoodY","getBadY","badTime","badY","setAlpha","projectX","projectY","visible","showPoint","isHidden","frameCount","devicePixelRatio","widthLowRes","heightLowRes","Emitter","statusInit","emit","eq","ne","emitter","status2","reg","Boolean","levelText","bgs","bgsBlur","bgms","charts","chartsMD5","chartLineData","chartInfoData","resetCallback","_localStorage$getItem2","save","get","set","dispatch","HTMLInputElement","HTMLSelectElement","property","HTMLTextAreaElement","resetCfg","showCE2","showAcc","showStat","lowRes","lockOri","maxFrame","autoDelay","adjustInfo","trim","Name","Musician","Composer","Artist","Level","toLocaleUpperCase","Illustrator","Designer","Charter","has","AspectRatio","AspectRatioValue","ScaleRatio","ScaleRatioValue","NoteScale","NoteScaleValue","GlobalAlpha","GlobalAlphaValue","BackgroundDim","BackgroundDimValue","Offset","OffsetValue","_t$e$target$value$toL","slowest","slower","faster","fastest","toLowerCase","uploader","dones","totals","uploaderDone","uploaderTotal","handleFile","tag","promise","oncomplete","values","loadComplete","fileTotal","zip","pick","basename","createOption","w","h","canvasRGBA","imgBlur","warn","innerhtml","option","percent","bytefm","webkitRelativePath","isZip","byteLength","import","default","hitManager","activate","findIndex","hit","moving","hitEl","find","deactivate","exitFull","nn","timeIn","timeOut","timeEnd","specialClick","func","atPause","atStop","pressTime","getJudgeOffset","judgeEvent","getJudgeDistance","res","nowTimeMS","curTime","curTimeMS","timeBgm","timeChart","duration0","isInEnd","isOutStart","isOutEnd","frameTimer","tick","fps","fpsStr","toPrecision","addTick","fr","frameAnimater","lastTime","interval","EPSILON","_animate","requestAnimationFrame","stop","cancelAnimationFrame","setCallback","setFrameRate","frameRate","nowTime","elapsed","playBgm","playVideo","hitFeedbackList","hitImageList","hitWordList","judgeWidth","judgeManager","addEvent","execute","tmps","progress","awawa","placeholder","artist","illustrator","charter","combo2","customForeDraw","customBackDraw","loopNoCanvas","clearRect","globalAlpha","drawLine","resetTransform","drawHold","drawDrag","drawTap","drawFlick","drawNotes","font","textAlign","setTransform","fillText","ProgressBar","fillTextNode","imgW","imgH","JudgeLineMP","val","comboColor","loopCanvas","isOutOver","globalCompositeOperation","difficulty","toLocaleLowerCase","loop","tempStat","statData","k","clip","skew","LevelOver4","LevelOver1","LevelOver5","textWidth","outerSize","innerSize","LevelOver3","Ranks","transition","Path2D","atDraw3","handlerHide","on","visibilityState","bgMusicHack","playbackrate","gainrate","playbackRate","muted","_s$Math$floor","r3","ds","dispTime","scored","holdTapTime","holdStatus","HitSong1","distance","noteJudge","nearcomp","nearNote","nearDistance","HitSong2","holdBroken","deltaTime2","nearDeltaTime","note1","HitSong0","statOffset","beginPath","arc","interact","InteractProxy","getPos","rect","getBoundingClientRect","clientX","left","offsetWidth","clientY","top","offsetHeight","setMouseEvent","mousedownCallback","button","mousemoveCallback","buttons","mouseupCallback","setKeyboardEvent","keydownCallback","NaN","keyupCallback","setTouchEvent","touchstartCallback","changedTouches","identifier","touchmoveCallback","touchendCallback","touchcancelCallback","TapBad","imgPainter","updateFX","img0","hideParts","hitRaw","hitPerfect","hitGood","Perfect","Good","tw","imageD","imgS","imageU","imageS","imageW","imageA","imageH","imageL","imageC","maxWidth","measureText","HL","nsr","baseLength","holdLength","HoldEnd","window","display","raw","fetch","loadResource","atob","image","alternative","format","loadedNum","errorNum","res0","res1","ext","referrerPolicy","blob","arrayBuffer","border","ctx1","blob1","mute","readResource","entry","Tap","lineWidth","strokeStyle","stroke","TapHL","Drag","DragHL","HoldHead","HoldHeadHL","Hold","HoldHL","Flick","FlickHL","Rank","strokeRect","HitFXRaw","entries2","triangle","LevelOver0_v1","noise","LevelOver1_v1","LevelOver2_v1","LevelOver3_v1","fixme","NoImageBlack","ImageData","Uint8ClampedArray","NoImageWhite","JudgeLineFC","lineImages","LineImage","imageFC","imageAP","imageMP","getFC","getAP","getMP","updateLineImage","lineImage","byte","updateLevelText","sp","ez","hd","in","at","diffStr","levelNum","diff","_o$find","_o$reverse$find","keys","toUpperCase","isOut","modify","onwarn","LineId","temp","Vert","Horz","IsDark","Scale","Aspect","UseBackgroundDim","UseLineColor","UseLineScale","loadLineData","bgm","deactive","volume","$$","contains","loadPlugin","Ii","searchValue","Ri","delay","debounce","appendCfg","Pi","navHTML","contentHTML","cover","nav","content","define","module","contents","meta","isPlaying"],"mappings":"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AAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAClwCC,EAAW,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAA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","x_google_ignoreList":[4,5,6,7,20]}