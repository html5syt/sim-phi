{"version":3,"file":"reader--36fc8a7d.js","sources":["../src/extends/pec/easing.js","../src/extends/pec/BpmList.ts","../src/extends/pec/LinePec.ts","../src/extends/pec/cubicBezier.js","../src/extends/pec/rpe2json.ts","../src/extends/pec/index.ts","../src/extends/pec/pec2json.ts","../src/utils/reader-.ts"],"sourcesContent":["/* eslint-disable no-param-reassign */\nconst tl = [\n  null, // 0\n  null, // 1\n  t => Math.sin(t * Math.PI / 2), // 2\n  t => 1 - Math.cos(t * Math.PI / 2), // 3\n  t => 1 - (t - 1) ** 2, // 4\n  t => t ** 2, // 5\n  t => (1 - Math.cos(t * Math.PI)) / 2, // 6\n  t => ((t *= 2) < 1 ? t ** 2 : -((t - 2) ** 2 - 2)) / 2, // 7\n  t => 1 + (t - 1) ** 3, // 8\n  t => t ** 3, // 9\n  t => 1 - (t - 1) ** 4, // 10\n  t => t ** 4, // 11\n  t => ((t *= 2) < 1 ? t ** 3 : (t - 2) ** 3 + 2) / 2, // 12\n  t => ((t *= 2) < 1 ? t ** 4 : -((t - 2) ** 4 - 2)) / 2, // 13\n  t => 1 + (t - 1) ** 5, // 14\n  t => t ** 5, // 15\n  t => 1 - 2 ** (-10 * t), // 16\n  t => 2 ** (10 * (t - 1)), // 17\n  t => Math.sqrt(1 - (t - 1) ** 2), // 18\n  t => 1 - Math.sqrt(1 - t ** 2), // 19\n  t => (2.70158 * t - 1) * (t - 1) ** 2 + 1, // 20\n  t => (2.70158 * t - 1.70158) * t ** 2, // 21\n  t => ((t *= 2) < 1 ? 1 - Math.sqrt(1 - t ** 2) : Math.sqrt(1 - (t - 2) ** 2) + 1) / 2, // 22\n  t => t < 0.5 ? (14.379638 * t - 5.189819) * t ** 2 : (14.379638 * t - 9.189819) * (t - 1) ** 2 + 1, // 23\n  t => 1 - 2 ** (-10 * t) * Math.cos(t * Math.PI / 0.15), // 24\n  t => 2 ** (10 * (t - 1)) * Math.cos((t - 1) * Math.PI / 0.15), // 25\n  t => ((t *= 11) < 4 ? t ** 2 : t < 8 ? (t - 6) ** 2 + 12 : t < 10 ? (t - 9) ** 2 + 15 : (t - 10.5) ** 2 + 15.75) / 16, // 26\n  t => 1 - tl[26](1 - t), // 27\n  t => (t *= 2) < 1 ? tl[26](t) / 2 : tl[27](t - 1) / 2 + 0.5, // 28\n  t => t < 0.5 ? 2 ** (20 * t - 11) * Math.sin((160 * t + 1) * Math.PI / 18) : 1 - 2 ** (9 - 20 * t) * Math.sin((160 * t + 1) * Math.PI / 18) // 29\n];\nfunction isLinear(index) {\n  index = Math.trunc(index);\n  return index < 2 || index > 29;\n}\n/**\n * @param {number} index\n * @returns {((t: number) => number) | null}\n */\nfunction easing(index) {\n  index = Math.trunc(index);\n  return tl[index];\n}\nexport { isLinear, easing };\n","interface BpmEventPec {\n  start: number;\n  end: number;\n  bpm: number;\n  value: number;\n}\nexport type BeatArray = [number, number, number];\nexport class BpmList {\n  public baseBpm: number;\n  private accTime: number;\n  private readonly list: BpmEventPec[];\n  public constructor(baseBpm: unknown) {\n    this.baseBpm = Number(baseBpm) || 120;\n    this.accTime = 0;\n    this.list = []; // 存放bpm变速事件\n  }\n  public push(start: number, end: number, bpm: number): void {\n    const value = this.accTime;\n    this.list.push({ start, end, bpm, value });\n    this.accTime += (end - start) / bpm;\n  }\n  public calc(beat: number): number {\n    let time = 0;\n    for (const i of this.list) {\n      if (beat > i.end) { continue }\n      if (beat < i.start) { break }\n      time = Math.round(((beat - i.start) / i.bpm + i.value) * this.baseBpm * 32);\n    }\n    return time;\n  }\n  public calc2(time: BeatArray): number {\n    return this.calc(time[0] + time[1] / time[2]);\n  }\n}\n","import { easing } from './easing.js';\ninterface SpeedEventPec {\n  time: number;\n  value: number;\n}\ninterface NotePecExtends {\n  type: number;\n  time: number;\n  positionX: number;\n  holdTime: number;\n  speed: number;\n  isAbove: boolean;\n  isFake: boolean;\n}\ninterface LineEventPec {\n  startTime: number;\n  endTime: number;\n  value: number;\n  motionType: number;\n}\ninterface LineEventPecExtends extends LineEventPec {\n  value2: number;\n}\nexport class LinePec {\n  private readonly bpm: number;\n  private readonly speedEvents: SpeedEventPec[];\n  private readonly notes: NotePecExtends[];\n  private readonly alphaEvents: LineEventPec[];\n  private readonly moveEvents: LineEventPecExtends[];\n  private readonly rotateEvents: LineEventPec[];\n  public constructor(bpm: number) {\n    this.bpm = 120;\n    this.speedEvents = [];\n    this.notes = [];\n    this.alphaEvents = [];\n    this.moveEvents = [];\n    this.rotateEvents = [];\n    if (!isNaN(bpm)) { this.bpm = bpm }\n  }\n  public pushNote(type: number, time: number, positionX: number, holdTime: number, speed: number, isAbove: boolean, isFake: boolean): void {\n    this.notes.push({ type, time, positionX, holdTime, speed, isAbove, isFake });\n  }\n  public pushSpeedEvent(time: number, value: number): void {\n    this.speedEvents.push({ time, value });\n  }\n  public pushAlphaEvent(startTime: number, endTime: number, value: number, motionType: number): void {\n    this.alphaEvents.push({ startTime, endTime, value, motionType });\n  }\n  public pushMoveEvent(startTime: number, endTime: number, value: number, value2: number, motionType: number): void {\n    this.moveEvents.push({ startTime, endTime, value, value2, motionType });\n  }\n  public pushRotateEvent(startTime: number, endTime: number, value: number, motionType: number): void {\n    this.rotateEvents.push({ startTime, endTime, value, motionType });\n  }\n  public format(): JudgeLine {\n    const sortFn = (a: { time: number }, b: { time: number }) => a.time - b.time;\n    const sortFn2 = (a: { startTime: number; endTime: number }, b: { startTime: number; endTime: number }) => a.startTime - b.startTime + (a.endTime - b.endTime);\n    // 不单独判断以避免误差\n    const result = {\n      formatVersion: 3,\n      offset: 0,\n      bpm: this.bpm,\n      speedEvents: [] as SpeedEvent[],\n      numOfNotes: 0,\n      numOfNotesAbove: 0,\n      numOfNotesBelow: 0,\n      notesAbove: [] as Note[],\n      notesBelow: [] as Note[],\n      judgeLineDisappearEvents: [] as JudgeLineEvent[],\n      judgeLineMoveEvents: [] as JudgeLineEvent[],\n      judgeLineRotateEvents: [] as JudgeLineEvent[]\n    };\n    const pushDisappearEvent = (startTime: number, endTime: number, start: number, end: number) => {\n      result.judgeLineDisappearEvents.push({ startTime, endTime, start, end, start2: 0, end2: 0 });\n    };\n    const pushMoveEvent = (startTime: number, endTime: number, start: number, end: number, start2: number, end2: number) => {\n      result.judgeLineMoveEvents.push({ startTime, endTime, start, end, start2, end2 });\n    };\n    const pushRotateEvent = (startTime: number, endTime: number, start: number, end: number) => {\n      result.judgeLineRotateEvents.push({ startTime, endTime, start, end, start2: 0, end2: 0 });\n    };\n    // cv和floorPosition一并处理\n    const cvp = this.speedEvents.sort(sortFn);\n    let s1 = 0;\n    for (let i = 0; i < cvp.length; i++) {\n      const startTime = Math.max(cvp[i].time, 0);\n      const endTime = i < cvp.length - 1 ? cvp[i + 1].time : 1e9;\n      const { value } = cvp[i];\n      const floorPosition = s1;\n      s1 += (endTime - startTime) * value / this.bpm * 1.875;\n      s1 = Math.fround(s1);\n      result.speedEvents.push({ startTime, endTime, value, floorPosition });\n    }\n    for (const i of this.notes.sort(sortFn)) {\n      const { time } = i;\n      let v1 = 0;\n      let v2 = 0;\n      let v3 = 0;\n      for (const e of result.speedEvents) {\n        if (time > e.endTime) { continue }\n        if (time < e.startTime) { break }\n        v1 = e.floorPosition;\n        v2 = e.value;\n        v3 = time - e.startTime;\n      }\n      const note = {\n        type: i.type,\n        time: time + (i.isFake ? 1e9 : 0),\n        positionX: i.positionX,\n        holdTime: i.holdTime,\n        speed: i.speed * (i.type === 3 ? v2 : 1),\n        floorPosition: Math.fround(v1 + v2 * v3 / this.bpm * 1.875)\n      };\n      if (i.isAbove) {\n        result.notesAbove.push(note);\n        if (i.isFake) { continue }\n        result.numOfNotes++;\n        result.numOfNotesAbove++;\n      } else {\n        result.notesBelow.push(note);\n        if (i.isFake) { continue }\n        result.numOfNotes++;\n        result.numOfNotesBelow++;\n      }\n    }\n    // 整合motionType\n    let dt = 0;\n    let d1 = 0;\n    for (const e of this.alphaEvents.sort(sortFn2)) {\n      pushDisappearEvent(dt, e.startTime, d1, d1);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - d1;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushDisappearEvent(i, i + 1, d1 + x1 * t1, d1 + x2 * t1);\n        }\n      } else if (e.motionType) pushDisappearEvent(e.startTime, e.endTime, d1, e.value);\n      dt = e.endTime;\n      d1 = e.value;\n    }\n    pushDisappearEvent(dt, 1e9, d1, d1);\n    //\n    let mt = 0;\n    let m1 = 0;\n    let m2 = 0;\n    for (const e of this.moveEvents.sort(sortFn2)) {\n      pushMoveEvent(mt, e.startTime, m1, m1, m2, m2);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - m1;\n        const t2 = e.value2 - m2;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushMoveEvent(i, i + 1, m1 + x1 * t1, m1 + x2 * t1, m2 + x1 * t2, m2 + x2 * t2);\n        }\n      } else if (e.motionType === 1) pushMoveEvent(e.startTime, e.endTime, m1, e.value, m2, e.value2);\n      mt = e.endTime;\n      m1 = e.value;\n      m2 = e.value2;\n    }\n    pushMoveEvent(mt, 1e9, m1, m1, m2, m2);\n    //\n    let rt = 0;\n    let r1 = 0;\n    for (const e of this.rotateEvents.sort(sortFn2)) {\n      pushRotateEvent(rt, e.startTime, r1, r1);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - r1;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushRotateEvent(i, i + 1, r1 + x1 * t1, r1 + x2 * t1);\n        }\n      } else if (e.motionType === 1) pushRotateEvent(e.startTime, e.endTime, r1, e.value);\n      rt = e.endTime;\n      r1 = e.value;\n    }\n    pushRotateEvent(rt, 1e9, r1, r1);\n    return result;\n  }\n}\n","export function cubicBezier(p1x, p1y, p2x, p2y) {\n  const ZERO_LIMIT = 1e-6;\n  // Calculate the polynomial coefficients,\n  // implicit first and last control points are (0,0) and (1,1).\n  const ax = 3 * p1x - 3 * p2x + 1;\n  const bx = 3 * p2x - 6 * p1x;\n  const cx = 3 * p1x;\n  const ay = 3 * p1y - 3 * p2y + 1;\n  const by = 3 * p2y - 6 * p1y;\n  const cy = 3 * p1y;\n  function sampleCurveDerivativeX(t) {\n    // `ax t^3 + bx t^2 + cx t` expanded using Horner's rule\n    return (3 * ax * t + 2 * bx) * t + cx;\n  }\n  function sampleCurveX(t) {\n    return ((ax * t + bx) * t + cx) * t;\n  }\n  function sampleCurveY(t) {\n    return ((ay * t + by) * t + cy) * t;\n  }\n  // Given an x value, find a parametric value it came from.\n  function solveCurveX(x) {\n    let t2 = x;\n    let derivative, x2;\n    // https://trac.webkit.org/browser/trunk/Source/WebCore/platform/animation\n    // first try a few iterations of Newton's method -- normally very fast.\n    // http://en.wikipedia.org/wikiNewton's_method\n    for (let i = 0; i < 8; i++) {\n      // f(t) - x = 0\n      x2 = sampleCurveX(t2) - x;\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n      derivative = sampleCurveDerivativeX(t2);\n      // == 0, failure\n      if (Math.abs(derivative) < ZERO_LIMIT) {\n        break;\n      }\n      t2 -= x2 / derivative;\n    }\n    // Fall back to the bisection method for reliability.\n    // bisection\n    // http://en.wikipedia.org/wiki/Bisection_method\n    let t1 = 1;\n    let t0 = 0;\n    t2 = x;\n    while (t1 > t0) {\n      x2 = sampleCurveX(t2) - x;\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n      if (x2 > 0) {\n        t1 = t2;\n      } else {\n        t0 = t2;\n      }\n      t2 = (t1 + t0) / 2;\n    }\n    // Failure\n    return t2;\n  }\n  function solve(x) {\n    return sampleCurveY(solveCurveX(x));\n  }\n  return solve;\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { type BeatArray, BpmList } from './BpmList';\nimport { easing } from './easing.js';\nimport { cubicBezier } from './cubicBezier.js';\ninterface BpmEventRPE {\n  startTime: BeatArray;\n  bpm: number;\n}\ninterface BpmEventRPEExtends extends BpmEventRPE {\n  time: number;\n}\ninterface LineEventPec {\n  startTime: number;\n  endTime: number;\n  start: number;\n  end: number;\n}\ninterface LineEventPec2 extends LineEventPec {\n  start2: number;\n  end2: number;\n}\ninterface LineEventPecDelta extends LineEventPec {\n  delta: number;\n}\ninterface SpeedEventPec {\n  time: number;\n  value: number;\n}\ninterface LineEventRPE {\n  startTime: BeatArray;\n  endTime: BeatArray;\n  start: number;\n  end: number;\n  easingType: number;\n  linkgroup?: number;\n  easingLeft?: number;\n  easingRight?: number;\n  bezier?: number;\n  bezierPoints?: [number, number, number, number];\n}\ninterface LineEventRPE2 {\n  startTime: number;\n  endTime: number;\n  start: number;\n  end: number;\n  easingFn?: (t: number) => number;\n}\nconst enum EasingCode {\n  NoError = 0,\n  StartEqualsEnd = -1,\n  EasingTypeNotSupported = -2,\n  LinearBezier = -3\n}\ninterface EasingResult {\n  code: EasingCode;\n  fn?: (t: number) => number;\n}\nfunction getEasingFn(le: LineEventRPE, startTime: number, endTime: number): EasingResult {\n  const { start, end, bezier = 0 } = le;\n  if (start === end) return { code: EasingCode.StartEqualsEnd };\n  if (bezier === 0 || bezier == null) {\n    const { easingType, easingLeft = 0, easingRight = 1 } = le;\n    if (easingLeft === easingRight) return { code: EasingCode.StartEqualsEnd };\n    const easingFn = easing(easingType);\n    if (easingFn == null) return { code: EasingCode.EasingTypeNotSupported };\n    const eHead = easingFn(easingLeft);\n    const eTail = easingFn(easingRight);\n    const eSpeed = (easingRight - easingLeft) / (endTime - startTime);\n    const eDelta = (eTail - eHead) / (end - start);\n    return { code: EasingCode.NoError, fn: (t: number) => (easingFn((t - startTime) * eSpeed + easingLeft) - eHead) / eDelta };\n  }\n  if (bezier !== 0) {\n    const { bezierPoints: [p1x, p1y, p2x, p2y] = [0, 0, 0, 0] } = le;\n    if (p1x === p1y && p2x === p2y) return { code: EasingCode.LinearBezier };\n    const eSpeed = 1 / (endTime - startTime);\n    const eDelta = 1 / (end - start);\n    const easingFn = cubicBezier(p1x, p1y, p2x, p2y);\n    return { code: EasingCode.NoError, fn: (t: number) => easingFn((t - startTime) * eSpeed) / eDelta };\n  }\n  throw new Error('Not implemented');\n}\nfunction pushLineEvent(ls: LineEventPecDelta[], le: LineEventRPE2) {\n  const { startTime, endTime, start, end, easingFn } = le;\n  const delta = (end - start) / (endTime - startTime);\n  // 插入之前考虑事件时间的相互关系\n  for (let i = ls.length - 1; i >= 0; i--) {\n    const e = ls[i];\n    if (e.endTime < startTime) { // 相离：补全空隙\n      ls[i + 1] = { startTime: e.endTime, endTime: startTime, start: e.end, end: e.end, delta: 0 };\n      break;\n    }\n    if (e.startTime === startTime) { // 相切：直接截断\n      ls.length = i;\n      break;\n    }\n    if (e.startTime < startTime) { // 相交：截断交点以后的部分\n      e.end = e.start + (startTime - e.startTime) * e.delta;\n      e.endTime = startTime;\n      e.delta = (e.end - e.start) / (startTime - e.startTime);\n      ls.length = i + 1;\n      break;\n    }\n  }\n  // 插入新事件\n  if (startTime >= endTime) {\n    ls.push({ startTime, endTime: startTime, start: end, end, delta: 0 });\n    return;\n  }\n  if (easingFn == null) {\n    ls.push({ startTime, endTime, start, end, delta });\n  } else {\n    let v1 = 0;\n    let v2 = 0;\n    for (let j = startTime; j < endTime; j++) {\n      v1 = v2;\n      v2 = easingFn(j + 1);\n      ls.push({ startTime: j, endTime: j + 1, start: start + v1, end: start + v2, delta: v2 - v1 });\n    }\n  }\n}\nfunction toSpeedEvent(le: LineEventRPE2[]) {\n  const result = [];\n  for (const i of le) {\n    const { startTime, endTime, start, end } = i;\n    result.push({ time: startTime, value: start });\n    if (start !== end) { // 暂未考虑开始时间大于结束时间的情况\n      const t1 = (end - start) / (endTime - startTime);\n      for (let j = startTime; j < endTime; j++) {\n        const x = j + 1 - startTime;\n        result.push({ time: j + 1, value: start + x * t1 });\n      }\n    }\n  }\n  return result;\n}\nfunction getEventsValue(e: LineEventPecDelta[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end, delta } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) result = end;\n    else result = start + (t - startTime) * delta;\n  }\n  return result;\n}\nfunction getMoveValue(e: LineEventPec2[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  let result2 = e[0]?.start2 ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end, start2, end2 } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) {\n      result = end;\n      result2 = end2;\n    } else {\n      result = start + (t - startTime) * (end - start) / (endTime - startTime);\n      result2 = start2 + (t - startTime) * (end2 - start2) / (endTime - startTime);\n    }\n  }\n  return [result, result2];\n}\nfunction getRotateValue(e: LineEventRPE2[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) result = end;\n    else { result = start + (t - startTime) * (end - start) / (endTime - startTime) }\n  }\n  return result;\n}\nfunction combineXYEvents(xe: LineEventPecDelta[], ye: LineEventPecDelta[]) {\n  const le = [];\n  const splits = [];\n  for (const i of xe) splits.push(i.startTime, i.endTime);\n  for (const i of ye) splits.push(i.startTime, i.endTime);\n  splits.sort((a, b) => a - b);\n  for (let i = 0; i < splits.length - 1; i++) {\n    const startTime = splits[i];\n    const endTime = splits[i + 1];\n    if (startTime === endTime) continue;\n    const startX = getEventsValue(xe, startTime, false);\n    const endX = getEventsValue(xe, endTime, true);\n    const startY = getEventsValue(ye, startTime, false);\n    const endY = getEventsValue(ye, endTime, true);\n    le.push({ startTime, endTime, start: startX, end: endX, start2: startY, end2: endY });\n  }\n  return le;\n}\nfunction combineMultiEvents(es: LineEventPecDelta[][]) {\n  const le = [];\n  const splits = [];\n  for (const e of es) {\n    for (const i of e) splits.push(i.startTime, i.endTime);\n  }\n  splits.sort((a, b) => a - b);\n  for (let i = 0; i < splits.length - 1; i++) {\n    const startTime = splits[i];\n    const endTime = splits[i + 1];\n    if (startTime === endTime) continue;\n    const start = es.reduce((n, e) => n + getEventsValue(e, startTime, false), 0);\n    const end = es.reduce((n, e) => n + getEventsValue(e, endTime, true), 0);\n    le.push({ startTime, endTime, start, end, delta: (end - start) / (endTime - startTime) });\n  }\n  return le;\n}\nfunction mergeFather(child: LineRPE1, father: LineRPE1) {\n  const moveEvents = [];\n  const splits = [];\n  for (const i of father.moveEvents!) splits.push(i.startTime, i.endTime);\n  for (const i of father.rotateEvents!) splits.push(i.startTime, i.endTime);\n  for (const i of child.moveEvents!) splits.push(i.startTime, i.endTime);\n  splits.sort((a, b) => a - b);\n  for (let i = splits[0]; i < splits[splits.length - 1]; i++) {\n    const startTime = i;\n    const endTime = i + 1;\n    if (startTime === endTime) continue;\n    // 计算父级移动和旋转\n    const [fatherX, fatherY] = getMoveValue(father.moveEvents!, startTime, false);\n    const fatherR = getRotateValue(father.rotateEvents!, startTime, false) * -Math.PI / 180;\n    const [fatherX2, fatherY2] = getMoveValue(father.moveEvents!, endTime, true);\n    const fatherR2 = getRotateValue(father.rotateEvents!, endTime, true) * -Math.PI / 180;\n    // 计算子级移动\n    const [childX, childY] = getMoveValue(child.moveEvents!, startTime, false);\n    const [childX2, childY2] = getMoveValue(child.moveEvents!, endTime, true);\n    // 坐标转换\n    const start = fatherX + childX * Math.cos(fatherR) - childY * Math.sin(fatherR);\n    const end = fatherX2 + childX2 * Math.cos(fatherR2) - childY2 * Math.sin(fatherR2);\n    const start2 = fatherY + childX * Math.sin(fatherR) + childY * Math.cos(fatherR);\n    const end2 = fatherY2 + childX2 * Math.sin(fatherR2) + childY2 * Math.cos(fatherR2);\n    moveEvents.push({ startTime, endTime, start, end, start2, end2 });\n  }\n  child.moveEvents = moveEvents;\n}\ninterface EventLayer {\n  moveXEvents: LineEventRPE[];\n  moveYEvents: LineEventRPE[];\n  rotateEvents: LineEventRPE[];\n  alphaEvents: LineEventRPE[];\n  speedEvents: LineEventRPE[];\n}\nclass EventLayer1 {\n  public moveXEvents: LineEventRPE2[];\n  public moveYEvents: LineEventRPE2[];\n  public rotateEvents: LineEventRPE2[];\n  public alphaEvents: LineEventRPE2[];\n  public speedEvents: LineEventRPE2[];\n  public constructor() {\n    this.moveXEvents = [];\n    this.moveYEvents = [];\n    this.rotateEvents = [];\n    this.alphaEvents = [];\n    this.speedEvents = [];\n  }\n  public pushMoveXEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.moveXEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushMoveYEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.moveYEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushRotateEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.rotateEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushAlphaEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.alphaEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushSpeedEvent(startTime: number, endTime: number, start: number, end: number) { this.speedEvents.push({ startTime, endTime, start, end }) }\n}\ninterface NoteRPE {\n  type: number;\n  startTime: BeatArray;\n  endTime: BeatArray;\n  positionX: number;\n  above: number;\n  isFake: number;\n  speed: number;\n  size: number;\n  yOffset: number;\n  visibleTime: number;\n  alpha: number;\n}\ninterface NoteRPE1 {\n  type: number;\n  time: number;\n  positionX: number;\n  holdTime: number;\n  speed: number;\n  isAbove: boolean;\n  isFake: boolean;\n}\nclass LineRPE1 {\n  public bpm: number;\n  public notes: NoteRPE1[];\n  public eventLayers: EventLayer1[];\n  public id?: number;\n  public father: LineRPE1 | null;\n  public moveEvents?: LineEventPec2[];\n  public rotateEvents?: LineEventPec[];\n  public alphaEvents?: LineEventPec[];\n  public speedEvents?: SpeedEventPec[];\n  private settled: boolean;\n  private merged: boolean;\n  public constructor(bpm: number) {\n    this.bpm = 120;\n    this.notes = [];\n    this.eventLayers = [];\n    this.father = null;\n    this.settled = false;\n    this.merged = false;\n    if (!isNaN(bpm)) this.bpm = bpm;\n  }\n  public pushNote(type: number, time: number, positionX: number, holdTime: number, speed: number, isAbove: boolean, isFake: boolean) {\n    this.notes.push({ type, time, positionX, holdTime, speed, isAbove, isFake });\n  }\n  public setId(id = NaN) { this.id = id }\n  public setFather(fatherLine: LineRPE1 | null) { this.father = fatherLine }\n  public preset() {\n    const sortFn2 = (a: { startTime: number }, b: { startTime: number }) => a.startTime - b.startTime;\n    const events = [];\n    for (const e of this.eventLayers) {\n      const moveXEvents: LineEventPecDelta[] = [];\n      const moveYEvents: LineEventPecDelta[] = [];\n      const rotateEvents: LineEventPecDelta[] = [];\n      const alphaEvents: LineEventPecDelta[] = [];\n      const speedEvents: LineEventPecDelta[] = [];\n      for (const i of e.moveXEvents.sort(sortFn2)) pushLineEvent(moveXEvents, i);\n      for (const i of e.moveYEvents.sort(sortFn2)) pushLineEvent(moveYEvents, i);\n      for (const i of e.rotateEvents.sort(sortFn2)) pushLineEvent(rotateEvents, i);\n      for (const i of e.alphaEvents.sort(sortFn2)) pushLineEvent(alphaEvents, i);\n      for (const i of e.speedEvents.sort(sortFn2)) pushLineEvent(speedEvents, i); // TODO: 特殊处理\n      events.push({ moveXEvents, moveYEvents, rotateEvents, alphaEvents, speedEvents });\n    }\n    const moveXEvents = combineMultiEvents(events.map(i => i.moveXEvents));\n    const moveYEvents = combineMultiEvents(events.map(i => i.moveYEvents));\n    this.moveEvents = combineXYEvents(moveXEvents, moveYEvents);\n    this.rotateEvents = combineMultiEvents(events.map(i => i.rotateEvents));\n    this.alphaEvents = combineMultiEvents(events.map(i => i.alphaEvents));\n    this.speedEvents = toSpeedEvent(combineMultiEvents(events.map(i => i.speedEvents)));\n    this.settled = true;\n  }\n  public fitFather(stack: LineRPE1[] = [], onwarning = console.warn) {\n    if (!this.settled) this.preset();\n    if (stack.includes(this)) {\n      onwarning(`检测到循环继承：${stack.concat(this).map(i => i.id).join('->')}(对应的father将被视为-1)`);\n      stack.map(i => i.setFather(null));\n      return;\n    }\n    if (this.father) this.father.fitFather(stack.concat(this), onwarning);\n    // this.father可能会在上一行被修改成null\n    if (this.father && !this.merged) {\n      mergeFather(this, this.father);\n      this.merged = true;\n    }\n  }\n  public format({ onwarning = console.warn } = {}) {\n    this.fitFather([], onwarning);\n    const result = {\n      bpm: this.bpm,\n      speedEvents: [] as SpeedEvent[],\n      numOfNotes: 0,\n      numOfNotesAbove: 0,\n      numOfNotesBelow: 0,\n      notesAbove: [] as Note[],\n      notesBelow: [] as Note[],\n      judgeLineDisappearEvents: [] as JudgeLineEvent[],\n      judgeLineMoveEvents: [] as JudgeLineEvent[],\n      judgeLineRotateEvents: [] as JudgeLineEvent[]\n    };\n    for (const i of this.moveEvents!) {\n      result.judgeLineMoveEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: (i.start + 675) / 1350,\n        end: (i.end + 675) / 1350,\n        start2: (i.start2 + 450) / 900,\n        end2: (i.end2 + 450) / 900\n      });\n    }\n    for (const i of this.rotateEvents!) {\n      result.judgeLineRotateEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: -i.start,\n        end: -i.end,\n        start2: 0,\n        end2: 0\n      });\n    }\n    for (const i of this.alphaEvents!) {\n      result.judgeLineDisappearEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: Math.max(0, i.start / 255),\n        end: Math.max(0, i.end / 255),\n        start2: 0,\n        end2: 0\n      });\n    }\n    // 添加floorPosition\n    let floorPos = 0;\n    const speedEvents = this.speedEvents!;\n    for (let i = 0; i < speedEvents.length; i++) {\n      const startTime = Math.max(speedEvents[i].time, 0);\n      const endTime = i < speedEvents.length - 1 ? speedEvents[i + 1].time : 1e9;\n      const value = speedEvents[i].value * 11 / 45;\n      const floorPosition = floorPos;\n      floorPos += (endTime - startTime) * value / this.bpm * 1.875;\n      floorPos = Math.fround(floorPos);\n      result.speedEvents.push({ startTime, endTime, value, floorPosition });\n    }\n    // 处理notes\n    const sortFn = (a: { time: number }, b: { time: number }) => a.time - b.time;\n    for (const i of this.notes.sort(sortFn)) {\n      const { time } = i;\n      let v1 = 0;\n      let v2 = 0;\n      let v3 = 0;\n      for (const e of result.speedEvents) {\n        if (time > e.endTime) continue;\n        if (time < e.startTime) break;\n        v1 = e.floorPosition;\n        v2 = e.value;\n        v3 = time - e.startTime;\n      }\n      const note = {\n        type: i.type,\n        time: time + (i.isFake ? 1e9 : 0),\n        positionX: i.positionX,\n        holdTime: i.holdTime,\n        speed: i.speed * (i.type === 3 ? v2 : 1),\n        floorPosition: Math.fround(v1 + v2 * v3 / this.bpm * 1.875)\n      };\n      if (i.isAbove) {\n        result.notesAbove.push(note);\n        if (i.isFake) continue;\n        result.numOfNotes++;\n        result.numOfNotesAbove++;\n      } else {\n        result.notesBelow.push(note);\n        if (i.isFake) continue;\n        result.numOfNotes++;\n        result.numOfNotesBelow++;\n      }\n    }\n    return result;\n  }\n}\ninterface RPEMeta {\n  RPEVersion: string;\n  song: string;\n  background: string;\n  name: string;\n  composer: string;\n  charter: string;\n  level: string;\n  offset: number;\n}\ninterface RPEDataBase {\n  BPMList: BpmEventRPEExtends[];\n  judgeLineList: JudgeLineRPEExtends[];\n}\ntype RPEDataLegacy = RPEDataBase & RPEMeta & { META: undefined };\ntype RPEDataCurrent = RPEDataBase & { META: RPEMeta };\ntype RPEData = RPEDataCurrent | RPEDataLegacy;\ninterface JudgeLineRPE {\n  numOfNotes: number;\n  isCover: number;\n  Texture: string;\n  eventLayers: (EventLayer | null)[];\n  extended?: {\n    scaleXEvents: LineEventRPE[];\n    scaleYEvents: LineEventRPE[];\n  } | null;\n  notes: NoteRPE[] | null;\n  Group: number;\n  Name: string;\n  zOrder: number;\n  bpmfactor: number;\n  father: number;\n}\ninterface JudgeLineRPEExtends extends JudgeLineRPE {\n  LineId: number;\n  judgeLineRPE: LineRPE1;\n}\nexport function parse(pec: string, filename: string): {\n  data: string;\n  messages: BetterMessage[];\n  info: ChartInfoData;\n  line: ChartLineData[];\n} {\n  const data = JSON.parse(pec) as RPEData;\n  const meta = data.META || data;\n  if (!meta?.RPEVersion) throw new Error('Invalid rpe file');\n  const result = { formatVersion: 3, offset: 0, numOfNotes: 0, judgeLineList: [] as JudgeLine[] };\n  const warnings = [] as BetterMessage[];\n  const warn = (code: number, name: string, message: string) => warnings.push({ host: 'RPE2JSON', code, name, message, target: filename });\n  warn(0, 'RPEVersionNotice', `RPE谱面兼容建设中...\\n检测到RPE版本:${meta.RPEVersion}`);\n  // 谱面信息\n  const info: ChartInfoData = {};\n  info.Chart = filename;\n  info.Music = meta.song;\n  info.Image = meta.background;\n  info.Name = meta.name;\n  info.Artist = meta.composer;\n  info.Charter = meta.charter;\n  info.Level = meta.level;\n  result.offset = meta.offset / 1e3;\n  // 判定线贴图\n  const line: ChartLineData[] = [];\n  data.judgeLineList.forEach((i: JudgeLineRPEExtends, index: number) => {\n    i.LineId = index;\n    const texture = String(i.Texture).replace(/\\0/g, '');\n    if (texture === 'line.png') return;\n    const { extended } = i;\n    const scaleX = extended?.scaleXEvents ? extended.scaleXEvents[extended.scaleXEvents.length - 1].end : 1;\n    const scaleY = extended?.scaleYEvents ? extended.scaleYEvents[extended.scaleYEvents.length - 1].end : 1;\n    line.push({\n      Chart: filename,\n      LineId: index,\n      Image: texture,\n      Scale: scaleY,\n      Aspect: scaleX / scaleY,\n      UseBackgroundDim: 0,\n      UseLineColor: 1,\n      UseLineScale: 1\n    });\n  });\n  // bpm变速\n  const bpmList = new BpmList(data.BPMList[0].bpm);\n  for (const i of data.BPMList) { i.time = i.startTime[0] + i.startTime[1] / i.startTime[2] }\n  data.BPMList.sort((a: { time: number }, b: { time: number }) => a.time - b.time).forEach((i, idx, arr) => {\n    if (arr[idx + 1]?.time <= 0) return; // 过滤负数\n    bpmList.push(i.time < 0 ? 0 : i.time, arr[idx + 1]?.time ?? 1e9, i.bpm);\n  });\n  for (const i of data.judgeLineList) {\n    if (i.zOrder === undefined) i.zOrder = 0;\n    if (i.bpmfactor === undefined) i.bpmfactor = 1;\n    if (i.father === undefined) i.father = -1;\n    if (i.isCover !== 1) warn(1, 'ImplementionWarning', `未兼容isCover=${i.isCover}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    if (i.zOrder !== 0) warn(1, 'ImplementionWarning', `未兼容zOrder=${i.zOrder}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    if (i.bpmfactor !== 1) warn(1, 'ImplementionWarning', `未兼容bpmfactor=${i.bpmfactor}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    const lineRPE = new LineRPE1(bpmList.baseBpm);\n    lineRPE.setId(i.LineId);\n    if (i.notes) {\n      for (const note of i.notes) {\n        if (note.alpha === undefined) note.alpha = 255;\n        // if (note.above !== 1 && note.above !== 2) ({code:1,name:'NoteSideWarning',message:`检测到非法方向:${note.above}(将被视为2)\\n位于:\"${JSON.stringify(note)}\"`});\n        if (note.isFake !== 0) warn(1, 'FakeNoteWarning', `检测到FakeNote(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.size !== 1) warn(1, 'ImplementionWarning', `未兼容size=${note.size}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.yOffset !== 0) warn(1, 'ImplementionWarning', `未兼容yOffset=${note.yOffset}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.visibleTime !== 999999) warn(1, 'ImplementionWarning', `未兼容visibleTime=${note.visibleTime}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.alpha !== 255) warn(1, 'ImplementionWarning', `未兼容alpha=${note.alpha}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        const type = [0, 1, 4, 2, 3].indexOf(note.type);\n        const time = bpmList.calc2(note.startTime);\n        const holdTime = bpmList.calc2(note.endTime) - time;\n        const { speed } = note;\n        const positionX = note.positionX / 75.375;\n        lineRPE.pushNote(type, time, positionX, holdTime, speed, note.above === 1, note.isFake !== 0);\n      }\n    }\n    for (const e of i.eventLayers) {\n      if (!e) continue; // 有可能是null\n      const layer = new EventLayer1();\n      for (const j of e.moveXEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const easingResult = getEasingFn(j, startTime, endTime);\n        if (easingResult.code === EasingCode.EasingTypeNotSupported && j.easingType !== 1) {\n          warn(1, 'EasingTypeWarning', `未知的缓动类型:${j.easingType}(将被视为1)\\n位于:\"${JSON.stringify(j)}\"`);\n        }\n        if (easingResult.code === EasingCode.StartEqualsEnd && j.easingLeft === j.easingRight) {\n          warn(1, 'EasingClipWarning', `检测到easingLeft等于easingRight(将被视为线性)\\n位于:\"${JSON.stringify(j)}\"`);\n        }\n        layer.pushMoveXEvent(startTime, endTime, j.start, j.end, easingResult.fn);\n      }\n      for (const j of e.moveYEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const easingResult = getEasingFn(j, startTime, endTime);\n        if (easingResult.code === EasingCode.EasingTypeNotSupported && j.easingType !== 1) {\n          warn(1, 'EasingTypeWarning', `未知的缓动类型:${j.easingType}(将被视为1)\\n位于:\"${JSON.stringify(j)}\"`);\n        }\n        if (easingResult.code === EasingCode.StartEqualsEnd && j.easingLeft === j.easingRight) {\n          warn(1, 'EasingClipWarning', `检测到easingLeft等于easingRight(将被视为线性)\\n位于:\"${JSON.stringify(j)}\"`);\n        }\n        layer.pushMoveYEvent(startTime, endTime, j.start, j.end, easingResult.fn);\n      }\n      for (const j of e.rotateEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const easingResult = getEasingFn(j, startTime, endTime);\n        if (easingResult.code === EasingCode.EasingTypeNotSupported && j.easingType !== 1) {\n          warn(1, 'EasingTypeWarning', `未知的缓动类型:${j.easingType}(将被视为1)\\n位于:\"${JSON.stringify(j)}\"`);\n        }\n        if (easingResult.code === EasingCode.StartEqualsEnd && j.easingLeft === j.easingRight) {\n          warn(1, 'EasingClipWarning', `检测到easingLeft等于easingRight(将被视为线性)\\n位于:\"${JSON.stringify(j)}\"`);\n        }\n        layer.pushRotateEvent(startTime, endTime, j.start, j.end, easingResult.fn);\n      }\n      for (const j of e.alphaEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const easingResult = getEasingFn(j, startTime, endTime);\n        if (easingResult.code === EasingCode.EasingTypeNotSupported && j.easingType !== 1) {\n          warn(1, 'EasingTypeWarning', `未知的缓动类型:${j.easingType}(将被视为1)\\n位于:\"${JSON.stringify(j)}\"`);\n        }\n        if (easingResult.code === EasingCode.StartEqualsEnd && j.easingLeft === j.easingRight) {\n          warn(1, 'EasingClipWarning', `检测到easingLeft等于easingRight(将被视为线性)\\n位于:\"${JSON.stringify(j)}\"`);\n        }\n        layer.pushAlphaEvent(startTime, endTime, j.start, j.end, easingResult.fn);\n      }\n      for (const j of e.speedEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        layer.pushSpeedEvent(startTime, endTime, j.start, j.end);\n      }\n      lineRPE.eventLayers.push(layer);\n    }\n    i.judgeLineRPE = lineRPE;\n  }\n  for (const i of data.judgeLineList) {\n    const lineRPE = i.judgeLineRPE; // TODO: 待优化\n    const father = data.judgeLineList[i.father];\n    lineRPE.setFather(father?.judgeLineRPE);\n  }\n  for (const i of data.judgeLineList) {\n    const lineRPE = i.judgeLineRPE; // TODO: 待优化\n    const judgeLine = lineRPE.format({ onwarning: (msg: string) => warn(1, 'OtherWarning', `${msg}`) });\n    result.judgeLineList.push(judgeLine);\n    result.numOfNotes += judgeLine.numOfNotes;\n  }\n  return { data: JSON.stringify(result), messages: warnings, info, line };\n}\n","import { parse } from './pec2json';\nimport { parse as parseRPE } from './rpe2json';\n// 读取info.txt\nfunction readInfo(text: string): Record<string, string>[] {\n  const lines = String(text).split(/\\r?\\n/);\n  const result = [];\n  let current = {} as Record<string, string>;\n  for (const i of lines) {\n    if (i.startsWith('#')) {\n      if (Object.keys(current).length) result.push(current);\n      current = {};\n    } else {\n      let [key, value] = i.split(/:(.+)/).map(s => s.trim());\n      if (key === 'Song') key = 'Music';\n      if (key === 'Picture') key = 'Image';\n      if (key) current[key] = value;\n    }\n  }\n  if (Object.keys(current).length) result.push(current);\n  return result;\n}\nexport default { parse, parseRPE, readInfo };\n","import { isLinear } from './easing.js';\nimport { BpmList } from './BpmList';\nimport { LinePec } from './LinePec';\ninterface BpmCommand {\n  time: number;\n  bpm: number;\n}\ninterface NoteCommand {\n  type: number;\n  lineId: number;\n  time: number;\n  time2: number;\n  offsetX: number;\n  isAbove: number;\n  isFake: number;\n  text: string;\n  speed: number;\n  size: number;\n}\ninterface LineCommand {\n  type: string;\n  lineId: number;\n  time: number;\n  time2: number;\n  speed: number;\n  offsetX: number;\n  offsetY: number;\n  rotation: number;\n  alpha: number;\n  motionType: number;\n  text: string;\n}\ninterface PecParseResult {\n  data: string;\n  messages: string[];\n}\nexport function parse(pec: string, filename: string): PecParseResult {\n  const data = pec.split(/\\s+/); // 切分pec文本\n  const data2 = {\n    offset: 0,\n    bpmList: [] as BpmCommand[],\n    notes: [] as NoteCommand[],\n    lines: [] as LineCommand[]\n  };\n  const result = {\n    formatVersion: 3,\n    offset: 0,\n    numOfNotes: 0,\n    judgeLineList: [] as JudgeLine[]\n  };\n  const warnings = []; //\n  let ptr = 0;\n  data2.offset = isNaN(Number(data[ptr])) ? 0 : Number(data[ptr++]);\n  while (ptr < data.length) {\n    const command = data[ptr++];\n    if (command === '') { continue }\n    if (command === 'bp') {\n      const time = Number(data[ptr++]);\n      const bpm = Number(data[ptr++]);\n      data2.bpmList.push({ time, bpm });\n    } else if (command.startsWith('n')) {\n      if (!'1234'.includes(command[1])) { throw new Error(`Unsupported Command: ${command}`) }\n      const cmd = {} as NoteCommand;\n      const type = command[1];\n      cmd.type = Number(type);\n      cmd.lineId = Number(data[ptr++]);\n      cmd.time = Number(data[ptr++]);\n      cmd.time2 = '2'.includes(type) ? Number(data[ptr++]) : cmd.time;\n      cmd.offsetX = Number(data[ptr++]);\n      cmd.isAbove = Number(data[ptr++]);\n      cmd.isFake = Number(data[ptr++]);\n      cmd.text = `n${Object.values(cmd).join(' ')}`;\n      cmd.speed = (data[ptr++] || '').startsWith('#') ? Number(data[ptr++]) : (ptr--, 1);\n      cmd.size = (data[ptr++] || '').startsWith('&') ? Number(data[ptr++]) : (ptr--, 1);\n      data2.notes.push(cmd);\n    } else if (command.startsWith('c')) {\n      if (!'vpdamrf'.includes(command[1])) { throw new Error(`Unsupported Command: ${command}`) }\n      const cmd = {} as LineCommand;\n      const type = command[1];\n      cmd.type = type;\n      cmd.lineId = Number(data[ptr++]);\n      cmd.time = Number(data[ptr++]);\n      if ('v'.includes(type)) { cmd.speed = Number(data[ptr++]) }\n      cmd.time2 = 'mrf'.includes(type) ? Number(data[ptr++]) : cmd.time;\n      if ('pm'.includes(type)) { cmd.offsetX = Number(data[ptr++]) }\n      if ('pm'.includes(type)) { cmd.offsetY = Number(data[ptr++]) }\n      if ('dr'.includes(type)) { cmd.rotation = Number(data[ptr++]) }\n      if ('af'.includes(type)) { cmd.alpha = Number(data[ptr++]) }\n      if ('mr'.includes(type)) { cmd.motionType = Number(data[ptr++]) }\n      cmd.text = `c${Object.values(cmd).join(' ')}`;\n      if ('pdaf'.includes(type)) { cmd.motionType = 1 }\n      data2.lines.push(cmd);\n    } else { throw new Error(`Unexpected Command: ${command}`) }\n  }\n  result.offset = data2.offset / 1e3 - 0.175; // v18x固定延迟\n  // bpm变速\n  if (!data2.bpmList.length) { throw new Error('Invalid pec file') }\n  const bpmList = new BpmList(data2.bpmList[0].bpm); // FIXME: 考虑合适的bpm范围\n  data2.bpmList.sort((a, b) => a.time - b.time).forEach((i, idx, arr) => {\n    if (arr[idx + 1]?.time <= 0) { return } // 过滤负数\n    bpmList.push(i.time < 0 ? 0 : i.time, arr[idx + 1]?.time ?? 1e9, i.bpm);\n  });\n  // note和判定线事件\n  const linesPec = [] as LinePec[];\n  for (const i of data2.notes) {\n    const type = [0, 1, 4, 2, 3].indexOf(i.type);\n    const time = bpmList.calc(i.time);\n    const holdTime = bpmList.calc(i.time2) - time;\n    const speed = isNaN(i.speed) ? 1 : i.speed;\n    linesPec[i.lineId] ??= new LinePec(bpmList.baseBpm);\n    linesPec[i.lineId].pushNote(type, time, i.offsetX / 115.2, holdTime, speed, i.isAbove === 1, i.isFake !== 0); // 102.4\n    // if (i.isAbove !== 1 && i.isAbove !== 2) warnings.push(`检测到非法方向:${i.isAbove}(将被视为2)\\n位于:\"${i.text}\"\\n来自${filename}`);\n    if (i.isFake !== 0) {\n      warnings.push(`检测到FakeNote(可能无法正常显示)\\n位于:\"${i.text}\"\\n来自${filename}`);\n    }\n    if (i.size !== 1) { warnings.push(`检测到异常Note(可能无法正常显示)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n  }\n  const isMotion = (i: number) => !isLinear(i) || i === 1;\n  for (const i of data2.lines) {\n    const t1 = bpmList.calc(i.time);\n    const t2 = bpmList.calc(i.time2);\n    if (t1 > t2) {\n      warnings.push(`检测到开始时间大于结束时间(将禁用此事件)\\n位于:\"${i.text}\"\\n来自${filename}`);\n      continue;\n    }\n    linesPec[i.lineId] ??= new LinePec(bpmList.baseBpm);\n    // 变速\n    if (i.type === 'v') {\n      linesPec[i.lineId].pushSpeedEvent(t1, i.speed / 7.0); // 6.0??\n    }\n    // 不透明度\n    if (i.type === 'a' || i.type === 'f') {\n      linesPec[i.lineId].pushAlphaEvent(t1, t2, Math.max(i.alpha / 255, 0), i.motionType); // 暂不支持alpha值扩展\n      if (i.alpha < 0) { warnings.push(`检测到负数Alpha:${i.alpha}(将被视为0)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n    // 移动\n    if (i.type === 'p' || i.type === 'm') {\n      linesPec[i.lineId].pushMoveEvent(t1, t2, i.offsetX / 2048, i.offsetY / 1400, isMotion(i.motionType) ? i.motionType : 1);\n      if (!isMotion(i.motionType)) { warnings.push(`未知的缓动类型:${i.motionType}(将被视为1)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n    // 旋转\n    if (i.type === 'd' || i.type === 'r') {\n      linesPec[i.lineId].pushRotateEvent(t1, t2, -i.rotation, isMotion(i.motionType) ? i.motionType : 1);\n      if (!isMotion(i.motionType)) { warnings.push(`未知的缓动类型:${i.motionType}(将被视为1)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n  }\n  for (const i of linesPec) {\n    const judgeLine = i.format();\n    result.judgeLineList.push(judgeLine);\n    result.numOfNotes += judgeLine.numOfNotes;\n  }\n  return { data: JSON.stringify(result), messages: warnings };\n}\n","import Pec from '../extends/pec/index';\nimport { chart123, defineReader, fileReader, joinPathInfo } from './reader';\nimport md5 from 'md5';\nfileReader.use(defineReader({\n  pattern: /\\.(json|pec)$/i,\n  type: 'json',\n  read(i: ByteData) {\n    const rpeData = Pec.parseRPE(i.text!, i.name/* , path */); // TODO: path\n    const jsonData = chart123(rpeData.data);\n    const { messages: msg, info, line } = rpeData;\n    return { type: 'chart', name: i.name, md5: md5(i.text!), data: jsonData, msg, info, line };\n  }\n}));\nfileReader.use(defineReader({\n  pattern: /\\.pec$/i,\n  type: 'text',\n  read(i: ByteData) {\n    const pecData = Pec.parse(i.text!, i.name);\n    const jsonData = chart123(pecData.data);\n    return { type: 'chart', name: i.name, md5: md5(i.text!), data: jsonData, msg: pecData.messages };\n  }\n}));\nfileReader.use(defineReader({\n  pattern: /^(Settings|info)\\.txt$/i,\n  type: 'text',\n  mustMatch: true,\n  read(i: ByteData, path: string) {\n    const data = i.text!;\n    const chartInfo = joinPathInfo(Pec.readInfo(data), path);\n    return { type: 'info' as const, data: chartInfo };\n  }\n}));\nif (Object.hasOwn(self, 'webp')) {\n  fileReader.use(defineReader({\n    pattern: /\\.webp$/i,\n    type: 'binary',\n    async read(i: ByteData) {\n      const webp2canvas = Object.getOwnPropertyDescriptor(self, 'webp')?.value.default as (buffer: ArrayBuffer) => Promise<HTMLCanvasElement>;\n      const img = await webp2canvas(i.buffer);\n      const bitmap = await createImageBitmap(img);\n      return { type: 'image', name: i.name, data: bitmap };\n    }\n  }));\n}\n// fileReader.use(defineReader({\n//   pattern: /^\\.ogg$/i,\n//   type: 'binary',\n//   async read(i: ByteData) {\n//     const { OggVorbisDecoder } = await import('@wasm-audio-decoders/ogg-vorbis');\n//     const decoder = new OggVorbisDecoder();\n//     await decoder.ready;\n//     const { channelData, samplesDecoded, sampleRate } = await decoder.decodeFile(new Uint8Array(i.buffer));\n//     decoder.free();\n//     const actx = new (window.AudioContext || window.webkitAudioContext)();\n//     const ab = actx.createBuffer(channelData.length, samplesDecoded, sampleRate);\n//     channelData.forEach((channel, idx) => ab.getChannelData(idx).set(channel));\n//     return { type: 'audio', name: i.name, data: { audio: ab, video: null } };\n//   }\n// }));\n"],"names":["tl","t","Math","sin","PI","cos","sqrt","easing","index","trunc","BpmList","constructor","baseBpm","__publicField","this","Number","accTime","list","push","start","end","bpm","value","calc","beat","time","i","round","calc2","LinePec","speedEvents","notes","alphaEvents","moveEvents","rotateEvents","isNaN","pushNote","type","positionX","holdTime","speed","isAbove","isFake","pushSpeedEvent","pushAlphaEvent","startTime","endTime","motionType","pushMoveEvent","value2","pushRotateEvent","format","sortFn","o","a","b","sortFn2","result","formatVersion","offset","numOfNotes","numOfNotesAbove","numOfNotesBelow","notesAbove","notesBelow","judgeLineDisappearEvents","judgeLineMoveEvents","judgeLineRotateEvents","pushDisappearEvent","r","start2","end2","c","cvp","sort","s1","length","max","floorPosition","fround","v1","v2","v3","e","note","dt","d1","easingFn","t1","x1","x2","mt","m1","m2","t2","rt","r1","cubicBezier","p1x","p1y","p2x","p2y","ax","bx","cx","ay","by","cy","sampleCurveDerivativeX","sampleCurveX","solve","x","sampleCurveY","derivative","abs","t0","solveCurveX","getEasingFn","le","bezier","code","easingType","easingLeft","easingRight","eHead","eTail","eSpeed","eDelta","fn","bezierPoints","Error","pushLineEvent","ls","delta","j","getEventsValue","d","_ref2","_a","getMoveValue","_ref3","_ref4","result2","_b","getRotateValue","_ref5","combineMultiEvents","es","splits","reduce","n","EventLayer1","moveXEvents","moveYEvents","pushMoveXEvent","pushMoveYEvent","LineRPE1","eventLayers","father","settled","merged","setId","id","NaN","setFather","fatherLine","preset","events","map","xe","ye","startX","endX","startY","endY","combineXYEvents","toSpeedEvent","fitFather","stack","onwarning","console","warn","includes","concat","join","child","fatherX","fatherY","fatherR","fatherX2","fatherY2","fatherR2","childX","childY","childX2","childY2","mergeFather","floorPos","Pec","pec","filename","data","split","data2","bpmList","lines","judgeLineList","warnings","ptr","command","startsWith","cmd","lineId","time2","offsetX","text","Object","values","size","offsetY","rotation","alpha","forEach","idx","arr","_ref","linesPec","_h$u","indexOf","isMotion","isLinear","_h$v","judgeLine","JSON","stringify","messages","parseRPE","parse","meta","META","RPEVersion","name","message","host","target","info","Chart","Music","song","Image","background","Name","Artist","composer","Charter","charter","Level","level","line","LineId","texture","String","Texture","replace","extended","scaleX","scaleXEvents","scaleY","scaleYEvents","Scale","Aspect","UseBackgroundDim","UseLineColor","UseLineScale","BPMList","_ref6","zOrder","bpmfactor","isCover","lineRPE","yOffset","visibleTime","above","layer","_s$moveXEvents","easingResult","_s$moveYEvents","_s$rotateEvents","_s$alphaEvents","_s$speedEvents","judgeLineRPE","msg","readInfo","current","keys","key","s","trim","fileReader","use","defineReader","pattern","read","rpeData","jsonData","chart123","md5","pecData","mustMatch","path","joinPathInfo","hasOwn","self","img","getOwnPropertyDescriptor","default","buffer","bitmap","createImageBitmap"],"mappings":"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"}